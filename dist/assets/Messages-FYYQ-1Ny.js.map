{"version":3,"file":"Messages-FYYQ-1Ny.js","sources":["../../src/components/messages/MessageThread.tsx","../../src/components/messages/HostRequestModal.tsx","../../src/pages/Messages.tsx"],"sourcesContent":["import React from 'react';\nimport { Speaker, Visit } from '@/types';\nimport { format } from 'date-fns';\nimport { fr } from 'date-fns/locale';\nimport { Button } from '@/components/ui/Button';\nimport { Card, CardBody } from '@/components/ui/Card';\nimport { CommunicationProgress } from '@/components/messages/CommunicationProgress';\nimport { Phone, Mail, MessageSquare, Calendar, MapPin, User, Clock } from 'lucide-react';\nimport { getTalkTitle } from '@/data/talkTitles';\n\ninterface MessageThreadProps {\n  speaker: Speaker;\n  visits: Visit[];\n  onAction: (action: string, visit?: Visit) => void;\n}\n\nexport const MessageThread: React.FC<MessageThreadProps> = ({ speaker, visits, onAction }) => {\n  // Deduplicate visits based on ID\n  const uniqueVisits = visits.filter(\n    (visit, index, self) => index === self.findIndex((t) => t.id === visit.id)\n  );\n\n  // Trier les visites par date d√©croissante\n  const sortedVisits = [...uniqueVisits].sort(\n    (a, b) => new Date(b.visitDate).getTime() - new Date(a.visitDate).getTime()\n  );\n\n  return (\n    <div className='flex flex-col h-full bg-gray-50 dark:bg-gray-900'>\n      {/* Header */}\n      <div className='bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 flex items-center justify-between shadow-sm'>\n        <div className='flex items-center gap-4'>\n          <div className='w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center text-primary-700 dark:text-primary-300 font-bold text-lg'>\n            {speaker.nom.charAt(0)}\n          </div>\n          <div>\n            <h2 className='font-bold text-gray-900 dark:text-white'>{speaker.nom}</h2>\n            <p className='text-sm text-gray-500 dark:text-gray-400'>{speaker.congregation}</p>\n          </div>\n        </div>\n        <div className='flex gap-2'>\n          {speaker.telephone && (\n            <Button\n              variant='ghost'\n              size='sm'\n              onClick={() => window.open(`tel:${speaker.telephone}`)}\n            >\n              <Phone className='w-4 h-4' />\n            </Button>\n          )}\n          {speaker.email && (\n            <Button\n              variant='ghost'\n              size='sm'\n              onClick={() => window.open(`mailto:${speaker.email}`)}\n            >\n              <Mail className='w-4 h-4' />\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className='flex-1 overflow-y-auto p-4 space-y-6'>\n        {sortedVisits.length > 0 ? (\n          sortedVisits.map((visit) => (\n            <div key={visit.id} className='space-y-2'>\n              <div className='flex items-center gap-2 text-xs text-gray-400 font-medium uppercase tracking-wider justify-center my-4'>\n                <span className='bg-gray-200 dark:bg-gray-700 h-px w-12'></span>\n                {format(new Date(visit.visitDate), 'd MMMM yyyy', { locale: fr })}\n                <span className='bg-gray-200 dark:bg-gray-700 h-px w-12'></span>\n              </div>\n\n              <Card>\n                <CardBody className='p-4'>\n                  <div className='flex justify-between items-start mb-4'>\n                    <div>\n                      <h3 className='font-semibold text-gray-900 dark:text-white'>\n                        Discours n¬∞{visit.talkNoOrType}\n                      </h3>\n                      <p className='text-sm text-gray-500 dark:text-gray-400'>\n                        {visit.talkTheme || getTalkTitle(visit.talkNoOrType)}\n                      </p>\n                    </div>\n                    <span\n                      className={`\n                      px-2 py-1 rounded-full text-xs font-medium\n                      ${\n                        visit.status === 'confirmed'\n                          ? 'bg-green-100 text-green-800'\n                          : visit.status === 'pending'\n                            ? 'bg-orange-100 text-orange-800'\n                            : 'bg-gray-100 text-gray-800'\n                      }\n                    `}\n                    >\n                      {visit.status === 'confirmed'\n                        ? 'Confirm√©'\n                        : visit.status === 'pending'\n                          ? 'En attente'\n                          : visit.status}\n                    </span>\n                  </div>\n\n                  <div className='grid grid-cols-2 gap-4 mb-4 text-sm text-gray-600 dark:text-gray-300'>\n                    <div className='flex items-center gap-2'>\n                      <Clock className='w-4 h-4 text-gray-400' />\n                      {visit.visitTime}\n                    </div>\n                    <div className='flex items-center gap-2'>\n                      <MapPin className='w-4 h-4 text-gray-400' />\n                      {visit.locationType === 'physical' ? 'Salle du Royaume' : 'Zoom'}\n                    </div>\n                    {visit.host && (\n                      <div className='flex items-center gap-2 col-span-2'>\n                        <User className='w-4 h-4 text-gray-400' />\n                        H√©berg√© par {visit.host}\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Barre de progression communication */}\n                  <div className='mb-4'>\n                    <CommunicationProgress visit={visit} showLabels={true} size='md' />\n                  </div>\n\n                  <div className='flex flex-wrap gap-2 pt-4 border-t border-gray-100 dark:border-gray-700'>\n                    <Button\n                      size='sm'\n                      variant='primary'\n                      leftIcon={<MessageSquare className='w-4 h-4' />}\n                      onClick={() => onAction('whatsapp', visit)}\n                    >\n                      G√©n√©rer un message\n                    </Button>\n                    {visit.status === 'pending' && (\n                      <Button\n                        size='sm'\n                        variant='primary'\n                        onClick={() => onAction('confirm', visit)}\n                      >\n                        Confirmer\n                      </Button>\n                    )}\n                  </div>\n                </CardBody>\n              </Card>\n            </div>\n          ))\n        ) : (\n          <div className='text-center py-12 text-gray-500 dark:text-gray-400'>\n            <Calendar className='w-12 h-12 mx-auto mb-3 opacity-20' />\n            <p>Aucune visite programm√©e avec cet orateur</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n","import React, { useState } from 'react';\nimport { Modal } from '@/components/ui/Modal';\nimport { Button } from '@/components/ui/Button';\nimport { Badge } from '@/components/ui/Badge';\nimport { Visit } from '@/types';\nimport { useData } from '@/contexts/DataContext';\nimport { useSettings } from '@/contexts/SettingsContext';\nimport { useToast } from '@/contexts/ToastContext';\nimport { generateHostRequestMessage } from '@/utils/messageGenerator';\nimport { Send, Copy, Check } from 'lucide-react';\nimport { formatFullDate } from '@/utils/formatters';\nimport { getTalkTitle } from '@/data/talkTitles';\n\ninterface HostRequestModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  visitsNeedingHost: Visit[];\n}\n\nexport const HostRequestModal: React.FC<HostRequestModalProps> = ({\n  isOpen,\n  onClose,\n  visitsNeedingHost,\n}) => {\n  const { congregationProfile } = useData();\n  const { settings } = useSettings();\n  const { addToast } = useToast();\n\n  const [selectedVisits, setSelectedVisits] = useState<Set<string>>(\n    new Set(visitsNeedingHost.map((v) => v.visitId))\n  );\n  const [message, setMessage] = useState('');\n\n  // G√©n√©rer le message quand les visites s√©lectionn√©es changent\n  React.useEffect(() => {\n    if (selectedVisits.size > 0) {\n      generateMessage();\n    }\n  }, [selectedVisits]);\n\n  const generateMessage = () => {\n    const visits = visitsNeedingHost.filter((v) => selectedVisits.has(v.visitId));\n    const generated = generateHostRequestMessage(visits, congregationProfile, settings.language);\n    setMessage(generated);\n  };\n\n  const toggleVisit = (visitId: string) => {\n    const newSelected = new Set(selectedVisits);\n    if (newSelected.has(visitId)) {\n      newSelected.delete(visitId);\n    } else {\n      newSelected.add(visitId);\n    }\n    setSelectedVisits(newSelected);\n  };\n\n  const toggleAll = () => {\n    if (selectedVisits.size === visitsNeedingHost.length) {\n      setSelectedVisits(new Set());\n    } else {\n      setSelectedVisits(new Set(visitsNeedingHost.map((v) => v.visitId)));\n    }\n  };\n\n  const handleCopy = async () => {\n    try {\n      await navigator.clipboard.writeText(message);\n      addToast('Message copi√© dans le presse-papier', 'success');\n    } catch (error) {\n      addToast('Erreur lors de la copie', 'error');\n    }\n  };\n\n  const handleSendWhatsApp = () => {\n    const encodedMessage = encodeURIComponent(message);\n    // Envoyer au groupe KBV Lyon (vous pouvez configurer le num√©ro de groupe)\n    window.open(`https://wa.me/?text=${encodedMessage}`, '_blank');\n    onClose();\n  };\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      title=\"Demande d'accueil group√©e\"\n      size='lg'\n      footer={\n        <>\n          <Button variant='ghost' onClick={onClose}>\n            Annuler\n          </Button>\n          <Button\n            variant='secondary'\n            onClick={handleCopy}\n            leftIcon={<Copy className='w-4 h-4' />}\n            disabled={selectedVisits.size === 0}\n          >\n            Copier\n          </Button>\n          <Button\n            onClick={handleSendWhatsApp}\n            leftIcon={<Send className='w-4 h-4' />}\n            disabled={selectedVisits.size === 0}\n          >\n            Envoyer (WhatsApp)\n          </Button>\n        </>\n      }\n    >\n      <div className='space-y-6'>\n        {/* Header avec compteur */}\n        <div className='flex items-center justify-between p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg'>\n          <div>\n            <h3 className='font-semibold text-orange-900 dark:text-orange-300'>\n              {visitsNeedingHost.length} visite{visitsNeedingHost.length > 1 ? 's' : ''} sans\n              contact d'accueil\n            </h3>\n            <p className='text-sm text-orange-700 dark:text-orange-400 mt-1'>\n              S√©lectionnez les visites pour lesquelles demander un contact\n            </p>\n          </div>\n          <Badge variant='warning' size='md'>\n            {selectedVisits.size} s√©lectionn√©e{selectedVisits.size > 1 ? 's' : ''}\n          </Badge>\n        </div>\n\n        {/* Liste des visites avec checkboxes */}\n        <div className='space-y-2'>\n          <div className='flex items-center justify-between mb-3'>\n            <h4 className='font-medium text-gray-900 dark:text-white'>Visites</h4>\n            <button\n              onClick={toggleAll}\n              className='text-sm text-primary-600 dark:text-primary-400 hover:underline'\n            >\n              {selectedVisits.size === visitsNeedingHost.length\n                ? 'Tout d√©s√©lectionner'\n                : 'Tout s√©lectionner'}\n            </button>\n          </div>\n\n          <div className='max-h-64 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-lg p-3'>\n            {visitsNeedingHost.map((visit) => (\n              <label\n                key={visit.visitId}\n                className='flex items-start gap-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer transition-colors'\n              >\n                <input\n                  type='checkbox'\n                  checked={selectedVisits.has(visit.visitId)}\n                  onChange={() => toggleVisit(visit.visitId)}\n                  className='mt-1 w-4 h-4 text-primary-600 rounded focus:ring-primary-500'\n                />\n                <div className='flex-1'>\n                  <div className='flex items-center justify-between'>\n                    <p className='font-medium text-gray-900 dark:text-white'>{visit.nom}</p>\n                    <Badge variant='default' size='sm'>\n                      {formatFullDate(visit.visitDate, settings.language)}\n                    </Badge>\n                  </div>\n                  <p className='text-sm text-gray-600 dark:text-gray-400'>\n                    {visit.congregation} ‚Ä¢ {visit.visitTime}\n                  </p>\n                  {(visit.talkTheme || getTalkTitle(visit.talkNoOrType)) && (\n                    <p className='text-xs text-gray-500 dark:text-gray-500 mt-1'>\n                      N¬∞{visit.talkNoOrType} - {visit.talkTheme || getTalkTitle(visit.talkNoOrType)}\n                    </p>\n                  )}\n                </div>\n              </label>\n            ))}\n          </div>\n        </div>\n\n        {/* Aper√ßu du message */}\n        <div>\n          <h4 className='font-medium text-gray-900 dark:text-white mb-2'>Aper√ßu du message</h4>\n          <div className='relative'>\n            <textarea\n              className='w-full h-64 p-4 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none font-mono text-sm'\n              value={message}\n              onChange={(e) => setMessage(e.target.value)}\n              placeholder={\n                selectedVisits.size === 0\n                  ? 'S√©lectionnez au moins une visite pour g√©n√©rer le message...'\n                  : 'G√©n√©ration du message...'\n              }\n              disabled={selectedVisits.size === 0}\n            />\n            {selectedVisits.size > 0 && (\n              <div className='absolute top-2 right-2'>\n                <Badge variant='success' size='sm'>\n                  <Check className='w-3 h-3 mr-1' />\n                  Message pr√™t\n                </Badge>\n              </div>\n            )}\n          </div>\n          <p className='text-xs text-gray-500 dark:text-gray-400 mt-2'>\n            üí° Vous pouvez modifier le message avant de l'envoyer\n          </p>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n","import React, { useState, useMemo } from 'react';\nimport { useData } from '@/contexts/DataContext';\nimport { usePlatformContext } from '@/contexts/PlatformContext';\nimport { MessageThread } from '@/components/messages/MessageThread';\nimport { MessageGeneratorModal } from '@/components/messages/MessageGeneratorModal';\nimport { HostRequestModal } from '@/components/messages/HostRequestModal';\nimport { Button } from '@/components/ui/Button';\nimport { Input } from '@/components/ui/Input';\nimport { Badge } from '@/components/ui/Badge';\nimport { cn } from '@/utils/cn';\nimport { MessageSquare, Search, Plus, CheckCircle, Clock, AlertCircle, Users } from 'lucide-react';\nimport { Speaker, Visit } from '@/types';\n\nexport const Messages: React.FC = () => {\n  const { visits, speakers, updateVisit, refreshData } = useData();\n  const { isPhoneS25Ultra, deviceType } = usePlatformContext();\n  const isTablet = deviceType === 'tablet';\n  const isSamsungTablet = isTablet && window.innerWidth >= 1200;\n\n  // Mettre √† jour les titres manquants au chargement\n  React.useEffect(() => {\n    if (refreshData) {\n      refreshData();\n    }\n  }, []);\n  const [selectedSpeaker, setSelectedSpeaker] = useState<Speaker | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isGeneratorModalOpen, setIsGeneratorModalOpen] = useState(false);\n  const [isHostRequestModalOpen, setIsHostRequestModalOpen] = useState(false);\n  const [generatorVisit, setGeneratorVisit] = useState<Visit | null>(null);\n\n  // Generate conversations from visits (sans doublons)\n  const conversations = useMemo(() => {\n    const convos: { speaker: Speaker; visits: Visit[]; nextVisitDate: string }[] = [];\n    const seenSpeakers = new Set<string>();\n\n    // Group visits by speaker and find next visit date\n    speakers.forEach((speaker) => {\n      if (!seenSpeakers.has(speaker.id)) {\n        seenSpeakers.add(speaker.id);\n        // Filtre les visites pour exclure les √©v√©nements sp√©ciaux (car on veut seulement les discours)\n        const speakerVisits = visits.filter(\n          (visit) => {\n            const type = (visit.talkNoOrType || '').toLowerCase();\n            const isSpecialEvent = type.includes('assembl') || \n                                  type.includes('congr') || \n                                  type.includes('especial') || \n                                  type.includes('circun');\n            \n            return visit.id === speaker.id &&\n                   !isSpecialEvent &&\n                   visit.status !== 'cancelled';\n          }\n        );\n\n        if (speakerVisits.length > 0) {\n          // Trouve la date de visite la plus proche dans le futur (ou la plus r√©cente)\n          const sortedVisits = [...speakerVisits].sort(\n            (a, b) => new Date(a.visitDate).getTime() - new Date(b.visitDate).getTime()\n          );\n\n          // Ne garde que les orateurs ayant au moins une visite non pass√©e ou en attente\n          const upcomingVisits = sortedVisits.filter(\n            (v) => new Date(v.visitDate) >= new Date(new Date().setHours(0, 0, 0, 0))\n          );\n\n          if (upcomingVisits.length > 0) {\n            convos.push({\n              speaker,\n              visits: sortedVisits,\n              nextVisitDate: upcomingVisits[0].visitDate,\n            });\n          }\n        }\n      }\n    });\n\n    // Trie les conversations par date de prochaine visite (la plus proche en premier)\n    return convos.sort(\n      (a, b) => new Date(a.nextVisitDate).getTime() - new Date(b.nextVisitDate).getTime()\n    );\n  }, [visits, speakers]);\n\n  // Filtered conversations\n  const filteredConversations = useMemo(\n    () =>\n      conversations.filter((convo) => {\n        const matchesSearch =\n          convo.speaker.nom.toLowerCase().includes(searchTerm.toLowerCase()) ||\n          convo.speaker.congregation.toLowerCase().includes(searchTerm.toLowerCase()) ||\n          convo.nextVisitDate.includes(searchTerm);\n\n        return matchesSearch;\n      }),\n    [conversations, searchTerm]\n  );\n\n  const stats = useMemo(() => {\n    const total = conversations.length;\n    const pending = visits.filter((v) => v.status === 'pending').length;\n    const needingHost = visits.filter(\n      (v) => !v.host || v.host === '√Ä d√©finir' || v.host === ''\n    ).length;\n\n    return { total, pending, needingHost };\n  }, [conversations, visits]);\n\n  const getStatusIcon = (visit: Visit) => {\n    switch (visit.status) {\n      case 'pending':\n        return <Clock className='w-4 h-4 text-orange-500' />;\n      case 'confirmed':\n        return <CheckCircle className='w-4 h-4 text-green-500' />;\n      default:\n        return <AlertCircle className='w-4 h-4 text-gray-500' />;\n    }\n  };\n\n  const handleMessageAction = (action: string, visit?: Visit) => {\n    if (action === 'whatsapp' || action === 'email') {\n      if (visit && selectedSpeaker) {\n        setGeneratorVisit(visit);\n        setIsGeneratorModalOpen(true);\n      }\n    } else if (action === 'confirm' && visit) {\n      // Confirmer la visite\n      const updatedVisit: Visit = {\n        ...visit,\n        status: 'confirmed',\n        updatedAt: new Date().toISOString(),\n      };\n      updateVisit(updatedVisit);\n    } else if (action === 'host_request' && visit) {\n      setGeneratorVisit(visit);\n      setIsHostRequestModalOpen(true);\n    }\n  };\n\n  return (\n    <div\n      className={cn(\n        'min-h-[calc(100vh-12rem)] flex flex-col',\n        isPhoneS25Ultra && 's25-ultra-optimized'\n      )}\n    >\n      {/* Header */}\n      <div className={cn('flex justify-end gap-3 mb-6', isPhoneS25Ultra && 'flex-col gap-2')}>\n        {/* Bouton demande d'accueil - conditionnel */}\n        {stats.needingHost > 0 && (\n          <Button\n            variant='secondary'\n            className='bg-orange-100 text-orange-700 hover:bg-orange-200 dark:bg-orange-900/30 dark:text-orange-300 dark:hover:bg-orange-900/50'\n            leftIcon={<Users className='w-4 h-4' />}\n            onClick={() => setIsHostRequestModalOpen(true)}\n          >\n            Demande d'accueil ({stats.needingHost})\n          </Button>\n        )}\n        <Button\n          variant='secondary'\n          leftIcon={<Plus className='w-4 h-4' />}\n          onClick={() => setIsGeneratorModalOpen(true)}\n        >\n          Nouveau message\n        </Button>\n      </div>\n\n      {/* Statistics Cards - More compact */}\n      <div className={cn('grid gap-3 mb-4', isPhoneS25Ultra ? 'grid-cols-1' : 'grid-cols-3')}>\n        <div\n          className={cn(\n            'bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-200 dark:border-blue-800',\n            isPhoneS25Ultra && 's25-card'\n          )}\n        >\n          <div className='flex items-center gap-2'>\n            <MessageSquare className='w-5 h-5 text-blue-600 dark:text-blue-400' />\n            <div>\n              <div className='text-base font-semibold text-blue-900 dark:text-blue-100 leading-tight'>\n                {stats.total}\n              </div>\n              <div className='text-[10px] text-blue-700 dark:text-blue-300'>Orateurs</div>\n            </div>\n          </div>\n        </div>\n\n        <div\n          className={cn(\n            'bg-orange-50 dark:bg-orange-900/20 p-3 rounded-lg border border-orange-200 dark:border-orange-800',\n            isPhoneS25Ultra && 's25-card'\n          )}\n        >\n          <div className='flex items-center gap-2'>\n            <Clock className='w-5 h-5 text-orange-600 dark:text-orange-400' />\n            <div>\n              <div className='text-base font-semibold text-orange-900 dark:text-orange-100 leading-tight'>\n                {stats.pending}\n              </div>\n              <div className='text-[10px] text-orange-700 dark:text-orange-300'>En attente</div>\n            </div>\n          </div>\n        </div>\n\n        <div\n          className={cn(\n            'bg-green-50 dark:bg-green-900/20 p-3 rounded-lg border border-green-200 dark:border-green-800',\n            isPhoneS25Ultra && 's25-card'\n          )}\n        >\n          <div className='flex items-center gap-2'>\n            <CheckCircle className='w-5 h-5 text-green-600 dark:text-green-400' />\n            <div>\n              <div className='text-base font-semibold text-green-900 dark:text-green-100 leading-tight'>\n                {visits.filter((v) => v.status === 'confirmed').length}\n              </div>\n              <div className='text-[10px] text-green-700 dark:text-green-300'>Confirm√©es</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Filters - Simplified */}\n      <div\n        className={cn(\n          'flex items-center bg-white dark:bg-gray-800 p-2 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 mb-4',\n          isPhoneS25Ultra && 'p-1'\n        )}\n      >\n        <Input\n          placeholder='Rechercher un orateur ou une date (AAAA-MM-DD)...'\n          leftIcon={<Search className='w-4 h-4' />}\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          className='w-full border-none focus:ring-0 bg-transparent'\n        />\n      </div>\n\n      {/* Main Content - Split View */}\n      <div className={cn('flex-1 flex gap-6 min-h-0', isPhoneS25Ultra && 'flex-col gap-4')}>\n        {/* Conversations List */}\n        <div\n          className={cn(\n            'flex flex-col bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden',\n            isPhoneS25Ultra ? 'w-full min-h-0 flex-1' : isSamsungTablet ? 'w-[800px]' : 'w-full lg:w-96'\n          )}\n        >\n          <div className='p-4 border-b border-gray-200 dark:border-gray-700'>\n            <h3 className='font-semibold text-gray-900 dark:text-white'>Orateurs</h3>\n          </div>\n\n          <div className='flex-1 overflow-y-auto p-3'>\n            {filteredConversations.length > 0 ? (\n              <div className={cn(\n                'grid gap-3',\n                isSamsungTablet ? 'grid-cols-3' : isTablet ? 'grid-cols-2' : 'grid-cols-1'\n              )}>\n                {filteredConversations.map(({ speaker, visits: speakerVisits }) => (\n                  <div\n                    key={speaker.id}\n                    onClick={() => setSelectedSpeaker(speaker)}\n                    className={cn(\n                      'p-3 rounded-lg cursor-pointer border transition-all',\n                      selectedSpeaker?.id === speaker.id\n                        ? 'bg-primary-50 dark:bg-primary-900/20 border-primary-500 shadow-sm'\n                        : 'border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50 hover:border-gray-200 dark:hover:border-gray-600'\n                    )}\n                  >\n                    <div className='flex items-start justify-between'>\n                      <div className='flex items-start gap-3 flex-1 min-w-0'>\n                        <div className='w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center text-primary-700 dark:text-primary-300 font-bold flex-shrink-0'>\n                          {speaker.nom.charAt(0).toUpperCase()}\n                        </div>\n\n                        <div className='flex-1 min-w-0'>\n                          <div className='flex items-center gap-2 mb-0.5'>\n                            <h4 className='font-medium text-gray-900 dark:text-white leading-tight'>\n                              {speaker.nom}\n                            </h4>\n                            {speakerVisits.some((v: Visit) => v.status === 'pending') && (\n                              <Badge variant='danger' className='text-[10px] px-1.5 py-0 flex-shrink-0'>\n                                !\n                              </Badge>\n                            )}\n                          </div>\n\n                          <div className='flex flex-col gap-0.5'>\n                            <p className='text-[11px] text-gray-500 dark:text-gray-400 font-medium leading-tight'>\n                              {speaker.congregation}\n                            </p>\n                            <div className='flex items-center gap-2'>\n                              <span className='text-[11px] font-medium text-primary-600 dark:text-primary-400'>\n                                {new Date(\n                                  (conversations.find(c => c.speaker.id === speaker.id) as any)?.nextVisitDate\n                                ).toLocaleDateString('fr-FR', {\n                                  day: '2-digit',\n                                  month: 'short',\n                                })}\n                              </span>\n                              <Badge className='text-[9px] px-1 py-0 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 border-none'>\n                                {speakerVisits.find((v: Visit) => v.visitDate === (conversations.find(c => c.speaker.id === speaker.id) as any)?.nextVisitDate)?.locationType === 'physical' ? 'Pr√©sentiel' : \n                                 speakerVisits.find((v: Visit) => v.visitDate === (conversations.find(c => c.speaker.id === speaker.id) as any)?.nextVisitDate)?.locationType === 'zoom' ? 'Zoom' : 'Streaming'}\n                              </Badge>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className='flex flex-col items-end gap-1 flex-shrink-0'>\n                        {speakerVisits.some((v: Visit) => getStatusIcon(v))}\n                        <span className='text-[10px] text-gray-400 dark:text-gray-500'>\n                          {speaker.telephone || speaker.email ? 'Contact√©' : 'Sans contact'}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className='flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400'>\n                <MessageSquare className='w-12 h-12 mb-4 opacity-20' />\n                <p className='text-center'>\n                  {searchTerm ? 'Aucun orateur trouv√©' : 'Aucun orateur'}\n                </p>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Message Thread */}\n        <div\n          className={cn(\n            'flex-1 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden',\n            isPhoneS25Ultra && 'w-full'\n          )}\n        >\n          {selectedSpeaker ? (\n            <MessageThread\n              speaker={selectedSpeaker}\n              visits={visits.filter((v) => v.nom === selectedSpeaker.nom)}\n              onAction={handleMessageAction}\n            />\n          ) : (\n            <div className='flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400'>\n              <MessageSquare className='w-16 h-16 mb-4 opacity-20' />\n              <h3 className='text-lg font-medium mb-2'>S√©lectionnez un orateur</h3>\n              <p className='text-center max-w-md'>\n                Choisissez un orateur dans la liste pour voir les d√©tails et envoyer des messages.\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Message Generator Modal */}\n      {isGeneratorModalOpen && selectedSpeaker && generatorVisit && (\n        <MessageGeneratorModal\n          isOpen={isGeneratorModalOpen}\n          onClose={() => {\n            setIsGeneratorModalOpen(false);\n            setGeneratorVisit(null);\n          }}\n          speaker={selectedSpeaker}\n          visit={generatorVisit}\n        />\n      )}\n\n      {/* Fallback modal when no specific visit is selected */}\n      {isGeneratorModalOpen && !generatorVisit && (\n        <MessageGeneratorModal\n          isOpen={isGeneratorModalOpen}\n          onClose={() => {\n            setIsGeneratorModalOpen(false);\n            setGeneratorVisit(null);\n          }}\n          speaker={selectedSpeaker || speakers[0]}\n          visit={\n            selectedSpeaker\n              ? visits.find(\n                  (v) =>\n                    v.id === selectedSpeaker.id &&\n                    (v.status === 'pending' || v.status === 'confirmed')\n                ) ||\n                visits.find((v) => v.id === selectedSpeaker.id) ||\n                visits[0]\n              : visits[0]\n          }\n        />\n      )}\n\n      {/* Host Request Modal */}\n      <HostRequestModal\n        isOpen={isHostRequestModalOpen}\n        onClose={() => setIsHostRequestModalOpen(false)}\n        visitsNeedingHost={visits.filter((v) => !v.host || v.host === '√Ä d√©finir' || v.host === '')}\n      />\n    </div>\n  );\n};\n"],"names":["MessageThread","speaker","visits","onAction","sortedVisits","visit","index","self","t","a","b","jsxs","jsx","Button","Phone","Mail","format","fr","Card","CardBody","getTalkTitle","Clock","MapPin","User","CommunicationProgress","MessageSquare","Calendar","HostRequestModal","isOpen","onClose","visitsNeedingHost","congregationProfile","useData","settings","useSettings","addToast","useToast","selectedVisits","setSelectedVisits","useState","v","message","setMessage","React","generateMessage","generated","generateHostRequestMessage","toggleVisit","visitId","newSelected","toggleAll","handleCopy","handleSendWhatsApp","encodedMessage","Modal","Fragment","Copy","Send","Badge","formatFullDate","e","Check","Messages","speakers","updateVisit","refreshData","isPhoneS25Ultra","deviceType","usePlatformContext","isTablet","isSamsungTablet","selectedSpeaker","setSelectedSpeaker","searchTerm","setSearchTerm","isGeneratorModalOpen","setIsGeneratorModalOpen","isHostRequestModalOpen","setIsHostRequestModalOpen","generatorVisit","setGeneratorVisit","conversations","useMemo","convos","seenSpeakers","speakerVisits","type","isSpecialEvent","upcomingVisits","filteredConversations","convo","stats","total","pending","needingHost","getStatusIcon","CheckCircle","AlertCircle","handleMessageAction","action","updatedVisit","cn","Users","Plus","Input","Search","c","MessageGeneratorModal"],"mappings":"olBAgBO,MAAMA,GAA8C,CAAC,CAAE,QAAAC,EAAS,OAAAC,EAAQ,SAAAC,KAAe,CAO5F,MAAMC,EAAe,CAAC,GALDF,EAAO,OAC1B,CAACG,EAAOC,EAAOC,IAASD,IAAUC,EAAK,UAAWC,GAAMA,EAAE,KAAOH,EAAM,EAAE,CAAA,CAItC,EAAE,KACrC,CAACI,EAAGC,IAAM,IAAI,KAAKA,EAAE,SAAS,EAAE,QAAA,EAAY,IAAI,KAAKD,EAAE,SAAS,EAAE,QAAA,CAAQ,EAG5E,OACEE,EAAAA,KAAC,MAAA,CAAI,UAAU,mDAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0HACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,sJACZ,WAAQ,IAAI,OAAO,CAAC,EACvB,SACC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,KAAA,CAAG,UAAU,0CAA2C,SAAAX,EAAQ,IAAI,EACrEW,EAAAA,IAAC,IAAA,CAAE,UAAU,2CAA4C,WAAQ,YAAA,CAAa,CAAA,CAAA,CAChF,CAAA,EACF,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,aACZ,SAAA,CAAAV,EAAQ,WACPW,EAAAA,IAACC,EAAA,CACC,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,OAAO,KAAK,OAAOZ,EAAQ,SAAS,EAAE,EAErD,SAAAW,EAAAA,IAACE,GAAA,CAAM,UAAU,SAAA,CAAU,CAAA,CAAA,EAG9Bb,EAAQ,OACPW,EAAAA,IAACC,EAAA,CACC,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,OAAO,KAAK,UAAUZ,EAAQ,KAAK,EAAE,EAEpD,SAAAW,EAAAA,IAACG,GAAA,CAAK,UAAU,SAAA,CAAU,CAAA,CAAA,CAC5B,CAAA,CAEJ,CAAA,EACF,EAGAH,EAAAA,IAAC,MAAA,CAAI,UAAU,uCACZ,WAAa,OAAS,EACrBR,EAAa,IAAKC,GAChBM,EAAAA,KAAC,MAAA,CAAmB,UAAU,YAC5B,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,yGACb,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,wCAAA,CAAyC,EACxDI,GAAO,IAAI,KAAKX,EAAM,SAAS,EAAG,cAAe,CAAE,OAAQY,EAAI,EAChEL,EAAAA,IAAC,OAAA,CAAK,UAAU,wCAAA,CAAyC,CAAA,EAC3D,EAEAA,MAACM,EAAA,CACC,SAAAP,EAAAA,KAACQ,EAAA,CAAS,UAAU,MAClB,SAAA,CAAAR,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,8CAA8C,SAAA,CAAA,cAC9CN,EAAM,YAAA,EACpB,EACAO,EAAAA,IAAC,KAAE,UAAU,2CACV,WAAM,WAAaQ,EAAaf,EAAM,YAAY,CAAA,CACrD,CAAA,EACF,EACAO,EAAAA,IAAC,OAAA,CACC,UAAW;AAAA;AAAA,wBAGTP,EAAM,SAAW,YACb,8BACAA,EAAM,SAAW,UACf,gCACA,2BACR;AAAA,sBAGC,SAAAA,EAAM,SAAW,YACd,WACAA,EAAM,SAAW,UACf,aACAA,EAAM,MAAA,CAAA,CACd,EACF,EAEAM,EAAAA,KAAC,MAAA,CAAI,UAAU,uEACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACS,EAAA,CAAM,UAAU,uBAAA,CAAwB,EACxChB,EAAM,SAAA,EACT,EACAM,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACU,GAAA,CAAO,UAAU,uBAAA,CAAwB,EACzCjB,EAAM,eAAiB,WAAa,mBAAqB,MAAA,EAC5D,EACCA,EAAM,MACLM,OAAC,MAAA,CAAI,UAAU,qCACb,SAAA,CAAAC,EAAAA,IAACW,GAAA,CAAK,UAAU,uBAAA,CAAwB,EAAE,eAC7BlB,EAAM,IAAA,CAAA,CACrB,CAAA,EAEJ,EAGAO,EAAAA,IAAC,MAAA,CAAI,UAAU,OACb,SAAAA,EAAAA,IAACY,GAAA,CAAsB,MAAAnB,EAAc,WAAY,GAAM,KAAK,IAAA,CAAK,CAAA,CACnE,EAEAM,EAAAA,KAAC,MAAA,CAAI,UAAU,0EACb,SAAA,CAAAC,EAAAA,IAACC,EAAA,CACC,KAAK,KACL,QAAQ,UACR,SAAUD,EAAAA,IAACa,EAAA,CAAc,UAAU,SAAA,CAAU,EAC7C,QAAS,IAAMtB,EAAS,WAAYE,CAAK,EAC1C,SAAA,oBAAA,CAAA,EAGAA,EAAM,SAAW,WAChBO,EAAAA,IAACC,EAAA,CACC,KAAK,KACL,QAAQ,UACR,QAAS,IAAMV,EAAS,UAAWE,CAAK,EACzC,SAAA,WAAA,CAAA,CAED,CAAA,CAEJ,CAAA,CAAA,CACF,CAAA,CACF,CAAA,GAhFQA,EAAM,EAiFhB,CACD,EAEDM,EAAAA,KAAC,MAAA,CAAI,UAAU,qDACb,SAAA,CAAAC,EAAAA,IAACc,EAAA,CAAS,UAAU,mCAAA,CAAoC,EACxDd,EAAAA,IAAC,KAAE,SAAA,2CAAA,CAAyC,CAAA,CAAA,CAC9C,CAAA,CAEJ,CAAA,EACF,CAEJ,EC3Iae,GAAoD,CAAC,CAChE,OAAAC,EACA,QAAAC,EACA,kBAAAC,CACF,IAAM,CACJ,KAAM,CAAE,oBAAAC,CAAA,EAAwBC,EAAA,EAC1B,CAAE,SAAAC,CAAA,EAAaC,EAAA,EACf,CAAE,SAAAC,CAAA,EAAaC,EAAA,EAEf,CAACC,EAAgBC,CAAiB,EAAIC,EAAAA,SAC1C,IAAI,IAAIT,EAAkB,IAAKU,GAAMA,EAAE,OAAO,CAAC,CAAA,EAE3C,CAACC,EAASC,CAAU,EAAIH,EAAAA,SAAS,EAAE,EAGzCI,EAAM,UAAU,IAAM,CAChBN,EAAe,KAAO,GACxBO,EAAA,CAEJ,EAAG,CAACP,CAAc,CAAC,EAEnB,MAAMO,EAAkB,IAAM,CAC5B,MAAM1C,EAAS4B,EAAkB,OAAQU,GAAMH,EAAe,IAAIG,EAAE,OAAO,CAAC,EACtEK,EAAYC,GAA2B5C,EAAQ6B,EAAqBE,EAAS,QAAQ,EAC3FS,EAAWG,CAAS,CACtB,EAEME,EAAeC,GAAoB,CACvC,MAAMC,EAAc,IAAI,IAAIZ,CAAc,EACtCY,EAAY,IAAID,CAAO,EACzBC,EAAY,OAAOD,CAAO,EAE1BC,EAAY,IAAID,CAAO,EAEzBV,EAAkBW,CAAW,CAC/B,EAEMC,EAAY,IAAM,CAClBb,EAAe,OAASP,EAAkB,OAC5CQ,EAAkB,IAAI,GAAK,EAE3BA,EAAkB,IAAI,IAAIR,EAAkB,IAAKU,GAAMA,EAAE,OAAO,CAAC,CAAC,CAEtE,EAEMW,EAAa,SAAY,CAC7B,GAAI,CACF,MAAM,UAAU,UAAU,UAAUV,CAAO,EAC3CN,EAAS,sCAAuC,SAAS,CAC3D,MAAgB,CACdA,EAAS,0BAA2B,OAAO,CAC7C,CACF,EAEMiB,EAAqB,IAAM,CAC/B,MAAMC,EAAiB,mBAAmBZ,CAAO,EAEjD,OAAO,KAAK,uBAAuBY,CAAc,GAAI,QAAQ,EAC7DxB,EAAA,CACF,EAEA,OACEjB,EAAAA,IAAC0C,EAAA,CACC,OAAA1B,EACA,QAAAC,EACA,MAAM,4BACN,KAAK,KACL,OACElB,EAAAA,KAAA4C,WAAA,CACE,SAAA,CAAA3C,MAACC,EAAA,CAAO,QAAQ,QAAQ,QAASgB,EAAS,SAAA,UAE1C,EACAjB,EAAAA,IAACC,EAAA,CACC,QAAQ,YACR,QAASsC,EACT,SAAUvC,EAAAA,IAAC4C,GAAA,CAAK,UAAU,SAAA,CAAU,EACpC,SAAUnB,EAAe,OAAS,EACnC,SAAA,QAAA,CAAA,EAGDzB,EAAAA,IAACC,EAAA,CACC,QAASuC,EACT,SAAUxC,EAAAA,IAAC6C,GAAA,CAAK,UAAU,SAAA,CAAU,EACpC,SAAUpB,EAAe,OAAS,EACnC,SAAA,oBAAA,CAAA,CAED,EACF,EAGF,SAAA1B,EAAAA,KAAC,MAAA,CAAI,UAAU,YAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,sIACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,qDACX,SAAA,CAAAmB,EAAkB,OAAO,UAAQA,EAAkB,OAAS,EAAI,IAAM,GAAG,yBAAA,EAE5E,EACAlB,EAAAA,IAAC,IAAA,CAAE,UAAU,oDAAoD,SAAA,8DAAA,CAEjE,CAAA,EACF,EACAD,EAAAA,KAAC+C,EAAA,CAAM,QAAQ,UAAU,KAAK,KAC3B,SAAA,CAAArB,EAAe,KAAK,gBAAcA,EAAe,KAAO,EAAI,IAAM,EAAA,CAAA,CACrE,CAAA,EACF,EAGA1B,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,4CAA4C,SAAA,UAAO,EACjEA,EAAAA,IAAC,SAAA,CACC,QAASsC,EACT,UAAU,iEAET,SAAAb,EAAe,OAASP,EAAkB,OACvC,sBACA,mBAAA,CAAA,CACN,EACF,QAEC,MAAA,CAAI,UAAU,gGACZ,SAAAA,EAAkB,IAAKzB,GACtBM,EAAAA,KAAC,QAAA,CAEC,UAAU,iHAEV,SAAA,CAAAC,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,QAASyB,EAAe,IAAIhC,EAAM,OAAO,EACzC,SAAU,IAAM0C,EAAY1C,EAAM,OAAO,EACzC,UAAU,8DAAA,CAAA,EAEZM,EAAAA,KAAC,MAAA,CAAI,UAAU,SACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAAC,IAAA,CAAE,UAAU,4CAA6C,SAAAP,EAAM,IAAI,EACpEO,EAAAA,IAAC8C,EAAA,CAAM,QAAQ,UAAU,KAAK,KAC3B,SAAAC,EAAetD,EAAM,UAAW4B,EAAS,QAAQ,CAAA,CACpD,CAAA,EACF,EACAtB,EAAAA,KAAC,IAAA,CAAE,UAAU,2CACV,SAAA,CAAAN,EAAM,aAAa,MAAIA,EAAM,SAAA,EAChC,GACEA,EAAM,WAAae,EAAaf,EAAM,YAAY,IAClDM,EAAAA,KAAC,IAAA,CAAE,UAAU,gDAAgD,SAAA,CAAA,KACxDN,EAAM,aAAa,MAAIA,EAAM,WAAae,EAAaf,EAAM,YAAY,CAAA,CAAA,CAC9E,CAAA,CAAA,CAEJ,CAAA,CAAA,EAxBKA,EAAM,OAAA,CA0Bd,CAAA,CACH,CAAA,EACF,SAGC,MAAA,CACC,SAAA,CAAAO,EAAAA,IAAC,KAAA,CAAG,UAAU,iDAAiD,SAAA,oBAAiB,EAChFD,EAAAA,KAAC,MAAA,CAAI,UAAU,WACb,SAAA,CAAAC,EAAAA,IAAC,WAAA,CACC,UAAU,4NACV,MAAO6B,EACP,SAAWmB,GAAMlB,EAAWkB,EAAE,OAAO,KAAK,EAC1C,YACEvB,EAAe,OAAS,EACpB,8DACA,2BAEN,SAAUA,EAAe,OAAS,CAAA,CAAA,EAEnCA,EAAe,KAAO,GACrBzB,EAAAA,IAAC,MAAA,CAAI,UAAU,yBACb,SAAAD,EAAAA,KAAC+C,EAAA,CAAM,QAAQ,UAAU,KAAK,KAC5B,SAAA,CAAA9C,EAAAA,IAACiD,GAAA,CAAM,UAAU,cAAA,CAAe,EAAE,cAAA,CAAA,CAEpC,CAAA,CACF,CAAA,EAEJ,EACAjD,EAAAA,IAAC,IAAA,CAAE,UAAU,gDAAgD,SAAA,uDAAA,CAE7D,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CAGN,EC/LakD,GAAqB,IAAM,CACtC,KAAM,CAAE,OAAA5D,EAAQ,SAAA6D,EAAU,YAAAC,EAAa,YAAAC,CAAA,EAAgBjC,EAAA,EACjD,CAAE,gBAAAkC,EAAiB,WAAAC,CAAA,EAAeC,EAAA,EAClCC,EAAWF,IAAe,SAC1BG,EAAkBD,GAAY,OAAO,YAAc,KAGzD1B,EAAM,UAAU,IAAM,CAChBsB,GACFA,EAAA,CAEJ,EAAG,CAAA,CAAE,EACL,KAAM,CAACM,EAAiBC,CAAkB,EAAIjC,EAAAA,SAAyB,IAAI,EACrE,CAACkC,EAAYC,CAAa,EAAInC,EAAAA,SAAS,EAAE,EACzC,CAACoC,EAAsBC,CAAuB,EAAIrC,EAAAA,SAAS,EAAK,EAChE,CAACsC,EAAwBC,CAAyB,EAAIvC,EAAAA,SAAS,EAAK,EACpE,CAACwC,EAAgBC,CAAiB,EAAIzC,EAAAA,SAAuB,IAAI,EAGjE0C,EAAgBC,EAAAA,QAAQ,IAAM,CAClC,MAAMC,EAAyE,CAAA,EACzEC,MAAmB,IAGzB,OAAArB,EAAS,QAAS9D,GAAY,CAC5B,GAAI,CAACmF,EAAa,IAAInF,EAAQ,EAAE,EAAG,CACjCmF,EAAa,IAAInF,EAAQ,EAAE,EAE3B,MAAMoF,EAAgBnF,EAAO,OAC1BG,GAAU,CACT,MAAMiF,GAAQjF,EAAM,cAAgB,IAAI,YAAA,EAClCkF,EAAiBD,EAAK,SAAS,SAAS,GACxBA,EAAK,SAAS,OAAO,GACrBA,EAAK,SAAS,UAAU,GACxBA,EAAK,SAAS,QAAQ,EAE5C,OAAOjF,EAAM,KAAOJ,EAAQ,IACrB,CAACsF,GACDlF,EAAM,SAAW,WAC1B,CAAA,EAGF,GAAIgF,EAAc,OAAS,EAAG,CAE5B,MAAMjF,EAAe,CAAC,GAAGiF,CAAa,EAAE,KACtC,CAAC5E,EAAGC,IAAM,IAAI,KAAKD,EAAE,SAAS,EAAE,QAAA,EAAY,IAAI,KAAKC,EAAE,SAAS,EAAE,QAAA,CAAQ,EAItE8E,EAAiBpF,EAAa,OACjCoC,GAAM,IAAI,KAAKA,EAAE,SAAS,GAAK,IAAI,KAAK,IAAI,OAAO,SAAS,EAAG,EAAG,EAAG,CAAC,CAAC,CAAA,EAGtEgD,EAAe,OAAS,GAC1BL,EAAO,KAAK,CACV,QAAAlF,EACA,OAAQG,EACR,cAAeoF,EAAe,CAAC,EAAE,SAAA,CAClC,CAEL,CACF,CACF,CAAC,EAGML,EAAO,KACZ,CAAC1E,EAAGC,IAAM,IAAI,KAAKD,EAAE,aAAa,EAAE,QAAA,EAAY,IAAI,KAAKC,EAAE,aAAa,EAAE,QAAA,CAAQ,CAEtF,EAAG,CAACR,EAAQ6D,CAAQ,CAAC,EAGf0B,EAAwBP,EAAAA,QAC5B,IACED,EAAc,OAAQS,GAElBA,EAAM,QAAQ,IAAI,cAAc,SAASjB,EAAW,YAAA,CAAa,GACjEiB,EAAM,QAAQ,aAAa,YAAA,EAAc,SAASjB,EAAW,aAAa,GAC1EiB,EAAM,cAAc,SAASjB,CAAU,CAG1C,EACH,CAACQ,EAAeR,CAAU,CAAA,EAGtBkB,EAAQT,EAAAA,QAAQ,IAAM,CAC1B,MAAMU,EAAQX,EAAc,OACtBY,EAAU3F,EAAO,OAAQsC,GAAMA,EAAE,SAAW,SAAS,EAAE,OACvDsD,EAAc5F,EAAO,OACxBsC,GAAM,CAACA,EAAE,MAAQA,EAAE,OAAS,aAAeA,EAAE,OAAS,EAAA,EACvD,OAEF,MAAO,CAAE,MAAAoD,EAAO,QAAAC,EAAS,YAAAC,CAAA,CAC3B,EAAG,CAACb,EAAe/E,CAAM,CAAC,EAEpB6F,EAAiB1F,GAAiB,CACtC,OAAQA,EAAM,OAAA,CACZ,IAAK,UACH,OAAOO,EAAAA,IAACS,EAAA,CAAM,UAAU,yBAAA,CAA0B,EACpD,IAAK,YACH,OAAOT,EAAAA,IAACoF,EAAA,CAAY,UAAU,wBAAA,CAAyB,EACzD,QACE,OAAOpF,EAAAA,IAACqF,GAAA,CAAY,UAAU,uBAAA,CAAwB,CAAA,CAE5D,EAEMC,EAAsB,CAACC,EAAgB9F,IAAkB,CAC7D,GAAI8F,IAAW,YAAcA,IAAW,QAClC9F,GAASkE,IACXS,EAAkB3E,CAAK,EACvBuE,EAAwB,EAAI,WAErBuB,IAAW,WAAa9F,EAAO,CAExC,MAAM+F,EAAsB,CAC1B,GAAG/F,EACH,OAAQ,YACR,UAAW,IAAI,KAAA,EAAO,YAAA,CAAY,EAEpC2D,EAAYoC,CAAY,CAC1B,MAAWD,IAAW,gBAAkB9F,IACtC2E,EAAkB3E,CAAK,EACvByE,EAA0B,EAAI,EAElC,EAEA,OACEnE,EAAAA,KAAC,MAAA,CACC,UAAW0F,EACT,0CACAnC,GAAmB,qBAAA,EAIrB,SAAA,CAAAvD,OAAC,OAAI,UAAW0F,EAAG,8BAA+BnC,GAAmB,gBAAgB,EAElF,SAAA,CAAAyB,EAAM,YAAc,GACnBhF,EAAAA,KAACE,EAAA,CACC,QAAQ,YACR,UAAU,2HACV,SAAUD,EAAAA,IAAC0F,EAAA,CAAM,UAAU,SAAA,CAAU,EACrC,QAAS,IAAMxB,EAA0B,EAAI,EAC9C,SAAA,CAAA,sBACqBa,EAAM,YAAY,GAAA,CAAA,CAAA,EAG1C/E,EAAAA,IAACC,EAAA,CACC,QAAQ,YACR,SAAUD,EAAAA,IAAC2F,EAAA,CAAK,UAAU,SAAA,CAAU,EACpC,QAAS,IAAM3B,EAAwB,EAAI,EAC5C,SAAA,iBAAA,CAAA,CAED,EACF,EAGAjE,OAAC,OAAI,UAAW0F,EAAG,kBAAmBnC,EAAkB,cAAgB,aAAa,EACnF,SAAA,CAAAtD,EAAAA,IAAC,MAAA,CACC,UAAWyF,EACT,4FACAnC,GAAmB,UAAA,EAGrB,SAAAvD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACa,EAAA,CAAc,UAAU,0CAAA,CAA2C,SACnE,MAAA,CACC,SAAA,CAAAb,EAAAA,IAAC,MAAA,CAAI,UAAU,yEACZ,SAAA+E,EAAM,MACT,EACA/E,EAAAA,IAAC,MAAA,CAAI,UAAU,+CAA+C,SAAA,UAAA,CAAQ,CAAA,CAAA,CACxE,CAAA,CAAA,CACF,CAAA,CAAA,EAGFA,EAAAA,IAAC,MAAA,CACC,UAAWyF,EACT,oGACAnC,GAAmB,UAAA,EAGrB,SAAAvD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACS,EAAA,CAAM,UAAU,8CAAA,CAA+C,SAC/D,MAAA,CACC,SAAA,CAAAT,EAAAA,IAAC,MAAA,CAAI,UAAU,6EACZ,SAAA+E,EAAM,QACT,EACA/E,EAAAA,IAAC,MAAA,CAAI,UAAU,mDAAmD,SAAA,YAAA,CAAU,CAAA,CAAA,CAC9E,CAAA,CAAA,CACF,CAAA,CAAA,EAGFA,EAAAA,IAAC,MAAA,CACC,UAAWyF,EACT,gGACAnC,GAAmB,UAAA,EAGrB,SAAAvD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACoF,EAAA,CAAY,UAAU,4CAAA,CAA6C,SACnE,MAAA,CACC,SAAA,CAAApF,EAAAA,IAAC,MAAA,CAAI,UAAU,2EACZ,SAAAV,EAAO,OAAQsC,GAAMA,EAAE,SAAW,WAAW,EAAE,MAAA,CAClD,EACA5B,EAAAA,IAAC,MAAA,CAAI,UAAU,iDAAiD,SAAA,YAAA,CAAU,CAAA,CAAA,CAC5E,CAAA,CAAA,CACF,CAAA,CAAA,CACF,EACF,EAGAA,EAAAA,IAAC,MAAA,CACC,UAAWyF,EACT,wHACAnC,GAAmB,KAAA,EAGrB,SAAAtD,EAAAA,IAAC4F,GAAA,CACC,YAAY,oDACZ,SAAU5F,EAAAA,IAAC6F,GAAA,CAAO,UAAU,SAAA,CAAU,EACtC,MAAOhC,EACP,SAAWb,GAAMc,EAAcd,EAAE,OAAO,KAAK,EAC7C,UAAU,gDAAA,CAAA,CACZ,CAAA,SAID,MAAA,CAAI,UAAWyC,EAAG,4BAA6BnC,GAAmB,gBAAgB,EAEjF,SAAA,CAAAvD,EAAAA,KAAC,MAAA,CACC,UAAW0F,EACT,iHACAnC,EAAkB,wBAA0BI,EAAkB,YAAc,gBAAA,EAG9E,SAAA,CAAA1D,EAAAA,IAAC,MAAA,CAAI,UAAU,oDACb,SAAAA,EAAAA,IAAC,MAAG,UAAU,8CAA8C,oBAAQ,CAAA,CACtE,EAEAA,EAAAA,IAAC,OAAI,UAAU,6BACZ,WAAsB,OAAS,EAC9BA,EAAAA,IAAC,MAAA,CAAI,UAAWyF,EACd,aACA/B,EAAkB,cAAgBD,EAAW,cAAgB,aAAA,EAE5D,WAAsB,IAAI,CAAC,CAAE,QAAApE,EAAS,OAAQoF,KAC7CzE,EAAAA,IAAC,MAAA,CAEC,QAAS,IAAM4D,EAAmBvE,CAAO,EACzC,UAAWoG,EACT,sDACA9B,GAAiB,KAAOtE,EAAQ,GAC5B,oEACA,kIAAA,EAGN,SAAAU,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,4JACZ,SAAAX,EAAQ,IAAI,OAAO,CAAC,EAAE,YAAA,CAAY,CACrC,EAEAU,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,iCACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,0DACX,SAAAX,EAAQ,IACX,EACCoF,EAAc,KAAM7C,GAAaA,EAAE,SAAW,SAAS,GACtD5B,EAAAA,IAAC8C,EAAA,CAAM,QAAQ,SAAS,UAAU,wCAAwC,SAAA,GAAA,CAE1E,CAAA,EAEJ,EAEA/C,EAAAA,KAAC,MAAA,CAAI,UAAU,wBACb,SAAA,CAAAC,EAAAA,IAAC,IAAA,CAAE,UAAU,yEACV,SAAAX,EAAQ,aACX,EACAU,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,iEACb,SAAA,IAAI,KACFqE,EAAc,KAAKyB,GAAKA,EAAE,QAAQ,KAAOzG,EAAQ,EAAE,GAAW,aAAA,EAC/D,mBAAmB,QAAS,CAC5B,IAAK,UACL,MAAO,OAAA,CACR,EACH,EACAW,MAAC8C,GAAM,UAAU,iGACd,WAAc,KAAMlB,GAAaA,EAAE,YAAeyC,EAAc,KAAK,GAAK,EAAE,QAAQ,KAAOhF,EAAQ,EAAE,GAAW,aAAa,GAAG,eAAiB,WAAa,aAC9JoF,EAAc,KAAM7C,GAAaA,EAAE,YAAeyC,EAAc,KAAK,GAAK,EAAE,QAAQ,KAAOhF,EAAQ,EAAE,GAAW,aAAa,GAAG,eAAiB,OAAS,OAAS,WAAA,CACtK,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,EAEAU,EAAAA,KAAC,MAAA,CAAI,UAAU,8CACZ,SAAA,CAAA0E,EAAc,KAAM7C,GAAauD,EAAcvD,CAAC,CAAC,EAClD5B,EAAAA,IAAC,QAAK,UAAU,+CACb,WAAQ,WAAaX,EAAQ,MAAQ,WAAa,cAAA,CACrD,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EAvDKA,EAAQ,EAAA,CAyDhB,CAAA,CACH,EAEAU,OAAC,MAAA,CAAI,UAAU,mFACb,SAAA,CAAAC,EAAAA,IAACa,EAAA,CAAc,UAAU,2BAAA,CAA4B,QACpD,IAAA,CAAE,UAAU,cACV,SAAAgD,EAAa,uBAAyB,eAAA,CACzC,CAAA,CAAA,CACF,CAAA,CAEJ,CAAA,CAAA,CAAA,EAIF7D,EAAAA,IAAC,MAAA,CACC,UAAWyF,EACT,0GACAnC,GAAmB,QAAA,EAGpB,SAAAK,EACC3D,EAAAA,IAACZ,GAAA,CACC,QAASuE,EACT,OAAQrE,EAAO,OAAQsC,GAAMA,EAAE,MAAQ+B,EAAgB,GAAG,EAC1D,SAAU2B,CAAA,CAAA,EAGZvF,EAAAA,KAAC,MAAA,CAAI,UAAU,oFACb,SAAA,CAAAC,EAAAA,IAACa,EAAA,CAAc,UAAU,2BAAA,CAA4B,EACrDb,EAAAA,IAAC,KAAA,CAAG,UAAU,2BAA2B,SAAA,0BAAuB,EAChEA,EAAAA,IAAC,IAAA,CAAE,UAAU,uBAAuB,SAAA,oFAAA,CAEpC,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,EACF,EAGC+D,GAAwBJ,GAAmBQ,GAC1CnE,EAAAA,IAAC+F,EAAA,CACC,OAAQhC,EACR,QAAS,IAAM,CACbC,EAAwB,EAAK,EAC7BI,EAAkB,IAAI,CACxB,EACA,QAAST,EACT,MAAOQ,CAAA,CAAA,EAKVJ,GAAwB,CAACI,GACxBnE,EAAAA,IAAC+F,EAAA,CACC,OAAQhC,EACR,QAAS,IAAM,CACbC,EAAwB,EAAK,EAC7BI,EAAkB,IAAI,CACxB,EACA,QAAST,GAAmBR,EAAS,CAAC,EACtC,MACEQ,IACIrE,EAAO,KACJsC,GACCA,EAAE,KAAO+B,EAAgB,KACxB/B,EAAE,SAAW,WAAaA,EAAE,SAAW,YAAA,GAE5CtC,EAAO,KAAMsC,GAAMA,EAAE,KAAO+B,EAAgB,EAAE,IAC9CrE,EAAO,CAAC,CACA,CAAA,EAMlBU,EAAAA,IAACe,GAAA,CACC,OAAQkD,EACR,QAAS,IAAMC,EAA0B,EAAK,EAC9C,kBAAmB5E,EAAO,OAAQsC,GAAM,CAACA,EAAE,MAAQA,EAAE,OAAS,aAAeA,EAAE,OAAS,EAAE,CAAA,CAAA,CAC5F,CAAA,CAAA,CAGN"}