import{c as z,j as e,L as se,u as ae,a as re,b as ne,d as le,U as K,C as q,A as F,e as c,f as D,g as M,h as E,T as oe,B as L,Z as ie,M as ce,F as de,i as O,Q as he,R as me}from"./index-CUj4VCjl.js";import{r as n,R as Q,b as W,B as xe,C as ue,X as pe,Y as ge,T as G,d as fe,P as ye,e as be,f as je}from"./charts-CCOFnOOy.js";import{V as ke}from"./VisitActionModal-qfZ2Rabn.js";import{C as ve}from"./copy-BQBGxYHl.js";import"./react-vendor-B9D_A6Vq.js";import"./utils-FTT-aY8U.js";import"./Select-Bwvzh9xp.js";import"./trash-2-CL8UGa8v.js";import"./FeedbackFormModal-D2BCS8G_.js";import"./link-BV1ppNjq.js";import"./MessageGeneratorModal-BGVep8eO.js";const we=z("CalendarPlus",[["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"19",x2:"19",y1:"16",y2:"22",key:"1ttwzi"}],["line",{x1:"16",x2:"22",y1:"19",y2:"19",key:"1g9955"}]]);const Ne=z("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const Ce=z("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),De=a=>{const{onRefresh:x,threshold:p=80,resistance:h=2.5}=a,[g,m]=n.useState(!1),[w,o]=n.useState(0),S=n.useRef(0),N=n.useRef(!1),R=n.useCallback(b=>{window.scrollY===0&&(S.current=b.touches[0].clientY,N.current=!0)},[]),C=n.useCallback(b=>{if(!N.current||g)return;const $=b.touches[0].clientY-S.current;if($>0){const A=$/h;o(Math.min(A,p*1.5)),$>10&&b.preventDefault()}},[g,p,h]),T=n.useCallback(async()=>{if(N.current)if(N.current=!1,w>=p&&!g){m(!0);try{await x()}finally{m(!1),o(0)}}else o(0)},[w,p,g,x]);return n.useEffect(()=>(document.addEventListener("touchstart",R,{passive:!0}),document.addEventListener("touchmove",C,{passive:!1}),document.addEventListener("touchend",T),()=>{document.removeEventListener("touchstart",R),document.removeEventListener("touchmove",C),document.removeEventListener("touchend",T)}),[R,C,T]),{isRefreshing:g,pullDistance:w}},Me=({pullDistance:a,isRefreshing:x,threshold:p=80})=>{const h=Math.min(a/p*100,100),g=Math.min(a/p,1);return a===0&&!x?null:(Q.useEffect(()=>{const m=document.documentElement;m.style.setProperty("--ptr-transform",`translateY(${x?"60px":`${a}px`})`),m.style.setProperty("--ptr-opacity",x?"1":g.toString())},[a,x,g]),e.jsx("div",{className:"pull-refresh-indicator fixed top-0 left-0 right-0 flex justify-center items-center z-50 transition-all duration-200",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-full p-3 shadow-lg",children:x?e.jsx(se,{className:"w-6 h-6 text-ios-blue animate-spin"}):e.jsx("div",{className:"relative w-6 h-6",children:e.jsxs("svg",{className:"w-6 h-6 transform -rotate-90",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",className:"text-gray-200 dark:text-gray-700"}),e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeDasharray:`${2*Math.PI*10}`,strokeDashoffset:`${2*Math.PI*10*(1-h/100)}`,className:"text-ios-blue transition-all duration-200",strokeLinecap:"round"})]})})})}))},Le=({isOnline:a})=>a?null:e.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 bg-orange-500 text-white px-4 py-2 flex items-center justify-center gap-2 text-sm font-medium shadow-lg",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{children:"Mode hors ligne - Données en cache"})]});function Re(){return"deviceMemory"in navigator?navigator.deviceMemory<=2:"hardwareConcurrency"in navigator?navigator.hardwareConcurrency<=2:!1}const Te=n.memo(({visit:a,onClick:x,showStatus:p=!1})=>{const h=()=>{switch(a.status){case"confirmed":return e.jsx(O,{variant:"success",className:"text-xs",children:"Confirmé"});case"pending":return e.jsx(O,{variant:"warning",className:"text-xs",children:"En attente"});case"completed":return e.jsx(O,{variant:"default",className:"text-xs",children:"Terminé"});case"cancelled":return e.jsx(O,{variant:"danger",className:"text-xs",children:"Annulé"});default:return null}};return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors cursor-pointer",onClick:x,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center text-primary-700 dark:text-primary-300 font-bold",children:a.nom.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.nom}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[new Date(a.visitDate).toLocaleDateString("fr-FR",{weekday:"short",day:"numeric",month:"short"})," ","à ",a.visitTime]}),a.talkTheme&&e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-500 mt-1",children:["N°",a.talkNoOrType," - ",a.talkTheme]})]})]}),p&&h()]})}),qe=()=>{const{visits:a,speakers:x,hosts:p}=ae(),{addToast:h}=re(),{deviceType:g,orientation:m,isPhoneS25Ultra:w}=ne(),o=le(),[S,N]=n.useState(navigator.onLine),[R,C]=n.useState(!1),[T,b]=n.useState(!1),[P,$]=n.useState(null),[A,B]=n.useState(!1),V=n.useCallback(t=>{$(t),B(!0)},[]),j=g==="tablet",r=j&&window.innerWidth>=1200,{isRefreshing:Z,pullDistance:X}=De({onRefresh:async()=>{window.location.reload()}});Q.useEffect(()=>{const t=()=>N(!0),s=()=>N(!1);return window.addEventListener("online",t),window.addEventListener("offline",s),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}},[]);const U=typeof window<"u"&&window.innerWidth<768,J=Re(),k=n.useMemo(()=>{const t=new Date;t.setHours(0,0,0,0);const s=new Date(t.getFullYear(),t.getMonth()+1,0);return s.setHours(23,59,59,999),{today:t,endOfMonth:s}},[]),I=n.useMemo(()=>a.filter(t=>{const s=new Date(t.visitDate);return s>=k.today&&s<=k.endOfMonth&&(t.status==="confirmed"||t.status==="pending")}).sort((t,s)=>new Date(t.visitDate).getTime()-new Date(s.visitDate).getTime()),[a,k]),v=n.useMemo(()=>a.filter(t=>t.status==="pending"||t.status==="confirmed"&&new Date(t.visitDate)<k.today),[a,k]),H=n.useMemo(()=>{const t=k.today;return a.filter(s=>{const f=new Date(s.visitDate);return f.getMonth()===t.getMonth()&&f.getFullYear()===t.getFullYear()}).length},[a,k]),_=n.useMemo(()=>[{label:"Orateurs actifs",value:x.length,icon:K,color:"text-blue-600",bg:"bg-blue-100 dark:bg-blue-900/20",trend:"+2 ce mois"},{label:"Contacts d'accueil",value:p.length,icon:K,color:"text-green-600",bg:"bg-green-100 dark:bg-green-900/20",trend:"+1 cette semaine"},{label:"Visites ce mois",value:H,icon:q,color:"text-purple-600",bg:"bg-purple-100 dark:bg-purple-900/20",trend:"+15%"},{label:"Actions requises",value:v.length,icon:F,color:"text-orange-600",bg:"bg-orange-100 dark:bg-orange-900/20",trend:v.length>0?"Urgent":"À jour"}],[x.length,p.length,H,v.length]),ee=n.useMemo(()=>{const t=[],s=k.today;for(let f=5;f>=0;f--){const d=new Date(s.getFullYear(),s.getMonth()-f,1),y=a.filter(u=>{const i=new Date(u.visitDate);return i.getMonth()===d.getMonth()&&i.getFullYear()===d.getFullYear()}).length;t.push({name:d.toLocaleDateString("fr-FR",{month:"short"}),visites:y})}return t},[a,k]),Y=n.useMemo(()=>[{name:"Physique",value:a.filter(t=>t.locationType==="physical").length,color:"#3B82F6"},{name:"Zoom",value:a.filter(t=>t.locationType==="zoom").length,color:"#10B981"},{name:"Streaming",value:a.filter(t=>t.locationType==="streaming").length,color:"#F59E0B"}],[a]);n.useEffect(()=>{const t=s=>{(s.ctrlKey||s.metaKey)&&s.key==="k"&&(s.preventDefault(),C(!0))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]);const te=n.useCallback(()=>o("/planning"),[o]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:c("h-full",w&&"s25-ultra-optimized",r?"flex flex-col space-y-2 pb-2":j?"flex flex-col space-y-3 pb-4":U?"space-y-4":"space-y-6","px-4",J&&"optimize-rendering"),children:[e.jsx(Me,{pullDistance:X,isRefreshing:Z}),e.jsx(Le,{isOnline:S}),e.jsx("div",{className:`flex-shrink-0 grid gap-3 ${w||U?"grid-cols-2":r&&m==="landscape"?"grid-cols-4 gap-4":g==="tablet"&&m==="landscape"?"grid-cols-4 sm:gap-6":g==="tablet"?"grid-cols-4":"grid-cols-1 md:grid-cols-2 lg:grid-cols-4 sm:gap-6"}`,children:_.map((t,s)=>e.jsx(D,{hoverable:!0,className:c("relative overflow-hidden cursor-pointer",w&&"s25-card",r&&"shadow-sm"),onClick:()=>{s===0||s===1?o("/speakers"):(s===2||s===3)&&o("/planning")},children:e.jsxs(M,{className:c("flex items-center",r?"p-3":"sm:p-6"),children:[e.jsx("div",{className:c("rounded-xl mr-3 sm:mr-4",t.bg,r?"p-2":"p-2 sm:p-3"),children:e.jsx(t.icon,{className:c(t.color,r?"w-4 h-4":"w-5 h-5 sm:w-6 sm:h-6")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:t.label}),e.jsx("p",{className:c("font-bold text-gray-900 dark:text-white",r?"text-lg":"text-lg sm:text-2xl"),children:t.value}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:t.trend})]})]})},t.label))}),e.jsxs("div",{className:`
        grid gap-4 sm:gap-6
        ${j&&r&&m==="landscape"?"grid-cols-12":"grid-cols-1 lg:grid-cols-12"}
      `,children:[e.jsx("div",{className:`
          ${j&&r&&m==="landscape"?"col-span-8":"col-span-1 lg:col-span-8"}
        `,children:e.jsxs(D,{className:"h-full",children:[e.jsx(E,{className:c(r&&"py-3 px-4"),children:e.jsxs("h3",{className:"text-base md:text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4 md:w-5 md:h-5"}),"Évolution mensuelle"]})}),e.jsx(M,{className:c(r&&"p-4"),children:e.jsx("div",{className:c("w-full",r?"h-40":U?"h-48":"h-64"),children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(xe,{data:ee,children:[e.jsx(ue,{strokeDasharray:"3 3",stroke:"#E5E7EB",className:"dark:stroke-gray-700"}),e.jsx(pe,{dataKey:"name",stroke:"#6B7280",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(ge,{stroke:"#6B7280",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(G,{cursor:{fill:"#F3F4F6"},contentStyle:{borderRadius:"8px",border:"none"}}),e.jsx(fe,{dataKey:"visites",fill:"#4F46E5",radius:[4,4,0,0]})]})})})})]})}),e.jsx("div",{className:`
          ${j&&r&&m==="landscape"?"col-span-4":"col-span-1 lg:col-span-4"}
        `,children:e.jsxs(D,{className:"h-full flex flex-col",children:[e.jsxs(E,{className:c("flex items-center justify-between flex-shrink-0",r&&"py-3 px-4"),children:[e.jsxs("h3",{className:"text-sm md:text-md font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),"Prochaines visites"]}),e.jsx(L,{variant:"secondary",size:"sm",onClick:te,children:"Voir tout"})]}),e.jsx(M,{className:c("flex-1 overflow-y-auto min-h-[200px]",r?"p-3":"p-6"),children:I.length>0?e.jsx("div",{className:"space-y-3",children:I.slice(0,5).map(t=>e.jsx(Te,{visit:t,onClick:()=>V(t),showStatus:!0},t.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400 h-full flex flex-col justify-center",children:[e.jsx(q,{className:"w-10 h-10 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"font-medium text-sm",children:"Aucune visite"})]})})]})}),e.jsxs("div",{className:`
          ${j&&r&&m==="landscape"?"col-span-4":"col-span-1 lg:col-span-4"}
          flex flex-col gap-4 sm:gap-6
        `,children:[e.jsxs(D,{children:[e.jsx(E,{className:c("py-3",r&&"px-4"),children:e.jsxs("h3",{className:"text-base font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),"Répartition"]})}),e.jsxs(M,{className:c("py-2",r&&"px-4"),children:[e.jsx("div",{className:c("w-full",r?"h-24":"h-32"),children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(ye,{children:[e.jsx(be,{data:Y,cx:"50%",cy:"50%",innerRadius:30,outerRadius:50,paddingAngle:5,dataKey:"value",children:Y.map((t,s)=>e.jsx(je,{fill:t.color},`cell-${s}`))}),e.jsx(G,{})]})})}),e.jsx("div",{className:"flex justify-center gap-3 mt-1 pb-2",children:Y.map(t=>{const s=t.name==="Physique"?"bg-blue-500":t.name==="Zoom"?"bg-green-500":"bg-amber-500";return e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${s}`}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:t.name}),e.jsx("span",{className:"text-xs font-bold text-gray-900 dark:text-white",children:t.value})]},t.name)})})]})]}),e.jsxs(D,{className:"flex-1",children:[e.jsx(E,{className:c("py-3",r&&"px-4"),children:e.jsxs("h3",{className:"text-base font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4 text-yellow-500"}),"Accès Rapide"]})}),e.jsx(M,{className:c(r?"p-3":"p-6"),children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(L,{variant:"secondary",className:"h-auto py-3 flex flex-col gap-2 items-center justify-center text-center hover:bg-primary-50 hover:text-primary-700 hover:border-primary-200 dark:hover:bg-primary-900/20",onClick:()=>B(!0),children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-full text-blue-600 dark:text-blue-400",children:e.jsx(we,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-xs font-medium",children:"Nouvelle Visite"})]}),e.jsxs(L,{variant:"secondary",className:"h-auto py-3 flex flex-col gap-2 items-center justify-center text-center hover:bg-primary-50 hover:text-primary-700 hover:border-primary-200 dark:hover:bg-primary-900/20",onClick:()=>o("/speakers"),children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-full text-green-600 dark:text-green-400",children:e.jsx(Ne,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-xs font-medium",children:"Nouvel Orateur"})]}),e.jsxs(L,{variant:"secondary",className:"h-auto py-3 flex flex-col gap-2 items-center justify-center text-center hover:bg-primary-50 hover:text-primary-700 hover:border-primary-200 dark:hover:bg-primary-900/20",onClick:()=>o("/messages"),children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-full text-purple-600 dark:text-purple-400",children:e.jsx(ce,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-xs font-medium",children:"Messages"})]}),e.jsxs(L,{variant:"secondary",className:"h-auto py-3 flex flex-col gap-2 items-center justify-center text-center hover:bg-primary-50 hover:text-primary-700 hover:border-primary-200 dark:hover:bg-primary-900/20",onClick:()=>b(!0),children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-full text-orange-600 dark:text-orange-400",children:e.jsx(de,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-xs font-medium",children:"Rapports"})]})]})})]})]}),e.jsx("div",{className:`
          ${j&&r&&m==="landscape"?"col-span-8":"col-span-1 lg:col-span-8"}
        `,children:e.jsxs(D,{className:"h-full flex flex-col",children:[e.jsxs(E,{className:c("flex items-center justify-between flex-shrink-0",r&&"py-3 px-4"),children:[e.jsxs("h3",{className:"text-sm md:text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4 md:w-5 md:h-5"}),"Actions requises"]}),v.length>0&&e.jsxs(O,{variant:"danger",className:"text-xs",children:[v.length," alerte",v.length>1?"s":""]})]}),e.jsx(M,{className:c("flex-1 overflow-y-auto min-h-[200px]",r?"p-3":"p-6"),children:e.jsx("div",{className:"space-y-3",children:v.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:v.slice(0,10).map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-orange-200 dark:border-orange-900/50 bg-orange-50 dark:bg-orange-900/10 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer overflow-hidden",onClick:()=>V(t),children:[e.jsx(F,{className:"w-8 h-8 text-orange-500 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.status==="pending"?"Validation requise":"Visite passée"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:t.nom}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:new Date(t.visitDate).toLocaleDateString("fr-FR",{day:"numeric",month:"long"})})]})]}),e.jsx(L,{variant:"secondary",size:"sm",onClick:s=>{s.stopPropagation(),V(t)},children:"Traiter"})]},t.id))}):e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400 flex flex-col items-center justify-center h-full",children:[e.jsx(F,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),e.jsx("p",{className:"font-medium text-lg",children:"Aucune action requise"}),e.jsx("p",{className:"text-sm mt-1",children:"Tout est à jour !"})]})})})]})})]})]}),P&&e.jsx(ke,{isOpen:A,onClose:()=>B(!1),visit:P,action:"edit"}),e.jsx(he,{isOpen:R,onClose:()=>C(!1),onAction:t=>{switch(C(!1),t){case"schedule-visit":o("/planning");break;case"add-speaker":o("/speakers");break;case"add-host":o("/speakers");break;case"send-message":o("/messages");break;case"generate-report":b(!0);break;case"check-conflicts":o("/planning");break;case"backup-data":o("/settings");break;case"import-data":o("/settings");break;case"sync-sheets":o("/settings"),h("Synchronisation Google Sheets lancée...","info");break;case"export-all-data":o("/settings"),h("Exportation de toutes les données lancée...","info");break;case"search-entities":o("/planning"),h("Redirection vers la recherche d'entités","info");break;case"show-statistics":h("Affichage des statistiques...","info");break}}}),e.jsx(me,{isOpen:T,onClose:()=>b(!1),onGenerate:t=>{const s=a.filter(d=>{if(t.period==="current-month"){const y=new Date,u=new Date(d.visitDate);return u.getMonth()===y.getMonth()&&u.getFullYear()===y.getFullYear()}return!0}),f=`rapport-kbv-${new Date().toISOString().slice(0,10)}`;if(t.format==="csv"){let d=`Date,Orateur,Congrégation,Discours,Thème,Hôte,Statut
`;s.forEach(l=>{d+=`${l.visitDate},${l.nom},${l.congregation},${l.talkNoOrType||""},${l.talkTheme||""},${l.host||""},${l.status}
`});const y=new Blob([d],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(y),i=document.createElement("a");i.href=u,i.download=`${f}.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(u),h("Rapport CSV généré !","success")}else if(t.format==="excel"){let d='<html><head><meta charset="utf-8"><style>table{border-collapse:collapse;width:100%;}th,td{border:1px solid black;padding:8px;text-align:left;}th{background-color:#4F46E5;color:white;}</style></head><body><h1>Rapport KBV Lyon</h1><table><tr><th>Date</th><th>Orateur</th><th>Congrégation</th><th>Discours</th><th>Thème</th><th>Hôte</th><th>Statut</th></tr>';s.forEach(l=>{d+=`<tr><td>${l.visitDate}</td><td>${l.nom}</td><td>${l.congregation}</td><td>${l.talkNoOrType||""}</td><td>${l.talkTheme||""}</td><td>${l.host||""}</td><td>${l.status}</td></tr>`}),d+="</table></body></html>";const y=new Blob([d],{type:"application/vnd.ms-excel"}),u=URL.createObjectURL(y),i=document.createElement("a");i.href=u,i.download=`${f}.xls`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(u),h("Rapport Excel généré !","success")}else if(t.format==="pdf"){let d=`<html><head><meta charset="utf-8"><style>body{font-family:Arial,sans-serif;margin:40px;}h1{color:#4F46E5;}table{border-collapse:collapse;width:100%;margin-top:20px;}th,td{border:1px solid #ddd;padding:12px;text-align:left;}th{background-color:#4F46E5;color:white;}</style></head><body><h1>Rapport KBV Lyon</h1><p>Généré le ${new Date().toLocaleDateString("fr-FR")}</p><table><tr><th>Date</th><th>Orateur</th><th>Congrégation</th><th>Discours</th><th>Thème</th><th>Hôte</th><th>Statut</th></tr>`;s.forEach(l=>{d+=`<tr><td>${new Date(l.visitDate).toLocaleDateString("fr-FR")}</td><td>${l.nom}</td><td>${l.congregation}</td><td>${l.talkNoOrType||""}</td><td>${l.talkTheme||""}</td><td>${l.host||""}</td><td>${l.status}</td></tr>`}),d+=`</table><p style="margin-top:30px;color:#666;">Total: ${s.length} visite(s)</p></body></html>`;const y=new Blob([d],{type:"text/html"}),u=URL.createObjectURL(y),i=document.createElement("a");i.href=u,i.download=`${f}.html`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(u),h("Rapport HTML généré ! Ouvrez-le et imprimez en PDF","success")}b(!1)}})]})};export{qe as Dashboard};
//# sourceMappingURL=Dashboard-D9z_c_PL.js.map
