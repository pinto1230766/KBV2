const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-DtfVBwU1.js","assets/index-CCbl2mUd.js","assets/react-vendor-B9D_A6Vq.js","assets/charts-Cazb4rp-.js","assets/utils-FTT-aY8U.js","assets/index-w-_z9Mvw.css"])))=>i.map(i=>d[i]);
import{c as d,G as p,_ as y,v as h,l as g}from"./index-CCbl2mUd.js";import{r}from"./charts-Cazb4rp-.js";import{f as D}from"./utils-FTT-aY8U.js";const b=d("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);const E=d("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);var c;(function(t){t[t.Sunday=1]="Sunday",t[t.Monday=2]="Monday",t[t.Tuesday=3]="Tuesday",t[t.Wednesday=4]="Wednesday",t[t.Thursday=5]="Thursday",t[t.Friday=6]="Friday",t[t.Saturday=7]="Saturday"})(c||(c={}));const o=p("LocalNotifications",{web:()=>y(()=>import("./web-DtfVBwU1.js"),__vite__mapDeps([0,1,2,3,4,5])).then(t=>new t.LocalNotificationsWeb)});function L(){const{settings:t}=h(),l=r.useCallback(async()=>(await o.requestPermissions()).display==="granted",[]),u=r.useCallback(async i=>{if(!t.notifications.enabled)return;const n=new Date(i.visitDate),e=t.notifications.reminderDays.length>0?t.notifications.reminderDays:[3];for(const a of e){const s=new Date(n);if(s.setDate(n.getDate()-a),s.setHours(9,0,0,0),!(s.getTime()<Date.now()))try{await o.schedule({notifications:[{title:"Rappel de visite",body:`Visite de ${i.nom} prÃ©vue le ${D(n,"EEEE d MMMM",{locale:g})} (J-${a})`,id:parseInt(i.id.replace(/\D/g,"").substring(0,5))+a*1e4||Math.floor(Math.random()*1e5),schedule:{at:s},sound:"default",attachments:[],actionTypeId:"",extra:{visitId:i.id}}]})}catch(m){console.error("Erreur lors de la programmation de la notification:",m)}}},[t.notifications]),f=r.useCallback(async i=>{const e=(await o.getPending()).notifications.find(a=>a.extra?.visitId===i);e&&await o.cancel({notifications:[{id:e.id}]})},[]);return{requestPermissions:l,scheduleVisitReminder:u,cancelVisitReminder:f}}export{b as L,E as S,o as a,L as u};
//# sourceMappingURL=useVisitNotifications-CJxDkWG_.js.map
