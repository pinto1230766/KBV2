{"version":3,"file":"Settings-yH4dBQNe.js","sources":["../../node_modules/lucide-react/dist/esm/icons/database.js","../../node_modules/lucide-react/dist/esm/icons/hard-drive.js","../../node_modules/lucide-react/dist/esm/icons/key.js","../../node_modules/lucide-react/dist/esm/icons/merge.js","../../node_modules/lucide-react/dist/esm/icons/monitor.js","../../node_modules/lucide-react/dist/esm/icons/moon.js","../../node_modules/lucide-react/dist/esm/icons/palette.js","../../node_modules/lucide-react/dist/esm/icons/shield.js","../../node_modules/lucide-react/dist/esm/icons/smartphone.js","../../node_modules/lucide-react/dist/esm/icons/sun.js","../../node_modules/lucide-react/dist/esm/icons/upload.js","../../src/components/settings/DuplicateDetectionModal.tsx","../../src/components/settings/BackupManagerModal.tsx","../../src/components/settings/ImportWizardModal.tsx","../../src/components/settings/ArchiveManagerModal.tsx","../../src/utils/phoneNumberUpdater.ts","../../src/components/settings/PhoneNumberImportModal.tsx","../../src/pages/Settings.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Database = createLucideIcon(\"Database\", [\n  [\"ellipse\", { cx: \"12\", cy: \"5\", rx: \"9\", ry: \"3\", key: \"msslwz\" }],\n  [\"path\", { d: \"M3 5V19A9 3 0 0 0 21 19V5\", key: \"1wlel7\" }],\n  [\"path\", { d: \"M3 12A9 3 0 0 0 21 12\", key: \"mv7ke4\" }]\n]);\n\nexport { Database as default };\n//# sourceMappingURL=database.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst HardDrive = createLucideIcon(\"HardDrive\", [\n  [\"line\", { x1: \"22\", x2: \"2\", y1: \"12\", y2: \"12\", key: \"1y58io\" }],\n  [\n    \"path\",\n    {\n      d: \"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z\",\n      key: \"oot6mr\"\n    }\n  ],\n  [\"line\", { x1: \"6\", x2: \"6.01\", y1: \"16\", y2: \"16\", key: \"sgf278\" }],\n  [\"line\", { x1: \"10\", x2: \"10.01\", y1: \"16\", y2: \"16\", key: \"1l4acy\" }]\n]);\n\nexport { HardDrive as default };\n//# sourceMappingURL=hard-drive.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Key = createLucideIcon(\"Key\", [\n  [\"circle\", { cx: \"7.5\", cy: \"15.5\", r: \"5.5\", key: \"yqb3hr\" }],\n  [\"path\", { d: \"m21 2-9.6 9.6\", key: \"1j0ho8\" }],\n  [\"path\", { d: \"m15.5 7.5 3 3L22 7l-3-3\", key: \"1rn1fs\" }]\n]);\n\nexport { Key as default };\n//# sourceMappingURL=key.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Merge = createLucideIcon(\"Merge\", [\n  [\"path\", { d: \"m8 6 4-4 4 4\", key: \"ybng9g\" }],\n  [\"path\", { d: \"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22\", key: \"1hyw0i\" }],\n  [\"path\", { d: \"m20 22-5-5\", key: \"1m27yz\" }]\n]);\n\nexport { Merge as default };\n//# sourceMappingURL=merge.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Monitor = createLucideIcon(\"Monitor\", [\n  [\"rect\", { width: \"20\", height: \"14\", x: \"2\", y: \"3\", rx: \"2\", key: \"48i651\" }],\n  [\"line\", { x1: \"8\", x2: \"16\", y1: \"21\", y2: \"21\", key: \"1svkeh\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"17\", y2: \"21\", key: \"vw1qmm\" }]\n]);\n\nexport { Monitor as default };\n//# sourceMappingURL=monitor.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Moon = createLucideIcon(\"Moon\", [\n  [\"path\", { d: \"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z\", key: \"a7tn18\" }]\n]);\n\nexport { Moon as default };\n//# sourceMappingURL=moon.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Palette = createLucideIcon(\"Palette\", [\n  [\"circle\", { cx: \"13.5\", cy: \"6.5\", r: \".5\", key: \"1xcu5\" }],\n  [\"circle\", { cx: \"17.5\", cy: \"10.5\", r: \".5\", key: \"736e4u\" }],\n  [\"circle\", { cx: \"8.5\", cy: \"7.5\", r: \".5\", key: \"clrty\" }],\n  [\"circle\", { cx: \"6.5\", cy: \"12.5\", r: \".5\", key: \"1s4xz9\" }],\n  [\n    \"path\",\n    {\n      d: \"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z\",\n      key: \"12rzf8\"\n    }\n  ]\n]);\n\nexport { Palette as default };\n//# sourceMappingURL=palette.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Shield = createLucideIcon(\"Shield\", [\n  [\"path\", { d: \"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10\", key: \"1irkt0\" }]\n]);\n\nexport { Shield as default };\n//# sourceMappingURL=shield.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Smartphone = createLucideIcon(\"Smartphone\", [\n  [\"rect\", { width: \"14\", height: \"20\", x: \"5\", y: \"2\", rx: \"2\", ry: \"2\", key: \"1yt0o3\" }],\n  [\"path\", { d: \"M12 18h.01\", key: \"mhygvu\" }]\n]);\n\nexport { Smartphone as default };\n//# sourceMappingURL=smartphone.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Sun = createLucideIcon(\"Sun\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"4\", key: \"4exip2\" }],\n  [\"path\", { d: \"M12 2v2\", key: \"tus03m\" }],\n  [\"path\", { d: \"M12 20v2\", key: \"1lh1kg\" }],\n  [\"path\", { d: \"m4.93 4.93 1.41 1.41\", key: \"149t6j\" }],\n  [\"path\", { d: \"m17.66 17.66 1.41 1.41\", key: \"ptbguv\" }],\n  [\"path\", { d: \"M2 12h2\", key: \"1t8f8n\" }],\n  [\"path\", { d: \"M20 12h2\", key: \"1q8mjw\" }],\n  [\"path\", { d: \"m6.34 17.66-1.41 1.41\", key: \"1m8zz5\" }],\n  [\"path\", { d: \"m19.07 4.93-1.41 1.41\", key: \"1shlcs\" }]\n]);\n\nexport { Sun as default };\n//# sourceMappingURL=sun.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Upload = createLucideIcon(\"Upload\", [\n  [\"path\", { d: \"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\", key: \"ih7n3h\" }],\n  [\"polyline\", { points: \"17 8 12 3 7 8\", key: \"t8dd8p\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"3\", y2: \"15\", key: \"widbto\" }]\n]);\n\nexport { Upload as default };\n//# sourceMappingURL=upload.js.map\n","import React, { useState, useMemo } from 'react';\r\nimport { Copy, Trash2, AlertTriangle, Merge, CheckCircle } from 'lucide-react';\r\nimport { Modal } from '@/components/ui/Modal';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Card, CardBody } from '@/components/ui/Card';\r\nimport { Speaker, Host, Visit } from '@/types';\r\nimport { useData } from '@/contexts/DataContext';\r\n\r\ninterface DuplicateDetectionModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onMerge: (_duplicates: DuplicateGroup[], _action: 'merge' | 'delete', _strategy?: 'keep-first' | 'keep-recent' | 'manual') => void;\r\n}\r\n\r\ninterface DuplicateGroup {\r\n  type: 'speaker' | 'host' | 'visit' | 'message' | 'archivedVisit';\r\n  items: any[];\r\n  similarity: number;\r\n  reason: string[];\r\n}\r\n\r\nexport const DuplicateDetectionModal: React.FC<DuplicateDetectionModalProps> = ({\r\n  isOpen,\r\n  onClose: _onClose,\r\n  onMerge: _onMerge\r\n}) => {\r\n  const { speakers, hosts, visits, speakerMessages, archivedVisits } = useData();\r\n  const [selectedGroups, setSelectedGroups] = useState<Set<number>>(new Set());\r\n  const [mergeStrategy, setMergeStrategy] = useState<'keep-first' | 'keep-recent' | 'manual'>('keep-recent');\r\n  const [includeArchives, setIncludeArchives] = useState(false);\r\n  \r\n  // Seuils de similarité pour la détection des doublons\r\n  const SIMILARITY_THRESHOLD_HIGH = 95;\r\n  const SIMILARITY_THRESHOLD_MEDIUM = 90;\r\n\r\n  // Algorithme de détection de doublons\r\n  const duplicateGroups = useMemo(() => {\r\n    const groups: DuplicateGroup[] = [];\r\n\r\n    // 1. Détection de doublons d'orateurs\r\n    const speakerGroups = new Map<string, Speaker[]>();\r\n    speakers.forEach(speaker => {\r\n      const normalizedName = speaker.nom.toLowerCase().trim().replace(/\\s+/g, ' ');\r\n      const key = normalizedName;\r\n      \r\n      if (!speakerGroups.has(key)) {\r\n        speakerGroups.set(key, []);\r\n      }\r\n      speakerGroups.get(key)!.push(speaker);\r\n    });\r\n\r\n    speakerGroups.forEach((group) => {\r\n      if (group.length > 1) {\r\n        const reasons: string[] = ['Nom identique'];\r\n        \r\n        // Vérifier téléphone identique\r\n        const phones = group.map(s => s.telephone).filter(Boolean);\r\n        if (phones.length > 1 && new Set(phones).size < phones.length) {\r\n          reasons.push('Téléphone identique');\r\n        }\r\n\r\n        // Vérifier congrégation identique\r\n        const congregations = group.map(s => s.congregation);\r\n        if (new Set(congregations).size === 1) {\r\n          reasons.push('Même congrégation');\r\n        }\r\n\r\n        const similarity = SIMILARITY_THRESHOLD_HIGH;\r\n        groups.push({\r\n          type: 'speaker',\r\n          items: group,\r\n          similarity,\r\n          reason: reasons\r\n        });\r\n      }\r\n    });\r\n\r\n    // 2. Détection de doublons d'hôtes\r\n    const hostGroups = new Map<string, Host[]>();\r\n    hosts.forEach(host => {\r\n      const normalizedName = host.nom.toLowerCase().trim().replace(/\\s+/g, ' ');\r\n      const key = normalizedName;\r\n      \r\n      if (!hostGroups.has(key)) {\r\n        hostGroups.set(key, []);\r\n      }\r\n      hostGroups.get(key)!.push(host);\r\n    });\r\n\r\n    hostGroups.forEach((group) => {\r\n      if (group.length > 1) {\r\n        const reasons: string[] = ['Nom identique'];\r\n        \r\n        const phones = group.map(h => h.telephone).filter(Boolean);\r\n        if (phones.length > 1 && new Set(phones).size < phones.length) {\r\n          reasons.push('Téléphone identique');\r\n        }\r\n\r\n        const addresses = group.map(h => h.address).filter(Boolean);\r\n        if (addresses.length > 1 && new Set(addresses).size < addresses.length) {\r\n          reasons.push('Adresse identique');\r\n        }\r\n\r\n        const similarity = SIMILARITY_THRESHOLD_HIGH;\r\n        groups.push({\r\n          type: 'host',\r\n          items: group,\r\n          similarity,\r\n          reason: reasons\r\n        });\r\n      }\r\n    });\r\n\r\n    // 3. Détection de visites en double\r\n    const visitGroups = new Map<string, Visit[]>();\r\n    visits.forEach(visit => {\r\n      const key = `${visit.id}-${visit.visitDate}-${visit.visitTime}`;\r\n      \r\n      if (!visitGroups.has(key)) {\r\n        visitGroups.set(key, []);\r\n      }\r\n      visitGroups.get(key)!.push(visit);\r\n    });\r\n\r\n    visitGroups.forEach((group) => {\r\n      if (group.length > 1) {\r\n        groups.push({\r\n          type: 'visit',\r\n          items: group,\r\n          similarity: 100,\r\n          reason: ['Même orateur, date et heure']\r\n        });\r\n      }\r\n    });\r\n\r\n    // 4. Détection de doublons dans les archives (si activé)\r\n    if (includeArchives && archivedVisits) {\r\n      // Vérifier les doublons entre archives uniquement\r\n      const archivedVisitGroups = new Map<string, any[]>();\r\n      archivedVisits.forEach(visit => {\r\n        const key = `${visit.id}-${visit.visitDate}-${visit.visitTime}`;\r\n        \r\n        if (!archivedVisitGroups.has(key)) {\r\n          archivedVisitGroups.set(key, []);\r\n        }\r\n        archivedVisitGroups.get(key)!.push(visit);\r\n      });\r\n\r\n      archivedVisitGroups.forEach((group) => {\r\n        if (group.length > 1) {\r\n          groups.push({\r\n            type: 'archivedVisit',\r\n            items: group,\r\n            similarity: 100,\r\n            reason: ['Doublon dans les archives - Même orateur, date et heure']\r\n          });\r\n        }\r\n      });\r\n\r\n      // Vérifier les doublons entre visites actuelles et archives\r\n      const crossVisitGroups = new Map<string, any[]>();\r\n      visits.forEach(currentVisit => {\r\n        const key = `${currentVisit.id}-${currentVisit.visitDate}-${currentVisit.visitTime}`;\r\n        \r\n        if (!crossVisitGroups.has(key)) {\r\n          crossVisitGroups.set(key, []);\r\n        }\r\n        crossVisitGroups.get(key)!.push({ ...currentVisit, _source: 'current' });\r\n        \r\n        // Ajouter les visites archivées correspondantes\r\n        const matchingArchived = archivedVisits.filter(av =>\r\n          av.id === currentVisit.id &&\r\n          av.visitDate === currentVisit.visitDate &&\r\n          av.visitTime === currentVisit.visitTime\r\n        );\r\n        \r\n        matchingArchived.forEach(archived => {\r\n          crossVisitGroups.get(key)!.push({ ...archived, _source: 'archived' });\r\n        });\r\n      });\r\n\r\n      crossVisitGroups.forEach((group) => {\r\n        if (group.length > 1) {\r\n          groups.push({\r\n            type: 'archivedVisit',\r\n            items: group,\r\n            similarity: 100,\r\n            reason: ['Doublon entre visites actuelles et archivées']\r\n          });\r\n        }\r\n      });\r\n    }\r\n\r\n    // 5. Détection de messages en double\r\n    const messageGroups = new Map<string, any[]>();\r\n    if (speakerMessages && speakerMessages.length > 0) {\r\n      speakerMessages.forEach(msg => {\r\n        // Clé combinant l'ID de l'orateur, le contenu et la date de réception\r\n        const normalizedContent = msg.message?.trim().toLowerCase() || '';\r\n        const dateKey = msg.receivedAt ? new Date(msg.receivedAt).toISOString() : 'no-date';\r\n        // On considère un doublon si même orateur, même message, même date (à la seconde près)\r\n        const key = `${msg.speakerId}-${normalizedContent}-${dateKey}`;\r\n        \r\n        if (!messageGroups.has(key)) {\r\n          messageGroups.set(key, []);\r\n        }\r\n        messageGroups.get(key)!.push(msg);\r\n      });\r\n    }\r\n\r\n    messageGroups.forEach((group) => {\r\n      if (group.length > 1) {\r\n        groups.push({\r\n          type: 'message',\r\n          items: group,\r\n          similarity: 100,\r\n          reason: ['Contenu et date identiques']\r\n        });\r\n      }\r\n    });\r\n\r\n    return groups;\r\n  }, [speakers, hosts, visits, speakerMessages, archivedVisits, includeArchives]);\r\n\r\n  const toggleGroup = (index: number) => {\r\n    setSelectedGroups(prev => {\r\n      const newSet = new Set(prev);\r\n      if (newSet.has(index)) {\r\n        newSet.delete(index);\r\n      } else {\r\n        newSet.add(index);\r\n      }\r\n      return newSet;\r\n    });\r\n  };\r\n\r\n  const handleMerge = () => {\r\n    const selectedDuplicates = Array.from(selectedGroups).map(idx => duplicateGroups[idx]);\r\n    _onMerge(selectedDuplicates, 'merge', mergeStrategy);\r\n    setSelectedGroups(new Set());\r\n  };\r\n\r\n  const handleDelete = () => {\r\n    // Supprimer les doublons (keep one?) No, modal says \"Delete Duplicates\" which usually calls onMerge(..., delete).\r\n    // The previous implementation used _onMerge with 'delete'.\r\n    const selectedDuplicates = Array.from(selectedGroups).map(idx => duplicateGroups[idx]);\r\n    _onMerge(selectedDuplicates, 'delete', mergeStrategy);\r\n    setSelectedGroups(new Set());\r\n  };\r\n\r\n  const getTypeLabel = (type: DuplicateGroup['type']) => {\r\n    switch (type) {\r\n      case 'speaker': return 'Orateur';\r\n      case 'host': return 'Hôte';\r\n      case 'visit': return 'Visite';\r\n      case 'archivedVisit': return 'Visite archivée';\r\n      case 'message': return 'Message';\r\n      default: return 'Inconnu';\r\n    }\r\n  };\r\n\r\n  const getTypeColor = (type: DuplicateGroup['type']) => {\r\n    switch (type) {\r\n      case 'speaker': return 'bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300';\r\n      case 'host': return 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300';\r\n      case 'visit': return 'bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-300';\r\n      case 'archivedVisit': return 'bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-300';\r\n      case 'message': return 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300';\r\n      default: return 'bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-300';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={_onClose}\r\n      title=\"Détection de doublons\"\r\n      size=\"xl\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {/* Statistiques */}\r\n        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\r\n          <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-blue-600\">\r\n              {duplicateGroups.filter(g => g.type === 'speaker').length}\r\n            </div>\r\n            <div className=\"text-sm text-blue-800 dark:text-blue-300\">Orateurs</div>\r\n          </div>\r\n          <div className=\"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              {duplicateGroups.filter(g => g.type === 'host').length}\r\n            </div>\r\n            <div className=\"text-sm text-green-800 dark:text-green-300\">Hôtes</div>\r\n          </div>\r\n          <div className=\"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-purple-600\">\r\n              {duplicateGroups.filter(g => g.type === 'visit').length}\r\n            </div>\r\n            <div className=\"text-sm text-purple-800 dark:text-purple-300\">Visites</div>\r\n          </div>\r\n          <div className=\"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-orange-600\">\r\n              {duplicateGroups.filter(g => g.type === 'archivedVisit').length}\r\n            </div>\r\n            <div className=\"text-sm text-orange-800 dark:text-orange-300\">Archives</div>\r\n          </div>\r\n          <div className=\"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-red-600\">\r\n              {duplicateGroups.filter(g => g.type === 'message').length}\r\n            </div>\r\n            <div className=\"text-sm text-red-800 dark:text-red-300\">Messages</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Option pour inclure les archives */}\r\n        <div className=\"flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n          <input\r\n            type=\"checkbox\"\r\n            id=\"include-archives\"\r\n            checked={includeArchives}\r\n            onChange={(e) => setIncludeArchives(e.target.checked)}\r\n            className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n          />\r\n          <label htmlFor=\"include-archives\" className=\"cursor-pointer\">\r\n            <div className=\"font-medium text-gray-900 dark:text-white\">\r\n              Inclure les archives dans l'analyse\r\n            </div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n              Détecte les doublons dans les visites archivées et entre visites actuelles/archivées\r\n            </div>\r\n          </label>\r\n        </div>\r\n\r\n        {/* Stratégie de fusion */}\r\n        {selectedGroups.size > 0 && (\r\n          <div className=\"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n              Stratégie de fusion\r\n            </label>\r\n            <div className=\"space-y-2\">\r\n              <label className=\"flex items-center gap-2 cursor-pointer\">\r\n                <input\r\n                  type=\"radio\"\r\n                  value=\"keep-recent\"\r\n                  checked={mergeStrategy === 'keep-recent'}\r\n                  onChange={(e) => setMergeStrategy(e.target.value as any)}\r\n                  className=\"w-4 h-4 text-primary-600\"\r\n                />\r\n                <span className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n                  Conserver l'entrée la plus récente\r\n                </span>\r\n              </label>\r\n              <label className=\"flex items-center gap-2 cursor-pointer\">\r\n                <input\r\n                  type=\"radio\"\r\n                  value=\"keep-first\"\r\n                  checked={mergeStrategy === 'keep-first'}\r\n                  onChange={(e) => setMergeStrategy(e.target.value as any)}\r\n                  className=\"w-4 h-4 text-primary-600\"\r\n                />\r\n                <span className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n                  Conserver la première entrée\r\n                </span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Liste des doublons */}\r\n        <div className=\"space-y-4 max-h-96 overflow-y-auto\">\r\n          {duplicateGroups.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <CheckCircle className=\"w-16 h-16 mx-auto mb-4 text-green-500\" />\r\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\r\n                Aucun doublon détecté\r\n              </h3>\r\n              <p className=\"text-gray-600 dark:text-gray-400\">\r\n                Vos données sont propres et sans doublons\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              <div className=\"flex items-center gap-3 p-3 bg-gray-100 dark:bg-gray-800 rounded-lg mb-2 sticky top-0 z-10\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  aria-label=\"Tout sélectionner\"\r\n                  checked={duplicateGroups.length > 0 && selectedGroups.size === duplicateGroups.length}\r\n                  onChange={(e) => {\r\n                    if (e.target.checked) {\r\n                      setSelectedGroups(new Set(duplicateGroups.map((_, i) => i)));\r\n                    } else {\r\n                      setSelectedGroups(new Set());\r\n                    }\r\n                  }}\r\n                  className=\"w-5 h-5 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n                />\r\n                <span className=\"font-medium text-gray-700 dark:text-gray-300\">\r\n                  Tout sélectionner ({duplicateGroups.length})\r\n                </span>\r\n                {selectedGroups.size > 0 && (\r\n                  <span className=\"text-sm text-gray-500 ml-auto\">\r\n                    {selectedGroups.size} sélectionné(s)\r\n                  </span>\r\n                )}\r\n              </div>\r\n              {duplicateGroups.map((group, index) => (\r\n                <Card\r\n                  key={index}\r\n                className={`${\r\n                  group.similarity >= SIMILARITY_THRESHOLD_MEDIUM ? 'border-l-4 border-l-red-600' : 'border-l-4 border-l-orange-500'\r\n                } ${\r\n                  selectedGroups.has(index) ? 'ring-2 ring-primary-500' : ''\r\n                }`}\r\n              >\r\n                <CardBody>\r\n                  <div className=\"space-y-4\">\r\n                    {/* En-tête */}\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedGroups.has(index)}\r\n                          onChange={() => toggleGroup(index)}\r\n                          aria-label={`Sélectionner ce groupe de doublons ${getTypeLabel(group.type)}`}\r\n                          className=\"w-5 h-5 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n                        />\r\n                        <div>\r\n                          <div className=\"flex items-center gap-2 mb-1\">\r\n                            <Badge className={getTypeColor(group.type)}>\r\n                              {getTypeLabel(group.type)}\r\n                            </Badge>\r\n                            <Badge variant=\"warning\">\r\n                              {group.similarity}% similaire\r\n                            </Badge>\r\n                          </div>\r\n                          <div className=\"flex flex-wrap gap-1\">\r\n                            {group.reason.map((reason, idx) => (\r\n                              <span key={idx} className=\"text-xs text-gray-600 dark:text-gray-400\">\r\n                                • {reason}\r\n                              </span>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <Copy className=\"w-5 h-5 text-gray-400\" />\r\n                    </div>\r\n\r\n                    {/* Items en double */}\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                      {group.items.map((item: any, itemIdx) => (\r\n                        <div\r\n                          key={itemIdx}\r\n                          className=\"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg\"\r\n                        >\r\n                          <div className=\"font-medium text-gray-900 dark:text-white mb-2\">\r\n                            {group.type === 'message' ? (item.subject || 'Message sans sujet') : (item.nom || `Visite ${itemIdx + 1}`)}\r\n                          </div>\r\n                          <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\r\n                            {group.type === 'speaker' && (\r\n                              <>\r\n                                <div>Congrégation : {item.congregation}</div>\r\n                                {item.telephone && <div>Tél : {item.telephone}</div>}\r\n                                {item.email && <div>Email : {item.email}</div>}\r\n                                <div>Visites : {visits.filter(v => v.id === item.id).length}</div>\r\n                                <div>Messages : {visits.filter(v => v.id === item.id && v.communicationStatus).length}</div>\r\n                                {item.createdAt && (\r\n                                  <div className=\"text-xs\">\r\n                                    Créé : {new Date(item.createdAt).toLocaleDateString('fr-FR')}\r\n                                  </div>\r\n                                )}\r\n                              </>\r\n                            )}\r\n                            {group.type === 'host' && (\r\n                              <>\r\n                                {item.telephone && <div>Tél : {item.telephone}</div>}\r\n                                {item.address && <div>Adresse : {item.address}</div>}\r\n                                {item.createdAt && (\r\n                                  <div className=\"text-xs\">\r\n                                    Créé : {new Date(item.createdAt).toLocaleDateString('fr-FR')}\r\n                                  </div>\r\n                                )}\r\n                              </>\r\n                            )}\r\n                            {group.type === 'visit' && (\r\n                              <>\r\n                                <div>Date : {new Date(item.visitDate).toLocaleDateString('fr-FR')}</div>\r\n                                <div>Heure : {item.visitTime}</div>\r\n                                <div>Statut : {item.status}</div>\r\n                              </>\r\n                            )}\r\n                            {group.type === 'message' && (\r\n                              <>\r\n                                <div>Orateur : {item.speakerName}</div>\r\n                                <div>Date : {new Date(item.receivedAt).toLocaleDateString('fr-FR')} {new Date(item.receivedAt).toLocaleTimeString('fr-FR')}</div>\r\n                                <div className=\"line-clamp-2\">Contenu : {item.message}</div>\r\n                              </>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                </CardBody>\r\n              </Card>\r\n            ))}\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* Avertissement */}\r\n        {selectedGroups.size > 0 && (\r\n          <div className=\"flex items-start gap-3 p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg\">\r\n            <AlertTriangle className=\"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5\" />\r\n            <div className=\"text-sm text-orange-800 dark:text-orange-300\">\r\n              <strong>Attention :</strong> La fusion des doublons est irréversible. Assurez-vous de vérifier les données avant de continuer.\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n          <Button variant=\"secondary\" onClick={_onClose}>\r\n            Fermer\r\n          </Button>\r\n          {selectedGroups.size > 0 && (\r\n            <>\r\n              <Button variant=\"danger\" onClick={handleDelete}>\r\n                <Trash2 className=\"w-4 h-4 mr-2\" />\r\n                Supprimer les doublons ({selectedGroups.size})\r\n              </Button>\r\n              <Button variant=\"primary\" onClick={handleMerge}>\r\n                <Merge className=\"w-4 h-4 mr-2\" />\r\n                Fusionner ({selectedGroups.size})\r\n              </Button>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React, { useState } from 'react';\r\nimport { Save, Download, Upload, Clock, HardDrive, Shield, CheckCircle, AlertTriangle } from 'lucide-react';\r\nimport { Modal } from '@/components/ui/Modal';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Card, CardBody } from '@/components/ui/Card';\r\n\r\ninterface BackupManagerModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onBackup: (options: BackupOptions) => Promise<void>;\r\n  onRestore: (file: File) => Promise<void>;\r\n}\r\n\r\ninterface BackupOptions {\r\n  includeArchived: boolean;\r\n  includeSettings: boolean;\r\n  includeTemplates: boolean;\r\n  encrypt: boolean;\r\n  password?: string;\r\n}\r\n\r\ninterface BackupHistory {\r\n  id: string;\r\n  date: string;\r\n  size: number;\r\n  itemsCount: number;\r\n  encrypted: boolean;\r\n}\r\n\r\nexport const BackupManagerModal: React.FC<BackupManagerModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onBackup,\r\n  onRestore\r\n}) => {\r\n  const [activeTab, setActiveTab] = useState<'backup' | 'restore' | 'history'>('backup');\r\n  const [includeArchived, setIncludeArchived] = useState(true);\r\n  const [includeSettings, setIncludeSettings] = useState(true);\r\n  const [includeTemplates, setIncludeTemplates] = useState(true);\r\n  const [encrypt, setEncrypt] = useState(false);\r\n  const [password, setPassword] = useState('');\r\n  const [confirmPassword, setConfirmPassword] = useState('');\r\n  const [isCreating, setIsCreating] = useState(false);\r\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n\r\n  // Simuler l'historique des sauvegardes (à remplacer par les vraies données)\r\n  const backupHistory: BackupHistory[] = [\r\n    {\r\n      id: '1',\r\n      date: new Date().toISOString(),\r\n      size: 2048576,\r\n      itemsCount: 150,\r\n      encrypted: true\r\n    }\r\n  ];\r\n\r\n  const handleCreateBackup = async () => {\r\n    if (encrypt && password !== confirmPassword) {\r\n      alert('Les mots de passe ne correspondent pas');\r\n      return;\r\n    }\r\n\r\n    setIsCreating(true);\r\n    try {\r\n      const options: BackupOptions = {\r\n        includeArchived,\r\n        includeSettings,\r\n        includeTemplates,\r\n        encrypt,\r\n        password: encrypt ? password : undefined\r\n      };\r\n\r\n      await onBackup(options);\r\n      \r\n      // Réinitialiser le formulaire\r\n      setPassword('');\r\n      setConfirmPassword('');\r\n      setIsCreating(false);\r\n    } catch (error) {\r\n      console.error('Erreur lors de la sauvegarde:', error);\r\n      setIsCreating(false);\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      setSelectedFile(file);\r\n    }\r\n  };\r\n\r\n  const handleRestore = async () => {\r\n    if (!selectedFile) return;\r\n\r\n    if (confirm('⚠️ La restauration remplacera toutes les données actuelles. Êtes-vous sûr de vouloir continuer ?')) {\r\n      try {\r\n        await onRestore(selectedFile);\r\n        onClose();\r\n      } catch (error) {\r\n        console.error('Erreur lors de la restauration:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const formatFileSize = (bytes: number) => {\r\n    if (bytes < 1024) return `${bytes  } B`;\r\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(2)  } KB`;\r\n    return `${(bytes / (1024 * 1024)).toFixed(2)  } MB`;\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Gestion des sauvegardes\"\r\n      size=\"lg\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {/* Onglets */}\r\n        <div className=\"flex gap-2 border-b border-gray-200 dark:border-gray-700\">\r\n          <button\r\n            onClick={() => setActiveTab('backup')}\r\n            className={`px-4 py-2 font-medium transition-colors ${\r\n              activeTab === 'backup'\r\n                ? 'text-primary-600 border-b-2 border-primary-600'\r\n                : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'\r\n            }`}\r\n          >\r\n            <Save className=\"w-4 h-4 inline mr-2\" />\r\n            Créer une sauvegarde\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('restore')}\r\n            className={`px-4 py-2 font-medium transition-colors ${\r\n              activeTab === 'restore'\r\n                ? 'text-primary-600 border-b-2 border-primary-600'\r\n                : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'\r\n            }`}\r\n          >\r\n            <Upload className=\"w-4 h-4 inline mr-2\" />\r\n            Restaurer\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('history')}\r\n            className={`px-4 py-2 font-medium transition-colors ${\r\n              activeTab === 'history'\r\n                ? 'text-primary-600 border-b-2 border-primary-600'\r\n                : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'\r\n            }`}\r\n          >\r\n            <Clock className=\"w-4 h-4 inline mr-2\" />\r\n            Historique\r\n          </button>\r\n        </div>\r\n\r\n        {/* Contenu - Créer une sauvegarde */}\r\n        {activeTab === 'backup' && (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <HardDrive className=\"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5\" />\r\n                <div className=\"text-sm text-blue-800 dark:text-blue-300\">\r\n                  <strong>Sauvegarde locale :</strong> Les données seront exportées dans un fichier JSON téléchargeable. Conservez ce fichier en lieu sûr pour pouvoir restaurer vos données en cas de besoin.\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Options de sauvegarde */}\r\n            <div className=\"space-y-3\">\r\n              <h4 className=\"font-medium text-gray-900 dark:text-white\">\r\n                Données à inclure\r\n              </h4>\r\n              \r\n              <label className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={includeArchived}\r\n                  onChange={(e) => setIncludeArchived(e.target.checked)}\r\n                  className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n                />\r\n                <div className=\"flex-1\">\r\n                  <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                    Visites archivées\r\n                  </span>\r\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                    Inclure l'historique complet des visites passées\r\n                  </p>\r\n                </div>\r\n              </label>\r\n\r\n              <label className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={includeSettings}\r\n                  onChange={(e) => setIncludeSettings(e.target.checked)}\r\n                  className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n                />\r\n                <div className=\"flex-1\">\r\n                  <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                    Paramètres de l'application\r\n                  </span>\r\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                    Thème, langue, notifications, etc.\r\n                  </p>\r\n                </div>\r\n              </label>\r\n\r\n              <label className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={includeTemplates}\r\n                  onChange={(e) => setIncludeTemplates(e.target.checked)}\r\n                  className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n                />\r\n                <div className=\"flex-1\">\r\n                  <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                    Templates personnalisés\r\n                  </span>\r\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                    Modèles de messages et configurations personnalisées\r\n                  </p>\r\n                </div>\r\n              </label>\r\n            </div>\r\n\r\n            {/* Chiffrement */}\r\n            <div className=\"space-y-3\">\r\n              <label className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={encrypt}\r\n                  onChange={(e) => setEncrypt(e.target.checked)}\r\n                  className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n                />\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Shield className=\"w-4 h-4 text-primary-600\" />\r\n                    <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                      Chiffrer la sauvegarde\r\n                    </span>\r\n                  </div>\r\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n                    Protéger les données sensibles avec un mot de passe\r\n                  </p>\r\n                </div>\r\n              </label>\r\n\r\n              {encrypt && (\r\n                <div className=\"space-y-3 pl-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Mot de passe\r\n                    </label>\r\n                    <input\r\n                      type=\"password\"\r\n                      value={password}\r\n                      onChange={(e) => setPassword(e.target.value)}\r\n                      className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n                      placeholder=\"Entrez un mot de passe\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Confirmer le mot de passe\r\n                    </label>\r\n                    <input\r\n                      type=\"password\"\r\n                      value={confirmPassword}\r\n                      onChange={(e) => setConfirmPassword(e.target.value)}\r\n                      className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n                      placeholder=\"Confirmez le mot de passe\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <Button\r\n              variant=\"primary\"\r\n              onClick={handleCreateBackup}\r\n              disabled={isCreating || (encrypt && (!password || password !== confirmPassword))}\r\n              className=\"w-full\"\r\n            >\r\n              <Download className=\"w-4 h-4 mr-2\" />\r\n              {isCreating ? 'Création en cours...' : 'Créer et télécharger la sauvegarde'}\r\n            </Button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Contenu - Restaurer */}\r\n        {activeTab === 'restore' && (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <AlertTriangle className=\"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5\" />\r\n                <div className=\"text-sm text-orange-800 dark:text-orange-300\">\r\n                  <strong>Attention :</strong> La restauration remplacera toutes les données actuelles. Assurez-vous d'avoir créé une sauvegarde récente avant de continuer.\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8\">\r\n              <div className=\"text-center\">\r\n                <Upload className=\"w-12 h-12 mx-auto mb-4 text-gray-400\" />\r\n                <h4 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\r\n                  Sélectionner un fichier de sauvegarde\r\n                </h4>\r\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\r\n                  Fichier JSON (.json) exporté précédemment\r\n                </p>\r\n                <input\r\n                  type=\"file\"\r\n                  accept=\".json\"\r\n                  onChange={handleFileSelect}\r\n                  className=\"hidden\"\r\n                  id=\"backup-file\"\r\n                />\r\n                <label htmlFor=\"backup-file\">\r\n                  <span className=\"inline-flex items-center justify-center px-4 py-2 border-2 border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 text-gray-700 dark:text-gray-300 font-medium rounded-lg cursor-pointer transition-colors\">\r\n                    Parcourir\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n\r\n            {selectedFile && (\r\n              <div className=\"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <CheckCircle className=\"w-5 h-5 text-green-600\" />\r\n                    <div>\r\n                      <div className=\"font-medium text-green-900 dark:text-green-200\">\r\n                        {selectedFile.name}\r\n                      </div>\r\n                      <div className=\"text-sm text-green-800 dark:text-green-300\">\r\n                        {formatFileSize(selectedFile.size)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <Button variant=\"danger\" onClick={handleRestore}>\r\n                    Restaurer\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Contenu - Historique */}\r\n        {activeTab === 'history' && (\r\n          <div className=\"space-y-4\">\r\n            {backupHistory.length === 0 ? (\r\n              <div className=\"text-center py-12\">\r\n                <Clock className=\"w-16 h-16 mx-auto mb-4 text-gray-400\" />\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\r\n                  Aucune sauvegarde\r\n                </h3>\r\n                <p className=\"text-gray-600 dark:text-gray-400\">\r\n                  Créez votre première sauvegarde pour sécuriser vos données\r\n                </p>\r\n              </div>\r\n            ) : (\r\n              backupHistory.map((backup) => (\r\n                <Card key={backup.id}>\r\n                  <CardBody>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center gap-4\">\r\n                        <div className=\"p-3 bg-primary-100 dark:bg-primary-900 rounded-lg\">\r\n                          <HardDrive className=\"w-6 h-6 text-primary-600\" />\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"font-medium text-gray-900 dark:text-white\">\r\n                            {new Date(backup.date).toLocaleDateString('fr-FR', {\r\n                              day: 'numeric',\r\n                              month: 'long',\r\n                              year: 'numeric',\r\n                              hour: '2-digit',\r\n                              minute: '2-digit'\r\n                            })}\r\n                          </div>\r\n                          <div className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                            {backup.itemsCount} éléments • {formatFileSize(backup.size)}\r\n                            {backup.encrypted && (\r\n                              <Badge variant=\"default\" className=\"ml-2\">\r\n                                <Shield className=\"w-3 h-3 mr-1\" />\r\n                                Chiffré\r\n                              </Badge>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <Button variant=\"outline\" size=\"sm\">\r\n                        <Download className=\"w-4 h-4\" />\r\n                      </Button>\r\n                    </div>\r\n                  </CardBody>\r\n                </Card>\r\n              ))\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n          <Button variant=\"secondary\" onClick={onClose}>\r\n            Fermer\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React, { useState } from 'react';\r\nimport { Upload, FileText, CheckCircle, AlertTriangle, ArrowRight, Download } from 'lucide-react';\r\nimport { Modal } from '@/components/ui/Modal';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Card, CardBody } from '@/components/ui/Card';\r\nimport { ImportResult } from '@/types';\r\n\r\ninterface ImportWizardModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onImport: (data: any, mapping: ColumnMapping) => Promise<ImportResult>;\r\n}\r\n\r\ninterface ColumnMapping {\r\n  [key: string]: string; // clé = colonne source, valeur = champ cible\r\n}\r\n\r\ntype ImportStep = 'upload' | 'mapping' | 'preview' | 'import' | 'result';\r\n\r\nconst AVAILABLE_FIELDS = {\r\n  speakers: [\r\n    { key: 'nom', label: 'Nom', required: true },\r\n    { key: 'congregation', label: 'Congrégation', required: true },\r\n    { key: 'telephone', label: 'Téléphone', required: false },\r\n    { key: 'email', label: 'Email', required: false },\r\n    { key: 'gender', label: 'Genre (male/female/couple)', required: false },\r\n  ],\r\n  visits: [\r\n    { key: 'nom', label: 'Nom orateur', required: true },\r\n    { key: 'visitDate', label: 'Date (YYYY-MM-DD)', required: true },\r\n    { key: 'visitTime', label: 'Heure (HH:MM)', required: true },\r\n    { key: 'talkNoOrType', label: 'N° discours', required: false },\r\n    { key: 'talkTheme', label: 'Thème discours', required: false },\r\n    { key: 'host', label: 'Hôte', required: false },\r\n    { key: 'status', label: 'Statut', required: false },\r\n  ],\r\n  hosts: [\r\n    { key: 'nom', label: 'Nom', required: true },\r\n    { key: 'telephone', label: 'Téléphone', required: false },\r\n    { key: 'email', label: 'Email', required: false },\r\n    { key: 'address', label: 'Adresse', required: false },\r\n    { key: 'gender', label: 'Genre (male/female/couple)', required: false },\r\n  ]\r\n};\r\n\r\nexport const ImportWizardModal: React.FC<ImportWizardModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onImport\r\n}) => {\r\n  const [currentStep, setCurrentStep] = useState<ImportStep>('upload');\r\n  const [importType, setImportType] = useState<'speakers' | 'visits' | 'hosts'>('speakers');\r\n  const [file, setFile] = useState<File | null>(null);\r\n  const [parsedData, setParsedData] = useState<any[]>([]);\r\n  const [columns, setColumns] = useState<string[]>([]);\r\n  const [mapping, setMapping] = useState<ColumnMapping>({});\r\n  const [importResult, setImportResult] = useState<ImportResult | null>(null);\r\n\r\n  const handleFileSelect = async (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const selectedFile = event.target.files?.[0];\r\n    if (!selectedFile) return;\r\n\r\n    setFile(selectedFile);\r\n\r\n    // Parser le fichier CSV\r\n    const text = await selectedFile.text();\r\n    const lines = text.split('\\n').filter(line => line.trim());\r\n    \r\n    if (lines.length === 0) return;\r\n\r\n    // Extraire les colonnes (première ligne)\r\n    const headers = lines[0].split(',').map(h => h.trim().replace(/\"/g, ''));\r\n    setColumns(headers);\r\n\r\n    // Parser les données\r\n    const data = lines.slice(1).map(line => {\r\n      const values = line.split(',').map(v => v.trim().replace(/\"/g, ''));\r\n      const row: any = {};\r\n      headers.forEach((header, index) => {\r\n        row[header] = values[index] || '';\r\n      });\r\n      return row;\r\n    });\r\n\r\n    setParsedData(data);\r\n    setCurrentStep('mapping');\r\n  };\r\n\r\n  const handleMappingChange = (sourceColumn: string, targetField: string) => {\r\n    setMapping(prev => ({\r\n      ...prev,\r\n      [sourceColumn]: targetField\r\n    }));\r\n  };\r\n\r\n  const handleImport = async () => {\r\n    setCurrentStep('import');\r\n\r\n    try {\r\n      // Transformer les données selon le mapping\r\n      const transformedData = parsedData.map(row => {\r\n        const transformed: any = {};\r\n        Object.entries(mapping).forEach(([sourceCol, targetField]) => {\r\n          if (targetField && row[sourceCol]) {\r\n            transformed[targetField] = row[sourceCol];\r\n          }\r\n        });\r\n        return transformed;\r\n      });\r\n\r\n      const result = await onImport(transformedData, mapping);\r\n      setImportResult(result);\r\n      setCurrentStep('result');\r\n    } catch (error) {\r\n      console.error('Erreur lors de l\\'import:', error);\r\n    }\r\n  };\r\n\r\n  const getMappingProgress = () => {\r\n    const requiredFields = AVAILABLE_FIELDS[importType].filter(f => f.required);\r\n    const mappedRequired = requiredFields.filter(f => \r\n      Object.values(mapping).includes(f.key)\r\n    );\r\n    return `${mappedRequired.length}/${requiredFields.length}`;\r\n  };\r\n\r\n  const canProceed = () => {\r\n    const requiredFields = AVAILABLE_FIELDS[importType].filter(f => f.required);\r\n    return requiredFields.every(f => Object.values(mapping).includes(f.key));\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Assistant d'importation\"\r\n      size=\"xl\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {/* Indicateur de progression */}\r\n        <div className=\"flex items-center justify-between\">\r\n          {['upload', 'mapping', 'preview', 'import', 'result'].map((step, index) => (\r\n            <React.Fragment key={step}>\r\n              <div className={`flex items-center gap-2 ${\r\n                currentStep === step ? 'text-primary-600' : \r\n                ['upload', 'mapping', 'preview'].indexOf(currentStep) > index ? 'text-green-600' : 'text-gray-400'\r\n              }`}>\r\n                <div className={`w-8 h-8 rounded-full flex items-center justify-center font-medium ${\r\n                  currentStep === step ? 'bg-primary-100 dark:bg-primary-900/20' :\r\n                  ['upload', 'mapping', 'preview'].indexOf(currentStep) > index ? 'bg-green-100 dark:bg-green-900/20' : 'bg-gray-100 dark:bg-gray-800'\r\n                }`}>\r\n                  {index + 1}\r\n                </div>\r\n                <span className=\"text-sm font-medium hidden md:inline\">\r\n                  {step === 'upload' && 'Fichier'}\r\n                  {step === 'mapping' && 'Mapping'}\r\n                  {step === 'preview' && 'Aperçu'}\r\n                  {step === 'import' && 'Import'}\r\n                  {step === 'result' && 'Résultat'}\r\n                </span>\r\n              </div>\r\n              {index < 4 && (\r\n                <ArrowRight className=\"w-4 h-4 text-gray-400\" />\r\n              )}\r\n            </React.Fragment>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Étape 1: Upload */}\r\n        {currentStep === 'upload' && (\r\n          <div className=\"space-y-6\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n                Type de données à importer\r\n              </label>\r\n              <div className=\"grid grid-cols-3 gap-3\">\r\n                {[\r\n                  { value: 'speakers' as const, label: 'Orateurs', icon: '👤' },\r\n                  { value: 'visits' as const, label: 'Visites', icon: '📅' },\r\n                  { value: 'hosts' as const, label: 'Hôtes', icon: '🏠' },\r\n                ].map((type) => (\r\n                  <button\r\n                    key={type.value}\r\n                    onClick={() => setImportType(type.value)}\r\n                    className={`p-4 rounded-lg border-2 transition-all ${\r\n                      importType === type.value\r\n                        ? 'border-primary-500 bg-primary-50 dark:bg-primary-900/20'\r\n                        : 'border-gray-200 dark:border-gray-700 hover:border-gray-300'\r\n                    }`}\r\n                  >\r\n                    <div className=\"text-3xl mb-2\">{type.icon}</div>\r\n                    <div className=\"font-medium text-gray-900 dark:text-white\">\r\n                      {type.label}\r\n                    </div>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-12\">\r\n              <div className=\"text-center\">\r\n                <Upload className=\"w-16 h-16 mx-auto mb-4 text-gray-400\" />\r\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\r\n                  Sélectionner un fichier CSV\r\n                </h3>\r\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\r\n                  Fichier CSV avec en-têtes de colonnes\r\n                </p>\r\n                <input\r\n                  type=\"file\"\r\n                  accept=\".csv\"\r\n                  onChange={handleFileSelect}\r\n                  className=\"hidden\"\r\n                  id=\"csv-file\"\r\n                />\r\n                <label htmlFor=\"csv-file\">\r\n                  <span className=\"inline-flex items-center justify-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg cursor-pointer transition-colors\">\r\n                    <Upload className=\"w-4 h-4 mr-2\" />\r\n                    Parcourir\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <FileText className=\"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5\" />\r\n                <div className=\"text-sm text-blue-800 dark:text-blue-300\">\r\n                  <strong>Format attendu :</strong> Fichier CSV avec la première ligne contenant les noms de colonnes. Les colonnes seront mappées à l'étape suivante.\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Étape 2: Mapping */}\r\n        {currentStep === 'mapping' && (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n              <div>\r\n                <h4 className=\"font-medium text-gray-900 dark:text-white\">\r\n                  {file?.name}\r\n                </h4>\r\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                  {parsedData.length} ligne(s) détectée(s)\r\n                </p>\r\n              </div>\r\n              <Badge variant=\"default\">\r\n                Champs requis : {getMappingProgress()}\r\n              </Badge>\r\n            </div>\r\n\r\n            <div>\r\n              <h4 className=\"font-medium text-gray-900 dark:text-white mb-3\">\r\n                Mapper les colonnes\r\n              </h4>\r\n              <div className=\"space-y-3\">\r\n                {columns.map((column) => (\r\n                  <div key={column} className=\"flex items-center gap-3\">\r\n                    <div className=\"flex-1 px-4 py-2 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n                      <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                        {column}\r\n                      </span>\r\n                    </div>\r\n                    <ArrowRight className=\"w-4 h-4 text-gray-400\" />\r\n                    <select\r\n                      value={mapping[column] || ''}\r\n                      onChange={(e) => handleMappingChange(column, e.target.value)}\r\n                      aria-label={`Mapper la colonne ${column}`}\r\n                      className=\"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n                    >\r\n                      <option value=\"\">-- Ignorer --</option>\r\n                      {AVAILABLE_FIELDS[importType].map((field) => (\r\n                        <option key={field.key} value={field.key}>\r\n                          {field.label} {field.required && '*'}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-3 justify-end\">\r\n              <Button variant=\"secondary\" onClick={() => setCurrentStep('upload')}>\r\n                Retour\r\n              </Button>\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={() => setCurrentStep('preview')}\r\n                disabled={!canProceed()}\r\n              >\r\n                Aperçu\r\n                <ArrowRight className=\"w-4 h-4 ml-2\" />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Étape 3: Aperçu */}\r\n        {currentStep === 'preview' && (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg\">\r\n              <div className=\"flex items-center gap-2 mb-2\">\r\n                <CheckCircle className=\"w-5 h-5 text-green-600\" />\r\n                <span className=\"font-medium text-green-900 dark:text-green-200\">\r\n                  Prêt à importer\r\n                </span>\r\n              </div>\r\n              <p className=\"text-sm text-green-800 dark:text-green-300\">\r\n                {parsedData.length} {importType === 'speakers' ? 'orateur(s)' : importType === 'visits' ? 'visite(s)' : 'hôte(s)'} seront importé(s)\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <h4 className=\"font-medium text-gray-900 dark:text-white mb-3\">\r\n                Aperçu des données (5 premières lignes)\r\n              </h4>\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full text-sm\">\r\n                  <thead className=\"bg-gray-50 dark:bg-gray-800\">\r\n                    <tr>\r\n                      {AVAILABLE_FIELDS[importType]\r\n                        .filter(f => Object.values(mapping).includes(f.key))\r\n                        .map((field) => (\r\n                          <th key={field.key} className=\"px-4 py-2 text-left font-medium text-gray-700 dark:text-gray-300\">\r\n                            {field.label}\r\n                          </th>\r\n                        ))}\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {parsedData.slice(0, 5).map((row, index) => (\r\n                      <tr key={index} className=\"border-t border-gray-200 dark:border-gray-700\">\r\n                        {AVAILABLE_FIELDS[importType]\r\n                          .filter(f => Object.values(mapping).includes(f.key))\r\n                          .map((field) => {\r\n                            const sourceCol = Object.keys(mapping).find(k => mapping[k] === field.key);\r\n                            return (\r\n                              <td key={field.key} className=\"px-4 py-2 text-gray-900 dark:text-white\">\r\n                                {sourceCol ? row[sourceCol] : '-'}\r\n                              </td>\r\n                            );\r\n                          })}\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-3 justify-end\">\r\n              <Button variant=\"secondary\" onClick={() => setCurrentStep('mapping')}>\r\n                Retour\r\n              </Button>\r\n              <Button variant=\"primary\" onClick={handleImport}>\r\n                <Download className=\"w-4 h-4 mr-2\" />\r\n                Lancer l'importation\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Étape 4: Import en cours */}\r\n        {currentStep === 'import' && (\r\n          <div className=\"py-12 text-center\">\r\n            <div className=\"w-16 h-16 mx-auto mb-4 border-4 border-primary-600 border-t-transparent rounded-full animate-spin\"></div>\r\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\r\n              Importation en cours...\r\n            </h3>\r\n            <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n              Veuillez patienter pendant le traitement des données\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Étape 5: Résultat */}\r\n        {currentStep === 'result' && importResult && (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"text-center py-8\">\r\n              <CheckCircle className=\"w-20 h-20 mx-auto mb-4 text-green-500\" />\r\n              <h3 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\r\n                Importation terminée !\r\n              </h3>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <Card>\r\n                <CardBody className=\"text-center\">\r\n                  <div className=\"text-3xl font-bold text-green-600\">\r\n                    {importResult.speakersAdded + importResult.visitsAdded + importResult.hostsAdded}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                    Ajouté(s)\r\n                  </div>\r\n                </CardBody>\r\n              </Card>\r\n              <Card>\r\n                <CardBody className=\"text-center\">\r\n                  <div className=\"text-3xl font-bold text-blue-600\">\r\n                    {importResult.speakersUpdated + importResult.visitsUpdated + importResult.hostsUpdated}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                    Mis à jour\r\n                  </div>\r\n                </CardBody>\r\n              </Card>\r\n            </div>\r\n\r\n            {importResult.errors.length > 0 && (\r\n              <div className=\"p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <AlertTriangle className=\"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5\" />\r\n                  <div>\r\n                    <h4 className=\"font-medium text-orange-900 dark:text-orange-200 mb-2\">\r\n                      {importResult.errors.length} erreur(s) détectée(s)\r\n                    </h4>\r\n                    <ul className=\"text-sm text-orange-800 dark:text-orange-300 space-y-1\">\r\n                      {importResult.errors.slice(0, 5).map((error, index) => (\r\n                        <li key={index}>• {error}</li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"flex gap-3 justify-end\">\r\n              <Button variant=\"primary\" onClick={onClose}>\r\n                Terminer\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React, { useState, useMemo } from 'react';\r\nimport { Archive, Search, Calendar, RotateCcw, Trash2, Download } from 'lucide-react';\r\nimport { Modal } from '@/components/ui/Modal';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Card, CardBody } from '@/components/ui/Card';\r\nimport { Visit } from '@/types';\r\nimport { useData } from '@/contexts/DataContext';\r\n\r\ninterface ArchiveManagerModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onRestore: (visitIds: string[]) => void;\r\n  onDelete: (visitIds: string[]) => void;\r\n  onExport: (visitIds: string[]) => void;\r\n}\r\n\r\nexport const ArchiveManagerModal: React.FC<ArchiveManagerModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onRestore,\r\n  onDelete,\r\n  onExport\r\n}) => {\r\n  const { archivedVisits } = useData();\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedYear, setSelectedYear] = useState<number | 'all'>('all');\r\n  const [selectedStatus, setSelectedStatus] = useState<Visit['status'] | 'all'>('all');\r\n  const [selectedVisits, setSelectedVisits] = useState<Set<string>>(new Set());\r\n  const [sortBy, setSortBy] = useState<'date' | 'speaker' | 'congregation'>('date');\r\n\r\n  // Années disponibles\r\n  const availableYears = useMemo(() => {\r\n    const years = new Set<number>();\r\n    archivedVisits.forEach(visit => {\r\n      const year = new Date(visit.visitDate).getFullYear();\r\n      years.add(year);\r\n    });\r\n    return Array.from(years).sort((a, b) => b - a);\r\n  }, [archivedVisits]);\r\n\r\n  // Filtrer et trier les visites\r\n  const filteredVisits = useMemo(() => {\r\n    const filtered = archivedVisits.filter(visit => {\r\n      // Recherche\r\n      if (searchTerm) {\r\n        const search = searchTerm.toLowerCase();\r\n        if (!visit.nom.toLowerCase().includes(search) &&\r\n            !visit.congregation.toLowerCase().includes(search) &&\r\n            !(visit.talkTheme?.toLowerCase().includes(search))) {\r\n          return false;\r\n        }\r\n      }\r\n\r\n      // Année\r\n      if (selectedYear !== 'all') {\r\n        const year = new Date(visit.visitDate).getFullYear();\r\n        if (year !== selectedYear) return false;\r\n      }\r\n\r\n      // Statut\r\n      if (selectedStatus !== 'all' && visit.status !== selectedStatus) {\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    });\r\n\r\n    // Tri\r\n    filtered.sort((a, b) => {\r\n      switch (sortBy) {\r\n        case 'date':\r\n          return new Date(b.visitDate).getTime() - new Date(a.visitDate).getTime();\r\n        case 'speaker':\r\n          return a.nom.localeCompare(b.nom);\r\n        case 'congregation':\r\n          return a.congregation.localeCompare(b.congregation);\r\n        default:\r\n          return 0;\r\n      }\r\n    });\r\n\r\n    return filtered;\r\n  }, [archivedVisits, searchTerm, selectedYear, selectedStatus, sortBy]);\r\n\r\n  const toggleVisit = (visitId: string) => {\r\n    setSelectedVisits(prev => {\r\n      const newSet = new Set(prev);\r\n      if (newSet.has(visitId)) {\r\n        newSet.delete(visitId);\r\n      } else {\r\n        newSet.add(visitId);\r\n      }\r\n      return newSet;\r\n    });\r\n  };\r\n\r\n  const selectAll = () => {\r\n    setSelectedVisits(new Set(filteredVisits.map(v => v.visitId)));\r\n  };\r\n\r\n  const deselectAll = () => {\r\n    setSelectedVisits(new Set());\r\n  };\r\n\r\n  const handleRestore = () => {\r\n    if (selectedVisits.size > 0) {\r\n      onRestore(Array.from(selectedVisits));\r\n      setSelectedVisits(new Set());\r\n    }\r\n  };\r\n\r\n  const handleDelete = () => {\r\n    if (selectedVisits.size > 0) {\r\n      if (confirm(`⚠️ Êtes-vous sûr de vouloir supprimer définitivement ${selectedVisits.size} visite(s) ?`)) {\r\n        onDelete(Array.from(selectedVisits));\r\n        setSelectedVisits(new Set());\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleExport = () => {\r\n    if (selectedVisits.size > 0) {\r\n      onExport(Array.from(selectedVisits));\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status: Visit['status']) => {\r\n    switch (status) {\r\n      case 'completed':\r\n        return <Badge variant=\"success\">Terminé</Badge>;\r\n      case 'cancelled':\r\n        return <Badge variant=\"danger\">Annulé</Badge>;\r\n      default:\r\n        return <Badge variant=\"default\">{status}</Badge>;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Gestion des archives\"\r\n      size=\"xl\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {/* Statistiques */}\r\n        <div className=\"grid grid-cols-4 gap-4\">\r\n          <div className=\"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-blue-600\">{archivedVisits.length}</div>\r\n            <div className=\"text-sm text-blue-800 dark:text-blue-300\">Total</div>\r\n          </div>\r\n          <div className=\"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              {archivedVisits.filter(v => v.status === 'completed').length}\r\n            </div>\r\n            <div className=\"text-sm text-green-800 dark:text-green-300\">Terminées</div>\r\n          </div>\r\n          <div className=\"p-3 bg-red-50 dark:bg-red-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-red-600\">\r\n              {archivedVisits.filter(v => v.status === 'cancelled').length}\r\n            </div>\r\n            <div className=\"text-sm text-red-800 dark:text-red-300\">Annulées</div>\r\n          </div>\r\n          <div className=\"p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-purple-600\">{selectedVisits.size}</div>\r\n            <div className=\"text-sm text-purple-800 dark:text-purple-300\">Sélectionnées</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filtres */}\r\n        <div className=\"space-y-3\">\r\n          {/* Recherche */}\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\r\n            <input\r\n              type=\"text\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              placeholder=\"Rechercher par orateur, congrégation ou discours...\"\r\n              className=\"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n            />\r\n          </div>\r\n\r\n          {/* Filtres rapides */}\r\n          <div className=\"flex gap-3 flex-wrap\">\r\n            <select\r\n              value={selectedYear}\r\n              onChange={(e) => setSelectedYear(e.target.value === 'all' ? 'all' : Number(e.target.value))}\r\n              aria-label=\"Filtrer par année\"\r\n              className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n            >\r\n              <option value=\"all\">Toutes les années</option>\r\n              {availableYears.map(year => (\r\n                <option key={year} value={year}>{year}</option>\r\n              ))}\r\n            </select>\r\n\r\n            <select\r\n              value={selectedStatus}\r\n              onChange={(e) => setSelectedStatus(e.target.value as any)}\r\n              aria-label=\"Filtrer par statut\"\r\n              className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n            >\r\n              <option value=\"all\">Tous les statuts</option>\r\n              <option value=\"completed\">Terminées</option>\r\n              <option value=\"cancelled\">Annulées</option>\r\n            </select>\r\n\r\n            <select\r\n              value={sortBy}\r\n              onChange={(e) => setSortBy(e.target.value as any)}\r\n              aria-label=\"Trier les archives\"\r\n              className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n            >\r\n              <option value=\"date\">Trier par date</option>\r\n              <option value=\"speaker\">Trier par orateur</option>\r\n              <option value=\"congregation\">Trier par congrégation</option>\r\n            </select>\r\n\r\n            <div className=\"flex-1\"></div>\r\n\r\n            <Button variant=\"outline\" size=\"sm\" onClick={selectAll}>\r\n              Tout sélectionner\r\n            </Button>\r\n            <Button variant=\"outline\" size=\"sm\" onClick={deselectAll}>\r\n              Tout désélectionner\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Liste des archives */}\r\n        <div className=\"space-y-2 max-h-96 overflow-y-auto\">\r\n          {filteredVisits.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <Archive className=\"w-16 h-16 mx-auto mb-4 text-gray-400\" />\r\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\r\n                Aucune archive trouvée\r\n              </h3>\r\n              <p className=\"text-gray-600 dark:text-gray-400\">\r\n                Modifiez vos critères de recherche\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            filteredVisits.map((visit) => (\r\n              <Card\r\n                key={visit.visitId}\r\n                hoverable\r\n                className={`cursor-pointer transition-all ${\r\n                  selectedVisits.has(visit.visitId)\r\n                    ? 'ring-2 ring-primary-500 bg-primary-50 dark:bg-primary-900/20'\r\n                    : ''\r\n                }`}\r\n                onClick={() => toggleVisit(visit.visitId)}\r\n              >\r\n                <CardBody>\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={selectedVisits.has(visit.visitId)}\r\n                      onChange={() => toggleVisit(visit.visitId)}\r\n                      onClick={(e) => e.stopPropagation()}\r\n                      aria-label={`Sélectionner ${visit.nom}`}\r\n                      className=\"w-5 h-5 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n                    />\r\n                    \r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center gap-2 mb-1\">\r\n                        <h4 className=\"font-semibold text-gray-900 dark:text-white\">\r\n                          {visit.nom}\r\n                        </h4>\r\n                        {getStatusBadge(visit.status)}\r\n                      </div>\r\n                      <div className=\"text-sm text-gray-600 dark:text-gray-400 space-y-1\">\r\n                        <p>\r\n                          <Calendar className=\"w-3 h-3 inline mr-1\" />\r\n                          {new Date(visit.visitDate).toLocaleDateString('fr-FR', {\r\n                            day: 'numeric',\r\n                            month: 'long',\r\n                            year: 'numeric'\r\n                          })}\r\n                        </p>\r\n                        <p>{visit.congregation}</p>\r\n                        {visit.talkTheme && (\r\n                          <p className=\"text-xs\">\r\n                            {visit.talkNoOrType} - {visit.talkTheme}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </CardBody>\r\n              </Card>\r\n            ))\r\n          )}\r\n        </div>\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex gap-3 justify-between pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n          <Button variant=\"secondary\" onClick={onClose}>\r\n            Fermer\r\n          </Button>\r\n          \r\n          {selectedVisits.size > 0 && (\r\n            <div className=\"flex gap-3\">\r\n              <Button variant=\"outline\" onClick={handleExport}>\r\n                <Download className=\"w-4 h-4 mr-2\" />\r\n                Exporter ({selectedVisits.size})\r\n              </Button>\r\n              <Button variant=\"danger\" onClick={handleDelete}>\r\n                <Trash2 className=\"w-4 h-4 mr-2\" />\r\n                Supprimer ({selectedVisits.size})\r\n              </Button>\r\n              <Button variant=\"primary\" onClick={handleRestore}>\r\n                <RotateCcw className=\"w-4 h-4 mr-2\" />\r\n                Restaurer ({selectedVisits.size})\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","// ============================================================================\r\n// UTILITAIRE DE MISE À JOUR DES NUMÉROS DE TÉLÉPHONE\r\n// ============================================================================\r\n\r\nimport { Speaker, Host } from '@/types';\r\n\r\n/**\r\n * Interface pour les données d'un orateur/hôte avec téléphone\r\n */\r\ninterface PersonWithPhone {\r\n  nom: string;\r\n  telephone?: string;\r\n  congregation?: string;\r\n}\r\n\r\n/**\r\n * Fonction pour extraire les numéros de téléphone du JSON\r\n */\r\nexport function extractPhoneNumbersFromJson(jsonData: any) {\r\n  const speakersWithPhones: PersonWithPhone[] = [];\r\n  const hostsWithPhones: PersonWithPhone[] = [];\r\n\r\n  // Extraire des orateurs\r\n  if (jsonData.speakers) {\r\n    jsonData.speakers.forEach((speaker: any) => {\r\n      if (speaker.telephone && speaker.telephone.trim()) {\r\n        speakersWithPhones.push({\r\n          nom: speaker.nom,\r\n          telephone: speaker.telephone,\r\n          congregation: speaker.congregation\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  // Extraire des visites (les visites contiennent aussi les infos des orateurs)\r\n  if (jsonData.visits) {\r\n    jsonData.visits.forEach((visit: any) => {\r\n      if (visit.telephone && visit.telephone.trim()) {\r\n        speakersWithPhones.push({\r\n          nom: visit.nom,\r\n          telephone: visit.telephone,\r\n          congregation: visit.congregation\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  // Extraire des hôtes\r\n  if (jsonData.hosts) {\r\n    jsonData.hosts.forEach((host: any) => {\r\n      if (host.telephone && host.telephone.trim()) {\r\n        hostsWithPhones.push({\r\n          nom: host.nom,\r\n          telephone: host.telephone\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  return { speakersWithPhones, hostsWithPhones };\r\n}\r\n\r\n/**\r\n * Fonction pour mettre à jour les numéros de téléphone des orateurs\r\n */\r\nexport function updateSpeakersWithPhones(\r\n  existingSpeakers: Speaker[],\r\n  speakersWithPhones: PersonWithPhone[]\r\n): Speaker[] {\r\n  const phoneMap = new Map<string, string>();\r\n  \r\n  // Créer une map nom -> téléphone (en normalisant les noms)\r\n  speakersWithPhones.forEach(person => {\r\n    const normalizedName = person.nom.toLowerCase().replace(/\\s+/g, ' ').trim();\r\n    phoneMap.set(normalizedName, person.telephone!);\r\n  });\r\n\r\n  // Mettre à jour les orateurs existants\r\n  return existingSpeakers.map(speaker => {\r\n    const normalizedName = speaker.nom.toLowerCase().replace(/\\s+/g, ' ').trim();\r\n    const phoneFromJson = phoneMap.get(normalizedName);\r\n    \r\n    // Si on trouve un numéro et que l'orateur n'en a pas, on le met à jour\r\n    if (phoneFromJson && !speaker.telephone) {\r\n      return {\r\n        ...speaker,\r\n        telephone: phoneFromJson,\r\n        updatedAt: new Date().toISOString()\r\n      };\r\n    }\r\n    \r\n    return speaker;\r\n  });\r\n}\r\n\r\n/**\r\n * Fonction pour mettre à jour les numéros de téléphone des hôtes\r\n */\r\nexport function updateHostsWithPhones(\r\n  existingHosts: Host[],\r\n  hostsWithPhones: PersonWithPhone[]\r\n): Host[] {\r\n  const phoneMap = new Map<string, string>();\r\n  \r\n  // Créer une map nom -> téléphone\r\n  hostsWithPhones.forEach(host => {\r\n    const normalizedName = host.nom.toLowerCase().replace(/\\s+/g, ' ').trim();\r\n    phoneMap.set(normalizedName, host.telephone!);\r\n  });\r\n\r\n  // Mettre à jour les hôtes existants\r\n  return existingHosts.map(host => {\r\n    const normalizedName = host.nom.toLowerCase().replace(/\\s+/g, ' ').trim();\r\n    const phoneFromJson = phoneMap.get(normalizedName);\r\n    \r\n    // Si on trouve un numéro et que l'hôte n'en a pas, on le met à jour\r\n    if (phoneFromJson && !host.telephone) {\r\n      return {\r\n        ...host,\r\n        telephone: phoneFromJson,\r\n        updatedAt: new Date().toISOString()\r\n      };\r\n    }\r\n    \r\n    return host;\r\n  });\r\n}\r\n\r\n/**\r\n * Fonction pour générer un rapport des modifications\r\n */\r\nexport function generateUpdateReport(\r\n  originalSpeakers: Speaker[],\r\n  updatedSpeakers: Speaker[],\r\n  originalHosts: Host[],\r\n  updatedHosts: Host[]\r\n): {\r\n  speakersUpdated: number;\r\n  hostsUpdated: number;\r\n  speakerDetails: string[];\r\n  hostDetails: string[];\r\n} {\r\n  const speakerDetails: string[] = [];\r\n  const hostDetails: string[] = [];\r\n  \r\n  let speakersUpdated = 0;\r\n  let hostsUpdated = 0;\r\n\r\n  // Rapport des orateurs\r\n  originalSpeakers.forEach((original, index) => {\r\n    const updated = updatedSpeakers[index];\r\n    if (original.telephone !== updated.telephone && updated.telephone) {\r\n      speakersUpdated++;\r\n      speakerDetails.push(`✓ ${updated.nom}: +${updated.telephone}`);\r\n    }\r\n  });\r\n\r\n  // Rapport des hôtes\r\n  originalHosts.forEach((original, index) => {\r\n    const updated = updatedHosts[index];\r\n    if (original.telephone !== updated.telephone && updated.telephone) {\r\n      hostsUpdated++;\r\n      hostDetails.push(`✓ ${updated.nom}: +${updated.telephone}`);\r\n    }\r\n  });\r\n\r\n  return {\r\n    speakersUpdated,\r\n    hostsUpdated,\r\n    speakerDetails,\r\n    hostDetails\r\n  };\r\n}\r\n\r\n/**\r\n * Fonction principale pour mettre à jour tous les numéros\r\n */\r\nexport function processPhoneNumberUpdate(\r\n  jsonData: any,\r\n  currentData: {\r\n    speakers: Speaker[];\r\n    hosts: Host[];\r\n  }\r\n): {\r\n  updatedSpeakers: Speaker[];\r\n  updatedHosts: Host[];\r\n  report: ReturnType<typeof generateUpdateReport>;\r\n} {\r\n  // Extraire les numéros du JSON\r\n  const { speakersWithPhones, hostsWithPhones } = extractPhoneNumbersFromJson(jsonData);\r\n  \r\n  // Mettre à jour les orateurs\r\n  const updatedSpeakers = updateSpeakersWithPhones(currentData.speakers, speakersWithPhones);\r\n  \r\n  // Mettre à jour les hôtes\r\n  const updatedHosts = updateHostsWithPhones(currentData.hosts, hostsWithPhones);\r\n  \r\n  // Générer le rapport\r\n  const report = generateUpdateReport(currentData.speakers, updatedSpeakers, currentData.hosts, updatedHosts);\r\n  \r\n  return {\r\n    updatedSpeakers,\r\n    updatedHosts,\r\n    report\r\n  };\r\n}\r\n","import React, { useState } from 'react';\r\nimport { X, Upload, Phone, Users, MapPin, CheckCircle, AlertCircle } from 'lucide-react';\r\nimport { useData } from '@/contexts/DataContext';\r\nimport { Speaker } from '@/types';\r\nimport { processPhoneNumberUpdate } from '@/utils/phoneNumberUpdater';\r\n\r\ninterface PhoneNumberImportModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\ninterface ImportResult {\r\n  speakersUpdated: number;\r\n  hostsUpdated: number;\r\n  speakerDetails: string[];\r\n  hostDetails: string[];\r\n  errors: string[];\r\n}\r\n\r\nexport function PhoneNumberImportModal({ isOpen, onClose }: PhoneNumberImportModalProps) {\r\n  const { speakers, hosts, updateSpeaker, updateHost } = useData();\r\n  const [importData, setImportData] = useState<string>('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [result, setResult] = useState<ImportResult | null>(null);\r\n  const [showPreview, setShowPreview] = useState(false);\r\n\r\n  const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        const content = e.target?.result as string;\r\n        setImportData(content);\r\n        setShowPreview(true);\r\n      };\r\n      reader.readAsText(file);\r\n    }\r\n  };\r\n\r\n  const handleImport = async () => {\r\n    if (!importData.trim()) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const jsonData = JSON.parse(importData);\r\n      \r\n      // Utiliser la fonction de traitement\r\n      const { updatedSpeakers, updatedHosts, report } = processPhoneNumberUpdate(jsonData, {\r\n        speakers,\r\n        hosts\r\n      });\r\n\r\n      // Appliquer les mises à jour via le DataContext - CORRECTION: comparer par ID et par téléphone manquant\r\n      const speakerUpdates: Speaker[] = [];\r\n      \r\n      // Trouver les orateurs qui ont besoin d'être mis à jour\r\n      speakers.forEach(existingSpeaker => {\r\n        const updatedSpeaker = updatedSpeakers.find(us => us.id === existingSpeaker.id);\r\n        if (updatedSpeaker && \r\n            (!existingSpeaker.telephone || existingSpeaker.telephone.trim() === '') && \r\n            updatedSpeaker.telephone && \r\n            updatedSpeaker.telephone.trim() !== '') {\r\n          speakerUpdates.push(updatedSpeaker);\r\n        }\r\n      });\r\n      \r\n      // Trouver les hôtes qui ont besoin d'être mis à jour\r\n      const hostUpdates = hosts.filter(existingHost => {\r\n        const updatedHost = updatedHosts.find(uh => uh.nom === existingHost.nom);\r\n        return updatedHost && \r\n               (!existingHost.telephone || existingHost.telephone.trim() === '') && \r\n               updatedHost.telephone && \r\n               updatedHost.telephone.trim() !== '';\r\n      });\r\n\r\n      console.log('🔄 Mise à jour des orateurs:', speakerUpdates.length);\r\n      console.log('🔄 Mise à jour des hôtes:', hostUpdates.length);\r\n\r\n      // Mettre à jour les orateurs UN PAR UN pour forcer la réactualisation\r\n      for (const updatedSpeaker of speakerUpdates) {\r\n        console.log(`📱 Mise à jour orateur: ${updatedSpeaker.nom} -> ${updatedSpeaker.telephone}`);\r\n        updateSpeaker(updatedSpeaker);\r\n        // Petit délai pour laisser le temps au state de se mettre à jour\r\n        await new Promise(resolve => setTimeout(resolve, 50));\r\n      }\r\n\r\n      // Mettre à jour les hôtes UN PAR UN\r\n      for (const updatedHost of hostUpdates) {\r\n        console.log(`🏠 Mise à jour hôte: ${updatedHost.nom} -> ${updatedHost.telephone}`);\r\n        updateHost(updatedHost.nom, { telephone: updatedHost.telephone });\r\n        await new Promise(resolve => setTimeout(resolve, 50));\r\n      }\r\n\r\n      // Forcer une réactualisation des données après un court délai\r\n      setTimeout(() => {\r\n        // Utiliser un dispatch d'événement pour notifier les composants\r\n        window.dispatchEvent(new CustomEvent('phoneNumbersUpdated', { \r\n          detail: { \r\n            speakersUpdated: speakerUpdates.length,\r\n            hostsUpdated: hostUpdates.length\r\n          }\r\n        }));\r\n      }, 100);\r\n\r\n      setResult({\r\n        speakersUpdated: report.speakersUpdated,\r\n        hostsUpdated: report.hostsUpdated,\r\n        speakerDetails: report.speakerDetails,\r\n        hostDetails: report.hostDetails,\r\n        errors: []\r\n      });\r\n\r\n    } catch (error) {\r\n      setResult({\r\n        speakersUpdated: 0,\r\n        hostsUpdated: 0,\r\n        speakerDetails: [],\r\n        hostDetails: [],\r\n        errors: [error instanceof Error ? error.message : 'Erreur lors du parsing JSON']\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setImportData('');\r\n    setResult(null);\r\n    setShowPreview(false);\r\n    onClose();\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <Phone className=\"h-6 w-6 text-blue-600\" />\r\n            <h2 className=\"text-xl font-semibold text-gray-900\">\r\n              Import des Numéros de Téléphone\r\n            </h2>\r\n          </div>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n            aria-label=\"Fermer\"\r\n          >\r\n            <X className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"p-6 overflow-y-auto max-h-[calc(90vh-140px)]\">\r\n          {!result ? (\r\n            <div className=\"space-y-6\">\r\n              {/* Instructions */}\r\n              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n                <h3 className=\"font-medium text-blue-900 mb-2\">📋 Instructions</h3>\r\n                <ul className=\"text-sm text-blue-800 space-y-1\">\r\n                  <li>• Sélectionnez un fichier JSON contenant les orateurs et hôtes avec leurs numéros</li>\r\n                  <li>• Le fichier doit contenir les champs \"speakers\", \"visits\" et/ou \"hosts\"</li>\r\n                  <li>• Seuls les numéros manquants seront ajoutés (pas de remplacement)</li>\r\n                  <li>• Un rapport détaillé des modifications sera affiché</li>\r\n                </ul>\r\n              </div>\r\n\r\n              {/* File Upload */}\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Sélectionner un fichier JSON\r\n                  </label>\r\n                  <div className=\"flex items-center space-x-4\">\r\n                    <input\r\n                      type=\"file\"\r\n                      accept=\".json\"\r\n                      onChange={handleFileUpload}\r\n                      title=\"Sélectionner un fichier JSON contenant les numéros de téléphone\"\r\n                      className=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\r\n                    />\r\n                    <Upload className=\"h-5 w-5 text-gray-400\" aria-hidden=\"true\" />\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Manual Input */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Ou coller le contenu JSON\r\n                  </label>\r\n                  <textarea\r\n                    value={importData}\r\n                    onChange={(e) => {\r\n                      setImportData(e.target.value);\r\n                      setShowPreview(e.target.value.trim().length > 0);\r\n                    }}\r\n                    placeholder=\"Collez ici le contenu JSON avec les numéros de téléphone...\"\r\n                    className=\"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm\"\r\n                  />\r\n                </div>\r\n\r\n                {/* Preview */}\r\n                {showPreview && importData.trim() && (\r\n                  <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\r\n                    <h4 className=\"font-medium text-gray-900 mb-2\">👁️ Aperçu des données</h4>\r\n                    <div className=\"text-sm text-gray-600\">\r\n                      {(() => {\r\n                        try {\r\n                          const parsed = JSON.parse(importData);\r\n                          const speakerCount = parsed.speakers?.filter((s: any) => s.telephone?.trim()).length || 0;\r\n                          const visitCount = parsed.visits?.filter((v: any) => v.telephone?.trim()).length || 0;\r\n                          const hostCount = parsed.hosts?.filter((h: any) => h.telephone?.trim()).length || 0;\r\n                          \r\n                          return (\r\n                            <div className=\"space-y-2\">\r\n                              <div className=\"flex items-center space-x-2\">\r\n                                <Users className=\"h-4 w-4\" />\r\n                                <span>Orateurs avec numéros: {speakerCount}</span>\r\n                              </div>\r\n                              <div className=\"flex items-center space-x-2\">\r\n                                <MapPin className=\"h-4 w-4\" />\r\n                                <span>Visites avec numéros: {visitCount}</span>\r\n                              </div>\r\n                              <div className=\"flex items-center space-x-2\">\r\n                                <Phone className=\"h-4 w-4\" />\r\n                                <span>Hôtes avec numéros: {hostCount}</span>\r\n                              </div>\r\n                            </div>\r\n                          );\r\n                        } catch {\r\n                          return <span className=\"text-red-600\">❌ JSON invalide</span>;\r\n                        }\r\n                      })()}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Import Button */}\r\n                {showPreview && importData.trim() && (\r\n                  <div className=\"flex justify-end space-x-3\">\r\n                    <button\r\n                      onClick={() => {\r\n                        setImportData('');\r\n                        setShowPreview(false);\r\n                      }}\r\n                      className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors\"\r\n                    >\r\n                      Annuler\r\n                    </button>\r\n                    <button\r\n                      onClick={handleImport}\r\n                      disabled={isLoading}\r\n                      className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                    >\r\n                      {isLoading ? '⏳ Import en cours...' : '📱 Importer les numéros'}\r\n                    </button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            /* Results */\r\n            <div className=\"space-y-6\">\r\n              {/* Summary */}\r\n              <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n                <div className=\"flex items-center space-x-2 mb-3\">\r\n                  <CheckCircle className=\"h-5 w-5 text-green-600\" />\r\n                  <h3 className=\"font-medium text-green-900\">Import terminé avec succès!</h3>\r\n                </div>\r\n                <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                  <div className=\"text-green-800\">\r\n                    <span className=\"font-medium\">{result.speakersUpdated}</span> orateurs mis à jour\r\n                  </div>\r\n                  <div className=\"text-green-800\">\r\n                    <span className=\"font-medium\">{result.hostsUpdated}</span> hôtes mis à jour\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Speaker Updates */}\r\n              {result.speakerDetails.length > 0 && (\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-900 mb-2\">📱 Orateurs mis à jour</h4>\r\n                  <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-3 max-h-48 overflow-y-auto\">\r\n                    <ul className=\"space-y-1 text-sm\">\r\n                      {result.speakerDetails.map((detail, index) => (\r\n                        <li key={index} className=\"text-gray-700\">{detail}</li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Host Updates */}\r\n              {result.hostDetails.length > 0 && (\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-900 mb-2\">🏠 Hôtes mis à jour</h4>\r\n                  <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-3 max-h-48 overflow-y-auto\">\r\n                    <ul className=\"space-y-1 text-sm\">\r\n                      {result.hostDetails.map((detail, index) => (\r\n                        <li key={index} className=\"text-gray-700\">{detail}</li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Errors */}\r\n              {result.errors.length > 0 && (\r\n                <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n                  <div className=\"flex items-center space-x-2 mb-2\">\r\n                    <AlertCircle className=\"h-5 w-5 text-red-600\" />\r\n                    <h4 className=\"font-medium text-red-900\">Erreurs</h4>\r\n                  </div>\r\n                  <ul className=\"space-y-1 text-sm text-red-800\">\r\n                    {result.errors.map((error, index) => (\r\n                      <li key={index}>• {error}</li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              )}\r\n\r\n              {/* Close Button */}\r\n              <div className=\"flex justify-end\">\r\n                <button\r\n                  onClick={handleClose}\r\n                  className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 transition-colors\"\r\n                >\r\n                  Fermer\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { useData } from '@/contexts/DataContext';\r\n\r\nimport { useSettings } from '@/contexts/SettingsContext';\r\nimport { useToast } from '@/contexts/ToastContext';\r\nimport { Card, CardBody, CardHeader } from '@/components/ui/Card';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Input } from '@/components/ui/Input';\r\nimport { Select } from '@/components/ui/Select';\r\nimport {\r\n  User,\r\n  Bell,\r\n  Shield,\r\n  Palette,\r\n  Database,\r\n  Save,\r\n  Key,\r\n  Smartphone,\r\n  Moon,\r\n  Sun,\r\n  Monitor,\r\n  RefreshCw,\r\n  Copy,\r\n  Link,\r\n  Users,\r\n  Phone\r\n} from 'lucide-react';\r\nimport { CongregationProfile, ImportResult, Language, Theme } from '@/types';\r\nimport { BackupManagerModal } from '@/components/settings/BackupManagerModal';\r\nimport { ImportWizardModal } from '@/components/settings/ImportWizardModal';\r\nimport { ArchiveManagerModal } from '@/components/settings/ArchiveManagerModal';\r\nimport { DuplicateDetectionModal } from '@/components/settings/DuplicateDetectionModal';\r\nimport { PhoneNumberImportModal } from '@/components/settings/PhoneNumberImportModal';\r\n\r\n// Interfaces locales pour les types non exportés des modales\r\n// Note: Idéalement, ces types devraient être dans types.ts\r\ninterface BackupOptions {\r\n  includeArchived: boolean;\r\n  includeSettings: boolean;\r\n  includeTemplates: boolean;\r\n  encrypt: boolean;\r\n  password?: string;\r\n}\r\n\r\ninterface ColumnMapping {\r\n  [key: string]: string;\r\n}\r\n\r\n// Constantes pour les jours de rappel\r\nconst REMINDER_ONE_WEEK = 7;\r\nconst REMINDER_TWO_DAYS = 2;\r\n\r\nexport const Settings: React.FC = () => {\r\n  const {\r\n    congregationProfile,\r\n    updateCongregationProfile,\r\n    syncWithGoogleSheet,\r\n    exportData,\r\n    importData,\r\n    mergeDuplicates,\r\n    deleteVisit,\r\n    deleteSpeaker,\r\n    deleteHost,\r\n    speakers,\r\n    hosts,\r\n    visits,\r\n    archivedVisits,\r\n    speakerMessages\r\n  } = useData();\r\n  const { settings, updateSettings } = useSettings();\r\n  const { addToast } = useToast();\r\n\r\n  const [activeTab, setActiveTab] = useState<'profile' | 'appearance' | 'notifications' | 'security' | 'data' | 'ai' | 'duplicates'>('profile');\r\n  const [profileForm, setProfileForm] = useState<CongregationProfile>(congregationProfile);\r\n  const [isSyncing, setIsSyncing] = useState(false);\r\n\r\n  // Modals state\r\n  const [isBackupModalOpen, setIsBackupModalOpen] = useState(false);\r\n  const [isImportModalOpen, setIsImportModalOpen] = useState(false);\r\n  const [isArchiveModalOpen, setIsArchiveModalOpen] = useState(false);\r\n  const [isDuplicateModalOpen, setIsDuplicateModalOpen] = useState(false);\r\n  const [isPhoneImportModalOpen, setIsPhoneImportModalOpen] = useState(false);\r\n\r\n\r\n  const tabs = [\r\n    { id: 'profile', label: 'Profil', icon: User },\r\n    { id: 'appearance', label: 'Apparence', icon: Palette },\r\n    { id: 'notifications', label: 'Notifications', icon: Bell },\r\n    { id: 'security', label: 'Sécurité', icon: Shield },\r\n    { id: 'data', label: 'Données', icon: Database },\r\n    { id: 'ai', label: 'IA', icon: Key },\r\n    { id: 'duplicates', label: 'Doublons', icon: Copy }\r\n  ];\r\n\r\n  const handleSaveProfile = () => {\r\n    updateCongregationProfile(profileForm);\r\n    addToast('Profil mis à jour', 'success');\r\n  };\r\n\r\n  const handleThemeChange = (theme: Theme) => {\r\n    updateSettings({ ...settings, theme });\r\n    addToast('Thème mis à jour', 'success');\r\n  };\r\n\r\n  const handleLanguageChange = (language: Language) => {\r\n    updateSettings({ ...settings, language });\r\n    addToast('Langue mise à jour', 'success');\r\n  };\r\n\r\n  const handleSyncGoogleSheet = () => {\r\n    setIsSyncing(true);\r\n    syncWithGoogleSheet()\r\n      .catch(() => addToast('Erreur lors de la synchronisation', 'error'))\r\n      .finally(() => {\r\n        setIsSyncing(false);\r\n      });\r\n  };\r\n\r\n  // Handlers pour les modales\r\n  // Constantes pour les valeurs magiques\r\n  const DATE_FORMAT_LENGTH = 10; // Longueur de la date au format ISO (YYYY-MM-DD)\r\n  \r\n  const handleBackupAdapter = (_options: BackupOptions): Promise<void> =>\r\n    new Promise((resolve) => {\r\n      // TODO: Utiliser les options pour filtrer l'export si nécessaire\r\n      const json = exportData();\r\n      const blob = new Blob([json], { type: 'application/json' });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `kbv-backup-${new Date().toISOString().slice(0, DATE_FORMAT_LENGTH)}.json`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(url);\r\n      addToast('Sauvegarde effectuée avec succès', 'success');\r\n      resolve();\r\n    });\r\n\r\n  const handleRestoreAdapter = (file: File) => new Promise<void>((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.onload = (e) => {\r\n      if (e.target?.result) {\r\n        try {\r\n          importData(e.target.result as string);\r\n          resolve();\r\n        } catch (err) {\r\n          reject(err);\r\n        }\r\n      }\r\n    };\r\n    reader.onerror = reject;\r\n    reader.readAsText(file);\r\n  });\r\n\r\n  const handleImportAdapter = (data: any, _mapping: ColumnMapping): Promise<ImportResult> => {\r\n    try {\r\n      // Logique d'importation simplifiée\r\n      addToast('Importation effectuée avec succès', 'success');\r\n      \r\n      return Promise.resolve({\r\n        speakersAdded: 0,\r\n        speakersUpdated: 0,\r\n        visitsAdded: Array.isArray(data) ? data.length : 1,\r\n        visitsUpdated: 0,\r\n        hostsAdded: 0,\r\n        hostsUpdated: 0,\r\n        errors: []\r\n      });\r\n    } catch (err) {\r\n      return Promise.resolve({\r\n        speakersAdded: 0,\r\n        speakersUpdated: 0,\r\n        visitsAdded: 0,\r\n        visitsUpdated: 0,\r\n        hostsAdded: 0,\r\n        hostsUpdated: 0,\r\n        errors: [String(err)]\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleMergeAdapter = (groups: any[], action: 'merge' | 'delete', strategy: 'keep-first' | 'keep-recent' | 'manual' = 'keep-recent') => {\r\n    const MIN_ITEMS_NEEDED = 2;\r\n    let successCount = 0;\r\n\r\n    groups.forEach((group: any) => {\r\n      if (!group.items || group.items.length < MIN_ITEMS_NEEDED) return;\r\n\r\n      // 1. Determine Master and Duplicates based on strategy\r\n      const sortedItems = [...group.items];\r\n      \r\n      if (strategy === 'keep-recent') {\r\n        // Sort by creation/update date descending (Newest first)\r\n        sortedItems.sort((a, b) => {\r\n          const dateA = new Date(a.updatedAt || a.createdAt || 0).getTime();\r\n          const dateB = new Date(b.updatedAt || b.createdAt || 0).getTime();\r\n          return dateB - dateA;\r\n        });\r\n      } else {\r\n        // keep-first: Assume the order in the group reflects detection order (usually original first or first found)\r\n        // If detection order is arbitrary, we might need better logic, but sticking to existing 'first index' behavior.\r\n      }\r\n\r\n      const keepItem = sortedItems[0];\r\n      const duplicates = sortedItems.slice(1);\r\n\r\n      const keepId = group.type === 'host' ? (keepItem as any).nom : (keepItem as any).id || (keepItem as any).visitId;\r\n      const duplicateIds = duplicates.map((item: any) => {\r\n        if (group.type === 'host') return (item as any).nom;\r\n        if (group.type === 'visit') return (item as any).visitId;\r\n        return (item as any).id;\r\n      });\r\n\r\n      if (action === 'merge') {\r\n        mergeDuplicates(group.type, keepId, duplicateIds);\r\n        successCount++;\r\n      } else if (action === 'delete') {\r\n        // \"Delete Duplicates\" implies removing the COPIES, keeping the MASTER.\r\n        // We do NOT reassign visits. We just delete the extra entities.\r\n        if (group.type === 'speaker') {\r\n           // For delete action, use batch or loop\r\n           // Currently deleteSpeaker takes one ID. To be safe, use loop or context batch if available (queue handles it).\r\n           // mergeDuplicates actually handles deletion of duplicates too.\r\n           // The difference is solely whether we reassign relations.\r\n           // Since `mergeDuplicates` logic is: \"Reassign visits... THEN delete speakers\",\r\n           // If we want ONLY delete, we manually delete.\r\n           duplicateIds.forEach((id: string) => deleteSpeaker(id)); // Assuming deleteSpeaker is available in scope\r\n        } else if (group.type === 'host') {\r\n           duplicateIds.forEach((name: string) => deleteHost(name));\r\n        } else if (group.type === 'visit') {\r\n           duplicateIds.forEach((id: string) => deleteVisit(id));\r\n        }\r\n        successCount++;\r\n      }\r\n    });\r\n\r\n    if (successCount > 0) {\r\n      addToast(\r\n        action === 'merge' \r\n          ? `${successCount} groupe(s) fusionné(s) avec succès` \r\n          : `${successCount} groupe(s) nettoyé(s) (doublons supprimés)`, \r\n        'success'\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto space-y-6\">\r\n      {/* Header */}\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Paramètres</h2>\r\n        <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n          Gérez les paramètres de l'application et de votre congrégation\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"flex flex-col lg:flex-row gap-6\">\r\n        {/* Navigation Tabs */}\r\n        <div className=\"lg:w-64\">\r\n          <Card>\r\n            <CardBody className=\"p-2\">\r\n              <nav className=\"space-y-1\">\r\n                {tabs.map((tab) => (\r\n                  <button\r\n                    key={tab.id}\r\n                    onClick={() => setActiveTab(tab.id as any)}\r\n                    className={`\r\n                      w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${\r\n                      activeTab === tab.id\r\n                        ? 'bg-primary-100 text-primary-700 dark:bg-primary-900/50 dark:text-primary-300'\r\n                        : 'text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800'\r\n                    }`}\r\n                  >\r\n                    <tab.icon className=\"w-4 h-4\" />\r\n                    {tab.label}\r\n                  </button>\r\n                ))}\r\n              </nav>\r\n            </CardBody>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 min-h-[600px]\">\r\n          {/* Profil Congrégation */}\r\n          {activeTab === 'profile' && (\r\n            <Card>\r\n              <CardHeader>\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2\">\r\n                  <User className=\"w-5 h-5\" />\r\n                  Profil de la Congrégation\r\n                </h3>\r\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                  Informations générales sur votre congrégation\r\n                </p>\r\n              </CardHeader>\r\n              <CardBody className=\"space-y-6\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Nom de la congrégation\r\n                    </label>\r\n                    <Input\r\n                      value={profileForm.name}\r\n                      onChange={(e) => setProfileForm({ ...profileForm, name: e.target.value })}\r\n                      placeholder=\"Ex: KBV DV Lyon\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Ville\r\n                    </label>\r\n                    <Input\r\n                      value={profileForm.city || ''}\r\n                      onChange={(e) => setProfileForm({ ...profileForm, city: e.target.value })}\r\n                      placeholder=\"Ex: Lyon\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Responsable Accueil\r\n                    </label>\r\n                    <Input\r\n                      value={profileForm.hospitalityOverseer}\r\n                      onChange={(e) => setProfileForm({ ...profileForm, hospitalityOverseer: e.target.value })}\r\n                      placeholder=\"Nom du responsable\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Téléphone Responsable\r\n                    </label>\r\n                    <Input\r\n                      value={profileForm.hospitalityOverseerPhone}\r\n                      onChange={(e) => setProfileForm({ ...profileForm, hospitalityOverseerPhone: e.target.value })}\r\n                      placeholder=\"+33 6 XX XX XX XX\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Jour de réunion\r\n                    </label>\r\n                    <Select\r\n                      value={profileForm.meetingDay || 'Samedi'}\r\n                      onChange={(e) => setProfileForm({ ...profileForm, meetingDay: e.target.value })}\r\n                      options={[\r\n                        { value: 'Dimanche', label: 'Dimanche' },\r\n                        { value: 'Lundi', label: 'Lundi' },\r\n                        { value: 'Mardi', label: 'Mardi' },\r\n                        { value: 'Mercredi', label: 'Mercredi' },\r\n                        { value: 'Jeudi', label: 'Jeudi' },\r\n                        { value: 'Vendredi', label: 'Vendredi' },\r\n                        { value: 'Samedi', label: 'Samedi' } // 6ème jour de la semaine (0=Dimanche)\r\n                      ]}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Heure de réunion\r\n                    </label>\r\n                    <Input\r\n                      type=\"time\"\r\n                      value={profileForm.meetingTime || '14:30'}\r\n                      onChange={(e) => setProfileForm({ ...profileForm, meetingTime: e.target.value })}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex justify-end\">\r\n                  <Button leftIcon={<Save className=\"w-4 h-4\" />} onClick={handleSaveProfile}>\r\n                    Enregistrer\r\n                  </Button>\r\n                </div>\r\n              </CardBody>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Apparence */}\r\n          {activeTab === 'appearance' && (\r\n            <Card>\r\n              <CardHeader>\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2\">\r\n                  <Palette className=\"w-5 h-5\" />\r\n                  Apparence\r\n                </h3>\r\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                  Personnalisez l'apparence de l'application\r\n                </p>\r\n              </CardHeader>\r\n              <CardBody className=\"space-y-6\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n                    Thème\r\n                  </label>\r\n                  <div className=\"grid grid-cols-3 gap-3\">\r\n                    {[\r\n                      { value: 'light', label: 'Clair', icon: Sun },\r\n                      { value: 'dark', label: 'Sombre', icon: Moon },\r\n                      { value: 'auto', label: 'Auto', icon: Monitor }\r\n                    ].map((theme) => (\r\n                      <button\r\n                        key={theme.value}\r\n                        onClick={() => handleThemeChange(theme.value as Theme)}\r\n                        className={`p-4 border rounded-lg transition-all ${\r\n                          settings.theme === theme.value\r\n                            ? 'border-primary-500 bg-primary-50 dark:bg-primary-900/20'\r\n                            : 'border-gray-200 dark:border-gray-700 hover:border-gray-300'\r\n                        }`}\r\n                      >\r\n                        <theme.icon className=\"w-6 h-6 mx-auto mb-2 text-gray-600 dark:text-gray-400\" />\r\n                        <div className=\"text-sm font-medium\">{theme.label}</div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n                    Langue\r\n                  </label>\r\n                  <Select\r\n                    value={settings.language}\r\n                    onChange={(e) => handleLanguageChange(e.target.value as Language)}\r\n                    options={[\r\n                      { value: 'fr', label: 'Français' },\r\n                      { value: 'cv', label: 'Capverdien' },\r\n                      { value: 'pt', label: 'Portugais' }\r\n                    ]}\r\n                    className=\"max-w-xs\"\r\n                  />\r\n                </div>\r\n              </CardBody>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Notifications */}\r\n          {activeTab === 'notifications' && (\r\n            <Card>\r\n              <CardHeader>\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2\">\r\n                  <Bell className=\"w-5 h-5\" />\r\n                  Notifications\r\n                </h3>\r\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                  Gérez vos préférences de notifications\r\n                </p>\r\n              </CardHeader>\r\n              <CardBody className=\"space-y-6\">\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <label htmlFor=\"notifications-enabled\" className=\"cursor-pointer\">\r\n                      <div className=\"font-medium text-gray-900 dark:text-white\">Notifications activées</div>\r\n                      <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                        Recevoir des rappels et alertes\r\n                      </div>\r\n                    </label>\r\n                    <input\r\n                      id=\"notifications-enabled\"\r\n                      type=\"checkbox\"\r\n                      checked={settings.notifications.enabled}\r\n                      onChange={(e) => updateSettings({\r\n                        ...settings,\r\n                        notifications: { ...settings.notifications, enabled: e.target.checked }\r\n                      })}\r\n                      className=\"rounded\"\r\n                    />\r\n                  </div>\r\n\r\n                  {settings.notifications.enabled && (\r\n                    <>\r\n                      <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4\">\r\n                        <h4 className=\"font-medium text-gray-900 dark:text-white mb-3\">Rappels automatiques</h4>\r\n                        <div className=\"space-y-3\">\r\n                          {[\r\n                            { \r\n                              value: REMINDER_ONE_WEEK, \r\n                              days: REMINDER_ONE_WEEK,\r\n                              description: '1 semaine avant la visite'\r\n                            },\r\n                            { \r\n                              value: REMINDER_TWO_DAYS, \r\n                              days: REMINDER_TWO_DAYS,\r\n                              description: '2 jours avant la visite'\r\n                            }\r\n                          ].map(({ value, days, description }) => (\r\n                            <div key={value} className=\"flex items-center justify-between\">\r\n                              <label htmlFor={`reminder-${value}`} className=\"cursor-pointer\">\r\n                                <div className=\"font-medium text-gray-900 dark:text-white\">J-{days}</div>\r\n                                <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                  {description}\r\n                                </div>\r\n                              </label>\r\n                              <input\r\n                                id={`reminder-${value}`}\r\n                                type=\"checkbox\"\r\n                                checked={settings.notifications.reminderDays.includes(days)}\r\n                                onChange={(e) => {\r\n                                  const newDays = e.target.checked\r\n                                    ? [...settings.notifications.reminderDays, days]\r\n                                    : settings.notifications.reminderDays.filter(d => d !== days);\r\n                                  updateSettings({\r\n                                    ...settings,\r\n                                    notifications: { ...settings.notifications, reminderDays: newDays }\r\n                                  });\r\n                                }}\r\n                                className=\"rounded\"\r\n                              />\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4\">\r\n                        <h4 className=\"font-medium text-gray-900 dark:text-white mb-3\">Options</h4>\r\n                        <div className=\"space-y-3\">\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <label htmlFor=\"sound-enabled\" className=\"cursor-pointer\">\r\n                              <div className=\"font-medium text-gray-900 dark:text-white\">Son</div>\r\n                              <div className=\"text-sm text-gray-500 dark:text-gray-400\">Jouer un son pour les notifications</div>\r\n                            </label>\r\n                            <input\r\n                              id=\"sound-enabled\"\r\n                              type=\"checkbox\"\r\n                              checked={settings.notifications.sound}\r\n                              onChange={(e) => updateSettings({\r\n                                ...settings,\r\n                                notifications: { ...settings.notifications, sound: e.target.checked }\r\n                              })}\r\n                              className=\"rounded\"\r\n                            />\r\n                          </div>\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <label htmlFor=\"vibration-enabled\" className=\"cursor-pointer\">\r\n                              <div className=\"font-medium text-gray-900 dark:text-white\">Vibration</div>\r\n                              <div className=\"text-sm text-gray-500 dark:text-gray-400\">Faire vibrer l'appareil</div>\r\n                            </label>\r\n                            <input\r\n                              id=\"vibration-enabled\"\r\n                              type=\"checkbox\"\r\n                              checked={settings.notifications.vibration}\r\n                              onChange={(e) => updateSettings({\r\n                                ...settings,\r\n                                notifications: { ...settings.notifications, vibration: e.target.checked }\r\n                              })}\r\n                              className=\"rounded\"\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </CardBody>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Sécurité */}\r\n          {activeTab === 'security' && (\r\n            <Card>\r\n              <CardHeader>\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2\">\r\n                  <Shield className=\"w-5 h-5\" />\r\n                  Sécurité\r\n                </h3>\r\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                  Gérez la sécurité et le chiffrement des données\r\n                </p>\r\n              </CardHeader>\r\n              <CardBody className=\"space-y-6\">\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <label htmlFor=\"encryption-enabled\" className=\"cursor-pointer\">\r\n                      <div className=\"font-medium text-gray-900 dark:text-white\">Chiffrement activé</div>\r\n                      <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                        Protéger les données sensibles avec un chiffrement AES-GCM\r\n                      </div>\r\n                    </label>\r\n                    <input\r\n                      id=\"encryption-enabled\"\r\n                      type=\"checkbox\"\r\n                      checked={settings.encryptionEnabled}\r\n                      onChange={(e) => updateSettings({\r\n                        ...settings,\r\n                        encryptionEnabled: e.target.checked\r\n                      })}\r\n                      className=\"rounded\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4\">\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Timeout de session (minutes)\r\n                    </label>\r\n                    <Select\r\n                      value={settings.sessionTimeout?.toString() || '30'}\r\n                      onChange={(e) => updateSettings({\r\n                        ...settings,\r\n                        sessionTimeout: parseInt(e.target.value, 10)\r\n                      })}\r\n                      options={[\r\n                        { value: '15', label: '15 minutes' },\r\n                        { value: '30', label: '30 minutes' },\r\n                        { value: '60', label: '1 heure' },\r\n                        { value: '120', label: '2 heures' }\r\n                      ]}\r\n                      className=\"max-w-xs\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Smartphone className=\"w-4 h-4 text-gray-500\" />\r\n                      <span className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                        Version 1.20.0\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </CardBody>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Données (NOUVELLE VERSION) */}\r\n          {activeTab === 'data' && (\r\n            <Card>\r\n              <CardHeader>\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2\">\r\n                  <Database className=\"w-5 h-5\" />\r\n                  Gestion des Données\r\n                </h3>\r\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                  Synchronisation, sauvegardes et archives\r\n                </p>\r\n              </CardHeader>\r\n              <CardBody className=\"space-y-6\">\r\n                <div className=\"space-y-6\">\r\n                  {/* Google Sheets */}\r\n                  <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\r\n                    <h4 className=\"font-medium text-blue-900 dark:text-blue-300 mb-2\">Synchronisation Google Sheets</h4>\r\n                    <p className=\"text-sm text-blue-700 dark:text-blue-400 mb-4\">\r\n                      Cette fonction récupère automatiquement les visites programmées depuis votre Google Sheet et met à jour l'application.\r\n                      Les orateurs et visites existants seront fusionnés intelligemment.\r\n                    </p>\r\n                    <div className=\"flex flex-col sm:flex-row gap-4 items-center\">\r\n                      <Button\r\n                        leftIcon={<RefreshCw className={`w-4 h-4 ${isSyncing ? 'animate-spin' : ''}`} />}\r\n                        onClick={handleSyncGoogleSheet}\r\n                        disabled={isSyncing}\r\n                      >\r\n                        {isSyncing ? 'Synchronisation en cours...' : 'Synchroniser maintenant'}\r\n                      </Button>\r\n\r\n                      {localStorage.getItem('lastGoogleSheetSync') && (\r\n                        <p className=\"text-xs text-gray-600 dark:text-gray-400\">\r\n                          Dernière synchro : {new Date(localStorage.getItem('lastGoogleSheetSync')!).toLocaleString('fr-FR')}\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Boutons d'action Modales */}\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <button\r\n                      onClick={() => setIsBackupModalOpen(true)}\r\n                      className=\"flex items-center gap-4 p-4 text-left border rounded-lg transition-all hover:border-primary-500 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800\"\r\n                    >\r\n                      <div className=\"p-3 bg-green-100 text-green-600 rounded-full dark:bg-green-900/30 dark:text-green-400\">\r\n                        <Save className=\"w-6 h-6\" />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"font-medium text-gray-900 dark:text-white\">Sauvegardes</div>\r\n                        <div className=\"text-xs text-gray-500 dark:text-gray-400\">Gérer les backups locaux et chiffrés</div>\r\n                      </div>\r\n                    </button>\r\n\r\n                    <button\r\n                      onClick={() => setIsImportModalOpen(true)}\r\n                      className=\"flex items-center gap-4 p-4 text-left border rounded-lg transition-all hover:border-primary-500 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800\"\r\n                    >\r\n                      <div className=\"p-3 bg-purple-100 text-purple-600 rounded-full dark:bg-purple-900/30 dark:text-purple-400\">\r\n                        <Database className=\"w-6 h-6\" />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"font-medium text-gray-900 dark:text-white\">Importer des données</div>\r\n                        <div className=\"text-xs text-gray-500 dark:text-gray-400\">Assistant d'importation CSV/JSON</div>\r\n                      </div>\r\n                    </button>\r\n\r\n                    <button\r\n                      onClick={() => setIsArchiveModalOpen(true)}\r\n                      className=\"flex items-center gap-4 p-4 text-left border rounded-lg transition-all hover:border-primary-500 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800\"\r\n                    >\r\n                      <div className=\"p-3 bg-orange-100 text-orange-600 rounded-full dark:bg-orange-900/30 dark:text-orange-400\">\r\n                        <Database className=\"w-6 h-6\" />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"font-medium text-gray-900 dark:text-white\">Archives</div>\r\n                        <div className=\"text-xs text-gray-500 dark:text-gray-400\">Consulter l'historique des visites</div>\r\n                      </div>\r\n                    </button>\r\n\r\n                    <button\r\n                      onClick={() => setIsPhoneImportModalOpen(true)}\r\n                      className=\"flex items-center gap-4 p-4 text-left border rounded-lg transition-all hover:border-primary-500 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800\"\r\n                    >\r\n                      <div className=\"p-3 bg-indigo-100 text-indigo-600 rounded-full dark:bg-indigo-900/30 dark:text-indigo-400\">\r\n                        <Phone className=\"w-6 h-6\" />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"font-medium text-gray-900 dark:text-white\">Numéros de Téléphone</div>\r\n                        <div className=\"text-xs text-gray-500 dark:text-gray-400\">Importer les numéros depuis JSON</div>\r\n                      </div>\r\n                    </button>\r\n                  </div>\r\n\r\n                  <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4\">\r\n                    <h4 className=\"font-medium text-gray-900 dark:text-white mb-3 flex items-center gap-2\">\r\n                      <Link className=\"w-4 h-4\" />\r\n                      Liens Utiles\r\n                    </h4>\r\n                    <div className=\"flex flex-col sm:flex-row gap-4\">\r\n                      <Button asChild variant=\"secondary\">\r\n                        <a\r\n                          href=\"https://docs.google.com/spreadsheets/d/1drIzPPi6AohCroSyUkF1UmMFxuEtMACBF4XATDjBOcg\"\r\n                          target=\"_blank\"\r\n                          rel=\"noopener noreferrer\"\r\n                          className=\"no-underline\"\r\n                        >\r\n                          Ouvrir Google Sheet\r\n                        </a>\r\n                      </Button>\r\n                      <Button asChild variant=\"outline\">\r\n                        <a\r\n                          href=\"https://www.jw.org/kea/\"\r\n                          target=\"_blank\"\r\n                          rel=\"noopener noreferrer\"\r\n                          className=\"no-underline\"\r\n                        >\r\n                          JW.ORG (Cap-Verdien)\r\n                        </a>\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </CardBody>\r\n            </Card>\r\n          )}\r\n\r\n          {/* IA */}\r\n          {activeTab === 'ai' && (\r\n            <Card>\r\n              <CardHeader>\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2\">\r\n                  <Key className=\"w-5 h-5\" />\r\n                  Configuration IA\r\n                </h3>\r\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                  Paramètres de l'assistant IA pour la génération de messages\r\n                </p>\r\n              </CardHeader>\r\n              <CardBody className=\"space-y-6\">\r\n                {/* Section 1: Activation */}\r\n                <div className=\"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\r\n                  <label htmlFor=\"ai-enabled\" className=\"cursor-pointer\">\r\n                    <div className=\"font-medium text-blue-900 dark:text-blue-300\">Assistant IA activé</div>\r\n                    <div className=\"text-sm text-blue-700 dark:text-blue-400\">\r\n                      Utiliser Gemini pour générer des messages personnalisés\r\n                    </div>\r\n                  </label>\r\n                  <input\r\n                    id=\"ai-enabled\"\r\n                    type=\"checkbox\"\r\n                    checked={settings.aiSettings.enabled}\r\n                    onChange={(e) => updateSettings({\r\n                      ...settings,\r\n                      aiSettings: { ...settings.aiSettings, enabled: e.target.checked }\r\n                    })}\r\n                    className=\"rounded\"\r\n                  />\r\n                </div>\r\n\r\n                {settings.aiSettings.enabled && (\r\n                  <>\r\n                    {/* Section 2: Configuration API */}\r\n                    <div className=\"space-y-4\">\r\n                      <h4 className=\"font-medium text-gray-900 dark:text-white\">Connexion API</h4>\r\n\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                          Clé API Gemini\r\n                        </label>\r\n                        <Input\r\n                          type=\"password\"\r\n                          value={settings.aiSettings.apiKey || ''}\r\n                          onChange={(e) => updateSettings({\r\n                            ...settings,\r\n                            aiSettings: { ...settings.aiSettings, apiKey: e.target.value }\r\n                          })}\r\n                          placeholder=\"AIza...\"\r\n                        />\r\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n                          Obtenez votre clé sur{' '}\r\n                          <a\r\n                            href=\"https://makersuite.google.com/app/apikey\"\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"text-primary-600 dark:text-primary-400 hover:underline\"\r\n                          >\r\n                            Google AI Studio\r\n                          </a>\r\n                        </p>\r\n                      </div>\r\n\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                          Modèle\r\n                        </label>\r\n                        <Select\r\n                          value={settings.aiSettings.model}\r\n                          onChange={(e) => updateSettings({\r\n                            ...settings,\r\n                            aiSettings: { ...settings.aiSettings, model: e.target.value }\r\n                          })}\r\n                          options={[\r\n                            { value: 'gemini-pro', label: 'Gemini Pro (Recommandé)' },\r\n                            { value: 'gemini-1.5-pro', label: 'Gemini 1.5 Pro' },\r\n                            { value: 'gemini-1.5-flash', label: 'Gemini 1.5 Flash (Rapide)' }\r\n                          ]}\r\n                          className=\"max-w-xs\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Section 3: Paramètres de génération */}\r\n                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 space-y-4\">\r\n                      <h4 className=\"font-medium text-gray-900 dark:text-white\">Paramètres de génération</h4>\r\n\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                          Créativité (Température): {settings.aiSettings.temperature.toFixed(1)}\r\n                        </label>\r\n                        <div className=\"flex items-center gap-4\">\r\n                          <span className=\"text-xs text-gray-500\">Précis</span>\r\n                          <input\r\n                            type=\"range\"\r\n                            min=\"0\"\r\n                            max=\"1\"\r\n                            step=\"0.1\"\r\n                            value={settings.aiSettings.temperature}\r\n                            onChange={(e) => updateSettings({\r\n                              ...settings,\r\n                              aiSettings: { ...settings.aiSettings, temperature: parseFloat(e.target.value) }\r\n                            })}\r\n                            aria-label=\"Créativité - Température\"\r\n                            className=\"flex-1\"\r\n                          />\r\n                          <span className=\"text-xs text-gray-500\">Créatif</span>\r\n                        </div>\r\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n                          Valeur recommandée: 0.7 pour un équilibre entre précision et créativité\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Section 4: Informations */}\r\n                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4\">\r\n                      <div className=\"bg-gray-50 dark:bg-gray-800 rounded-lg p-4 space-y-2\">\r\n                        <h4 className=\"font-medium text-gray-900 dark:text-white text-sm\">💡 Conseils d'utilisation</h4>\r\n                        <ul className=\"text-xs text-gray-600 dark:text-gray-400 space-y-1 list-disc list-inside\">\r\n                          <li>Gemini Pro est recommandé pour la plupart des usages</li>\r\n                          <li>Gemini 1.5 Flash est plus rapide mais moins précis</li>\r\n                          <li>Une température de 0.7 offre un bon équilibre</li>\r\n                          <li>Votre clé API est stockée de manière sécurisée</li>\r\n                        </ul>\r\n                      </div>\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </CardBody>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Doublons (NOUVELLE VERSION) */}\r\n          {activeTab === 'duplicates' && (\r\n            <Card>\r\n              <CardHeader>\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2\">\r\n                  <Copy className=\"w-5 h-5\" />\r\n                  Détection de Doublons\r\n                </h3>\r\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                  Analysez et fusionnez les doublons dans votre base de données (y compris les archives)\r\n                </p>\r\n              </CardHeader>\r\n              <CardBody className=\"space-y-6\">\r\n                {/* Cartes statistiques */}\r\n                <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\r\n                  <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <User className=\"w-6 h-6 text-blue-600 dark:text-blue-400\" />\r\n                      <div>\r\n                        <div className=\"text-2xl font-bold text-blue-900 dark:text-blue-100\">\r\n                          {(() => {\r\n                            const speakerNames = new Map();\r\n                            speakers.forEach(s => {\r\n                              const key = s.nom.toLowerCase().trim().replace(/\\s+/g, ' ');\r\n                              speakerNames.set(key, (speakerNames.get(key) || 0) + 1);\r\n                            });\r\n                            return Array.from(speakerNames.values()).filter(c => c > 1).length;\r\n                          })()}\r\n                        </div>\r\n                        <div className=\"text-xs text-blue-700 dark:text-blue-300\">Orateurs</div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <Users className=\"w-6 h-6 text-green-600 dark:text-green-400\" />\r\n                      <div>\r\n                        <div className=\"text-2xl font-bold text-green-900 dark:text-green-100\">\r\n                          {(() => {\r\n                            const hostNames = new Map();\r\n                            hosts.forEach(h => {\r\n                              const key = h.nom.toLowerCase().trim().replace(/\\s+/g, ' ');\r\n                              hostNames.set(key, (hostNames.get(key) || 0) + 1);\r\n                            });\r\n                            return Array.from(hostNames.values()).filter(c => c > 1).length;\r\n                          })()}\r\n                        </div>\r\n                        <div className=\"text-xs text-green-700 dark:text-green-300\">Hôtes</div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <Copy className=\"w-6 h-6 text-purple-600 dark:text-purple-400\" />\r\n                      <div>\r\n                        <div className=\"text-2xl font-bold text-purple-900 dark:text-purple-100\">\r\n                          {(() => {\r\n                            const visitKeys = new Map();\r\n                            visits.forEach(v => {\r\n                              const key = `${v.id}-${v.visitDate}-${v.visitTime}`;\r\n                              visitKeys.set(key, (visitKeys.get(key) || 0) + 1);\r\n                            });\r\n                            return Array.from(visitKeys.values()).filter(c => c > 1).length;\r\n                          })()}\r\n                        </div>\r\n                        <div className=\"text-xs text-purple-700 dark:text-purple-300\">Visites</div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <Copy className=\"w-6 h-6 text-orange-600 dark:text-orange-400\" />\r\n                      <div>\r\n                        <div className=\"text-2xl font-bold text-orange-900 dark:text-orange-100\">\r\n                          {(() => {\r\n                            if (!archivedVisits) return 0;\r\n                            const archivedVisitKeys = new Map();\r\n                            archivedVisits.forEach(v => {\r\n                              const key = `${v.id}-${v.visitDate}-${v.visitTime}`;\r\n                              archivedVisitKeys.set(key, (archivedVisitKeys.get(key) || 0) + 1);\r\n                            });\r\n                            // Vérifier aussi les doublons entre actuelles et archivées\r\n                            const crossVisitKeys = new Map();\r\n                            visits.forEach(currentVisit => {\r\n                              const key = `${currentVisit.id}-${currentVisit.visitDate}-${currentVisit.visitTime || ''}`;\r\n                              const matchingArchived = archivedVisits.filter(av =>\r\n                                av.id === currentVisit.id &&\r\n                                av.visitDate === currentVisit.visitDate &&\r\n                                av.visitTime === currentVisit.visitTime\r\n                              );\r\n                              if (matchingArchived.length > 0) {\r\n                                crossVisitKeys.set(key, (crossVisitKeys.get(key) || 0) + matchingArchived.length + 1);\r\n                              }\r\n                            });\r\n                            const archiveDuplicates = Array.from(archivedVisitKeys.values()).filter(c => c > 1).length;\r\n                            const crossDuplicates = Array.from(crossVisitKeys.values()).filter(c => c > 1).length;\r\n                            return archiveDuplicates + crossDuplicates;\r\n                          })()}\r\n                        </div>\r\n                        <div className=\"text-xs text-orange-700 dark:text-orange-300\">Archives</div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <Copy className=\"w-6 h-6 text-red-600 dark:text-red-400\" />\r\n                      <div>\r\n                        <div className=\"text-2xl font-bold text-red-900 dark:text-red-100\">\r\n                          {(() => {\r\n                            const msgKeys = new Map();\r\n                            if (speakerMessages) {\r\n                              speakerMessages.forEach(m => {\r\n                                // Même logique que dans la modale\r\n                                const normalizedContent = m.message?.trim().toLowerCase() || '';\r\n                                const dateKey = m.receivedAt ? new Date(m.receivedAt).toISOString() : 'no-date';\r\n                                const key = `${m.speakerId}-${normalizedContent}-${dateKey}`;\r\n                                msgKeys.set(key, (msgKeys.get(key) || 0) + 1);\r\n                              });\r\n                            }\r\n                            const DUPLICATE_THRESHOLD = 1;\r\n                            return Array.from(msgKeys.values()).filter(c => c > DUPLICATE_THRESHOLD).length;\r\n                          })()}\r\n                        </div>\r\n                        <div className=\"text-xs text-red-700 dark:text-red-300\">Messages</div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                </div>\r\n\r\n                {/* Bouton d'action */}\r\n                <div className=\"text-center pt-4\">\r\n                  <Button onClick={() => setIsDuplicateModalOpen(true)} size=\"lg\">\r\n                    <Copy className=\"w-4 h-4 mr-2\" />\r\n                    Lancer l'analyse complète\r\n                  </Button>\r\n                  <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-3\">\r\n                    Cliquez pour voir les détails et fusionner les doublons\r\n                  </p>\r\n                </div>\r\n              </CardBody>\r\n            </Card>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modals en bas de page */}\r\n      <BackupManagerModal\r\n        isOpen={isBackupModalOpen}\r\n        onClose={() => setIsBackupModalOpen(false)}\r\n        onBackup={handleBackupAdapter}\r\n        onRestore={handleRestoreAdapter}\r\n      />\r\n\r\n      <ImportWizardModal\r\n        isOpen={isImportModalOpen}\r\n        onClose={() => setIsImportModalOpen(false)}\r\n        onImport={handleImportAdapter}\r\n      />\r\n\r\n      <ArchiveManagerModal\r\n        isOpen={isArchiveModalOpen}\r\n        onClose={() => setIsArchiveModalOpen(false)}\r\n        onRestore={(_visitIds: string[]) => {\r\n          _visitIds.forEach(_id => {\r\n            // TODO: Récupérer la visite depuis les archives et l'ajouter\r\n            // Logique de restauration de la visite\r\n          });\r\n          addToast(`${_visitIds.length} visite(s) restaurée(s)`, 'success');\r\n        }}\r\n        onDelete={(_visitIds: string[]) => {\r\n          _visitIds.forEach(id => deleteVisit(id));\r\n          addToast(`${_visitIds.length} visite(s) supprimée(s)`, 'info');\r\n        }}\r\n        onExport={async (_visitIds: string[]) => {\r\n          // Logique d'exportation des visites sélectionnées\r\n          await handleBackupAdapter({ includeArchived: true, includeSettings: false, includeTemplates: false, encrypt: false });\r\n        }}\r\n      />\r\n\r\n      <DuplicateDetectionModal\r\n        isOpen={isDuplicateModalOpen}\r\n        onClose={() => setIsDuplicateModalOpen(false)}\r\n        onMerge={handleMergeAdapter}\r\n      />\r\n\r\n      <PhoneNumberImportModal\r\n        isOpen={isPhoneImportModalOpen}\r\n        onClose={() => setIsPhoneImportModalOpen(false)}\r\n      />\r\n    </div>\r\n  );\r\n};\r\nexport default Settings; \r\n\r\n\r\n"],"names":["Database","createLucideIcon","HardDrive","Key","Merge","Monitor","Moon","Palette","Shield","Smartphone","Sun","Upload","DuplicateDetectionModal","isOpen","_onClose","_onMerge","speakers","hosts","visits","speakerMessages","archivedVisits","useData","selectedGroups","setSelectedGroups","useState","mergeStrategy","setMergeStrategy","includeArchives","setIncludeArchives","SIMILARITY_THRESHOLD_HIGH","SIMILARITY_THRESHOLD_MEDIUM","duplicateGroups","useMemo","groups","speakerGroups","speaker","key","group","reasons","phones","s","congregations","similarity","hostGroups","host","h","addresses","visitGroups","visit","archivedVisitGroups","crossVisitGroups","currentVisit","av","archived","messageGroups","msg","normalizedContent","dateKey","toggleGroup","index","prev","newSet","handleMerge","selectedDuplicates","idx","handleDelete","getTypeLabel","type","getTypeColor","jsx","Modal","jsxs","g","e","CheckCircle","Fragment","_","i","Card","CardBody","Badge","reason","Copy","item","itemIdx","v","AlertTriangle","Button","Trash2","BackupManagerModal","onClose","onBackup","onRestore","activeTab","setActiveTab","includeArchived","setIncludeArchived","includeSettings","setIncludeSettings","includeTemplates","setIncludeTemplates","encrypt","setEncrypt","password","setPassword","confirmPassword","setConfirmPassword","isCreating","setIsCreating","selectedFile","setSelectedFile","backupHistory","handleCreateBackup","error","handleFileSelect","event","file","handleRestore","formatFileSize","bytes","Save","Clock","Download","backup","AVAILABLE_FIELDS","ImportWizardModal","onImport","currentStep","setCurrentStep","importType","setImportType","setFile","parsedData","setParsedData","columns","setColumns","mapping","setMapping","importResult","setImportResult","lines","line","headers","data","values","row","header","handleMappingChange","sourceColumn","targetField","handleImport","transformedData","transformed","sourceCol","result","getMappingProgress","requiredFields","f","canProceed","step","React","ArrowRight","FileText","column","field","k","ArchiveManagerModal","onDelete","onExport","searchTerm","setSearchTerm","selectedYear","setSelectedYear","selectedStatus","setSelectedStatus","selectedVisits","setSelectedVisits","sortBy","setSortBy","availableYears","years","year","a","b","filteredVisits","filtered","search","toggleVisit","visitId","selectAll","deselectAll","handleExport","getStatusBadge","status","Search","Archive","Calendar","RotateCcw","extractPhoneNumbersFromJson","jsonData","speakersWithPhones","hostsWithPhones","updateSpeakersWithPhones","existingSpeakers","phoneMap","person","normalizedName","phoneFromJson","updateHostsWithPhones","existingHosts","generateUpdateReport","originalSpeakers","updatedSpeakers","originalHosts","updatedHosts","speakerDetails","hostDetails","speakersUpdated","hostsUpdated","original","updated","processPhoneNumberUpdate","currentData","report","PhoneNumberImportModal","updateSpeaker","updateHost","importData","setImportData","isLoading","setIsLoading","setResult","showPreview","setShowPreview","handleFileUpload","reader","content","speakerUpdates","existingSpeaker","updatedSpeaker","us","hostUpdates","existingHost","updatedHost","uh","resolve","handleClose","Phone","X","detail","AlertCircle","parsed","speakerCount","visitCount","hostCount","Users","MapPin","REMINDER_ONE_WEEK","REMINDER_TWO_DAYS","Settings","congregationProfile","updateCongregationProfile","syncWithGoogleSheet","exportData","mergeDuplicates","deleteVisit","deleteSpeaker","deleteHost","settings","updateSettings","useSettings","addToast","useToast","profileForm","setProfileForm","isSyncing","setIsSyncing","isBackupModalOpen","setIsBackupModalOpen","isImportModalOpen","setIsImportModalOpen","isArchiveModalOpen","setIsArchiveModalOpen","isDuplicateModalOpen","setIsDuplicateModalOpen","isPhoneImportModalOpen","setIsPhoneImportModalOpen","tabs","User","Bell","handleSaveProfile","handleThemeChange","theme","handleLanguageChange","language","handleSyncGoogleSheet","DATE_FORMAT_LENGTH","handleBackupAdapter","_options","json","blob","url","handleRestoreAdapter","reject","err","handleImportAdapter","_mapping","handleMergeAdapter","action","strategy","successCount","sortedItems","dateA","keepItem","duplicates","keepId","duplicateIds","id","name","tab","CardHeader","Input","Select","value","days","description","newDays","d","RefreshCw","Link","speakerNames","c","hostNames","visitKeys","archivedVisitKeys","crossVisitKeys","matchingArchived","archiveDuplicates","crossDuplicates","msgKeys","m","DUPLICATE_THRESHOLD","_visitIds","_id"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10]}