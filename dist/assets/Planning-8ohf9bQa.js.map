{"version":3,"file":"Planning-8ohf9bQa.js","sources":["../../node_modules/lucide-react/dist/esm/icons/arrow-down-right.js","../../node_modules/lucide-react/dist/esm/icons/arrow-up-right.js","../../node_modules/lucide-react/dist/esm/icons/bar-chart.js","../../node_modules/lucide-react/dist/esm/icons/eye.js","../../node_modules/lucide-react/dist/esm/icons/layout-grid.js","../../node_modules/lucide-react/dist/esm/icons/list.js","../../node_modules/lucide-react/dist/esm/icons/more-horizontal.js","../../node_modules/lucide-react/dist/esm/icons/more-vertical.js","../../node_modules/lucide-react/dist/esm/icons/pie-chart.js","../../src/components/planning/ConflictDetectionModal.tsx","../../src/components/planning/CancellationModal.tsx","../../src/components/planning/EmergencyReplacementModal.tsx","../../src/components/planning/VisitCard.tsx","../../src/components/planning/PlanningCardsView.tsx","../../src/components/planning/PlanningListView.tsx","../../src/components/planning/PlanningCalendarView.tsx","../../src/components/planning/ScheduleVisitModal.tsx","../../src/components/planning/PlanningWorkloadView.tsx","../../src/components/planning/PlanningTimelineView.tsx","../../src/components/expenses/FinancialDashboard.tsx","../../src/components/ui/DatePicker.tsx","../../src/components/planning/PlanningFilterModal.tsx","../../src/pages/Planning.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ArrowDownRight = createLucideIcon(\"ArrowDownRight\", [\n  [\"path\", { d: \"m7 7 10 10\", key: \"1fmybs\" }],\n  [\"path\", { d: \"M17 7v10H7\", key: \"6fjiku\" }]\n]);\n\nexport { ArrowDownRight as default };\n//# sourceMappingURL=arrow-down-right.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ArrowUpRight = createLucideIcon(\"ArrowUpRight\", [\n  [\"path\", { d: \"M7 7h10v10\", key: \"1tivn9\" }],\n  [\"path\", { d: \"M7 17 17 7\", key: \"1vkiza\" }]\n]);\n\nexport { ArrowUpRight as default };\n//# sourceMappingURL=arrow-up-right.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst BarChart = createLucideIcon(\"BarChart\", [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"20\", y2: \"10\", key: \"1vz5eb\" }],\n  [\"line\", { x1: \"18\", x2: \"18\", y1: \"20\", y2: \"4\", key: \"cun8e5\" }],\n  [\"line\", { x1: \"6\", x2: \"6\", y1: \"20\", y2: \"16\", key: \"hq0ia6\" }]\n]);\n\nexport { BarChart as default };\n//# sourceMappingURL=bar-chart.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Eye = createLucideIcon(\"Eye\", [\n  [\"path\", { d: \"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z\", key: \"rwhkz3\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n]);\n\nexport { Eye as default };\n//# sourceMappingURL=eye.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst LayoutGrid = createLucideIcon(\"LayoutGrid\", [\n  [\"rect\", { width: \"7\", height: \"7\", x: \"3\", y: \"3\", rx: \"1\", key: \"1g98yp\" }],\n  [\"rect\", { width: \"7\", height: \"7\", x: \"14\", y: \"3\", rx: \"1\", key: \"6d4xhi\" }],\n  [\"rect\", { width: \"7\", height: \"7\", x: \"14\", y: \"14\", rx: \"1\", key: \"nxv5o0\" }],\n  [\"rect\", { width: \"7\", height: \"7\", x: \"3\", y: \"14\", rx: \"1\", key: \"1bb6yr\" }]\n]);\n\nexport { LayoutGrid as default };\n//# sourceMappingURL=layout-grid.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst List = createLucideIcon(\"List\", [\n  [\"line\", { x1: \"8\", x2: \"21\", y1: \"6\", y2: \"6\", key: \"7ey8pc\" }],\n  [\"line\", { x1: \"8\", x2: \"21\", y1: \"12\", y2: \"12\", key: \"rjfblc\" }],\n  [\"line\", { x1: \"8\", x2: \"21\", y1: \"18\", y2: \"18\", key: \"c3b1m8\" }],\n  [\"line\", { x1: \"3\", x2: \"3.01\", y1: \"6\", y2: \"6\", key: \"1g7gq3\" }],\n  [\"line\", { x1: \"3\", x2: \"3.01\", y1: \"12\", y2: \"12\", key: \"1pjlvk\" }],\n  [\"line\", { x1: \"3\", x2: \"3.01\", y1: \"18\", y2: \"18\", key: \"28t2mc\" }]\n]);\n\nexport { List as default };\n//# sourceMappingURL=list.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst MoreHorizontal = createLucideIcon(\"MoreHorizontal\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"1\", key: \"41hilf\" }],\n  [\"circle\", { cx: \"19\", cy: \"12\", r: \"1\", key: \"1wjl8i\" }],\n  [\"circle\", { cx: \"5\", cy: \"12\", r: \"1\", key: \"1pcz8c\" }]\n]);\n\nexport { MoreHorizontal as default };\n//# sourceMappingURL=more-horizontal.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst MoreVertical = createLucideIcon(\"MoreVertical\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"1\", key: \"41hilf\" }],\n  [\"circle\", { cx: \"12\", cy: \"5\", r: \"1\", key: \"gxeob9\" }],\n  [\"circle\", { cx: \"12\", cy: \"19\", r: \"1\", key: \"lyex9k\" }]\n]);\n\nexport { MoreVertical as default };\n//# sourceMappingURL=more-vertical.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst PieChart = createLucideIcon(\"PieChart\", [\n  [\"path\", { d: \"M21.21 15.89A10 10 0 1 1 8 2.83\", key: \"k2fpak\" }],\n  [\"path\", { d: \"M22 12A10 10 0 0 0 12 2v10z\", key: \"1rfc4y\" }]\n]);\n\nexport { PieChart as default };\n//# sourceMappingURL=pie-chart.js.map\n","import React, { useMemo, useState } from 'react';\r\nimport { AlertTriangle, Calendar, CheckCircle, XCircle, ArrowRight } from 'lucide-react';\r\nimport { Modal } from '@/components/ui/Modal';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Card, CardBody } from '@/components/ui/Card';\r\nimport { Visit, Speaker, Host } from '@/types';\r\nimport { useData } from '@/contexts/DataContext';\r\n\r\ninterface ConflictDetectionModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  visit: Visit;\r\n  onResolve?: (resolution: ConflictResolution) => void;\r\n}\r\n\r\ninterface Conflict {\r\n  id: string;\r\n  type: 'date' | 'speaker' | 'host' | 'talk';\r\n  severity: 'critical' | 'warning' | 'info';\r\n  message: string;\r\n  details: string;\r\n  affectedVisit?: Visit;\r\n  suggestions: ConflictSuggestion[];\r\n}\r\n\r\ninterface ConflictSuggestion {\r\n  id: string;\r\n  type: 'reschedule' | 'change_speaker' | 'change_host' | 'cancel';\r\n  description: string;\r\n  newDate?: string;\r\n  newSpeaker?: Speaker;\r\n  newHost?: Host;\r\n  impact: 'low' | 'medium' | 'high';\r\n}\r\n\r\ninterface ConflictResolution {\r\n  conflictId: string;\r\n  suggestionId: string;\r\n  action: 'apply' | 'ignore';\r\n}\r\n\r\nexport const ConflictDetectionModal: React.FC<ConflictDetectionModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  visit,\r\n  onResolve\r\n}) => {\r\n  const { visits, hosts } = useData();\r\n  const [selectedResolutions, setSelectedResolutions] = useState<Map<string, string>>(new Map());\r\n\r\n  // D√©tection des conflits\r\n  const conflicts = useMemo(() => {\r\n    const detected: Conflict[] = [];\r\n\r\n    // 1. Conflit de date - M√™me orateur, m√™me date\r\n    const sameDateSpeaker = visits.find(v => \r\n      v.id === visit.id && \r\n      v.visitId !== visit.visitId &&\r\n      v.visitDate === visit.visitDate &&\r\n      v.status !== 'cancelled'\r\n    );\r\n\r\n    if (sameDateSpeaker) {\r\n      detected.push({\r\n        id: 'conflict-speaker-date',\r\n        type: 'speaker',\r\n        severity: 'critical',\r\n        message: 'Orateur d√©j√† programm√©',\r\n        details: `${visit.nom} est d√©j√† programm√© le ${new Date(visit.visitDate).toLocaleDateString('fr-FR')}`,\r\n        affectedVisit: sameDateSpeaker,\r\n        suggestions: [\r\n          {\r\n            id: 'suggest-reschedule',\r\n            type: 'reschedule',\r\n            description: 'Reprogrammer cette visite √† une autre date',\r\n            impact: 'medium'\r\n          },\r\n          {\r\n            id: 'suggest-cancel-other',\r\n            type: 'cancel',\r\n            description: 'Annuler l\\'autre visite',\r\n            impact: 'high'\r\n          }\r\n        ]\r\n      });\r\n    }\r\n\r\n    // 2. Conflit d'h√¥te - H√¥te indisponible\r\n    const hostData = hosts.find(h => h.nom === visit.host);\r\n    if (hostData?.unavailableDates?.includes(visit.visitDate)) {\r\n      const availableHosts = hosts.filter(h => \r\n        !h.unavailableDates?.includes(visit.visitDate) &&\r\n        h.gender === visit.congregation // Exemple de matching\r\n      );\r\n\r\n      detected.push({\r\n        id: 'conflict-host-unavailable',\r\n        type: 'host',\r\n        severity: 'warning',\r\n        message: 'H√¥te indisponible',\r\n        details: `${visit.host} n'est pas disponible le ${new Date(visit.visitDate).toLocaleDateString('fr-FR')}`,\r\n        suggestions: availableHosts.slice(0, 3).map((h, idx) => ({\r\n          id: `suggest-host-${idx}`,\r\n          type: 'change_host',\r\n          description: `Assigner √† ${h.nom}`,\r\n          newHost: h,\r\n          impact: 'low'\r\n        }))\r\n      });\r\n    }\r\n\r\n    // 3. Conflit de discours - M√™me discours r√©cemment donn√©\r\n    const recentSameTalk = visits.find(v => \r\n      v.visitId !== visit.visitId &&\r\n      v.talkNoOrType === visit.talkNoOrType &&\r\n      v.status === 'completed' &&\r\n      Math.abs(new Date(v.visitDate).getTime() - new Date(visit.visitDate).getTime()) < 90 * 24 * 60 * 60 * 1000 // 90 jours\r\n    );\r\n\r\n    if (recentSameTalk && visit.talkNoOrType) {\r\n      detected.push({\r\n        id: 'conflict-talk-recent',\r\n        type: 'talk',\r\n        severity: 'info',\r\n        message: 'Discours r√©cemment donn√©',\r\n        details: `Le discours ${visit.talkNoOrType} a √©t√© donn√© il y a moins de 3 mois`,\r\n        affectedVisit: recentSameTalk,\r\n        suggestions: [\r\n          {\r\n            id: 'suggest-different-talk',\r\n            type: 'change_speaker',\r\n            description: 'Choisir un autre discours',\r\n            impact: 'low'\r\n          },\r\n          {\r\n            id: 'suggest-ignore',\r\n            type: 'reschedule',\r\n            description: 'Continuer quand m√™me',\r\n            impact: 'low'\r\n          }\r\n        ]\r\n      });\r\n    }\r\n\r\n    // 4. Conflit de charge - Trop de visites le m√™me mois\r\n    const sameMonthVisits = visits.filter(v => {\r\n      const vDate = new Date(v.visitDate);\r\n      const visitDate = new Date(visit.visitDate);\r\n      return vDate.getMonth() === visitDate.getMonth() &&\r\n             vDate.getFullYear() === visitDate.getFullYear() &&\r\n             v.status !== 'cancelled';\r\n    });\r\n\r\n    if (sameMonthVisits.length > 5) {\r\n      detected.push({\r\n        id: 'conflict-overload',\r\n        type: 'date',\r\n        severity: 'warning',\r\n        message: 'Charge √©lev√©e ce mois',\r\n        details: `${sameMonthVisits.length} visites programm√©es ce mois`,\r\n        suggestions: [\r\n          {\r\n            id: 'suggest-next-month',\r\n            type: 'reschedule',\r\n            description: 'D√©placer au mois suivant',\r\n            impact: 'medium'\r\n          }\r\n        ]\r\n      });\r\n    }\r\n\r\n    return detected;\r\n  }, [visit, visits, hosts]);\r\n\r\n  const getSeverityColor = (severity: Conflict['severity']) => {\r\n    switch (severity) {\r\n      case 'critical': return 'text-red-600 bg-red-100 dark:bg-red-900/20';\r\n      case 'warning': return 'text-orange-600 bg-orange-100 dark:bg-orange-900/20';\r\n      case 'info': return 'text-blue-600 bg-blue-100 dark:bg-blue-900/20';\r\n    }\r\n  };\r\n\r\n  const getSeverityIcon = (severity: Conflict['severity']) => {\r\n    switch (severity) {\r\n      case 'critical': return <XCircle className=\"w-5 h-5\" />;\r\n      case 'warning': return <AlertTriangle className=\"w-5 h-5\" />;\r\n      case 'info': return <CheckCircle className=\"w-5 h-5\" />;\r\n    }\r\n  };\r\n\r\n  const handleSelectSuggestion = (conflictId: string, suggestionId: string) => {\r\n    setSelectedResolutions(prev => {\r\n      const newMap = new Map(prev);\r\n      newMap.set(conflictId, suggestionId);\r\n      return newMap;\r\n    });\r\n  };\r\n\r\n  const handleApplyResolutions = () => {\r\n    selectedResolutions.forEach((suggestionId, conflictId) => {\r\n      if (onResolve) {\r\n        onResolve({\r\n          conflictId,\r\n          suggestionId,\r\n          action: 'apply'\r\n        });\r\n      }\r\n    });\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"D√©tection de Conflits\"\r\n      size=\"lg\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {/* En-t√™te */}\r\n        <div className=\"flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n          <Calendar className=\"w-6 h-6 text-primary-600\" />\r\n          <div>\r\n            <h4 className=\"font-semibold text-gray-900 dark:text-white\">\r\n              {visit.nom}\r\n            </h4>\r\n            <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n              {new Date(visit.visitDate).toLocaleDateString('fr-FR', {\r\n                weekday: 'long',\r\n                day: 'numeric',\r\n                month: 'long',\r\n                year: 'numeric'\r\n              })} √† {visit.visitTime}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* R√©sum√© */}\r\n        <div className=\"flex items-center justify-between p-4 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <AlertTriangle className=\"w-5 h-5 text-orange-500\" />\r\n            <span className=\"font-medium text-gray-900 dark:text-white\">\r\n              {conflicts.length} conflit{conflicts.length > 1 ? 's' : ''} d√©tect√©{conflicts.length > 1 ? 's' : ''}\r\n            </span>\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <Badge variant=\"danger\">\r\n              {conflicts.filter(c => c.severity === 'critical').length} critique{conflicts.filter(c => c.severity === 'critical').length > 1 ? 's' : ''}\r\n            </Badge>\r\n            <Badge variant=\"warning\">\r\n              {conflicts.filter(c => c.severity === 'warning').length} avertissement{conflicts.filter(c => c.severity === 'warning').length > 1 ? 's' : ''}\r\n            </Badge>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Liste des conflits */}\r\n        {conflicts.length === 0 ? (\r\n          <div className=\"text-center py-12\">\r\n            <CheckCircle className=\"w-16 h-16 mx-auto mb-4 text-green-500\" />\r\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\r\n              Aucun conflit d√©tect√©\r\n            </h3>\r\n            <p className=\"text-gray-600 dark:text-gray-400\">\r\n              Cette visite peut √™tre programm√©e sans probl√®me\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4 max-h-96 overflow-y-auto\">\r\n            {conflicts.map((conflict) => (\r\n              <Card key={conflict.id} className={`border-l-4 ${\r\n                conflict.severity === 'critical' ? 'border-l-red-600' : \r\n                conflict.severity === 'warning' ? 'border-l-orange-500' : 'border-l-blue-500'\r\n              }`}>\r\n                <CardBody className=\"space-y-4\">\r\n                  {/* En-t√™te du conflit */}\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <div className={`p-2 rounded-lg ${getSeverityColor(conflict.severity)}`}>\r\n                      {getSeverityIcon(conflict.severity)}\r\n                    </div>\r\n                    <div className=\"flex-1\">\r\n                      <h4 className=\"font-semibold text-gray-900 dark:text-white\">\r\n                        {conflict.message}\r\n                      </h4>\r\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\r\n                        {conflict.details}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Suggestions */}\r\n                  {conflict.suggestions.length > 0 && (\r\n                    <div className=\"space-y-2\">\r\n                      <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                        Solutions sugg√©r√©es :\r\n                      </p>\r\n                      {conflict.suggestions.map((suggestion) => (\r\n                        <button\r\n                          key={suggestion.id}\r\n                          onClick={() => handleSelectSuggestion(conflict.id, suggestion.id)}\r\n                          className={`w-full text-left p-3 rounded-lg border-2 transition-all ${\r\n                            selectedResolutions.get(conflict.id) === suggestion.id\r\n                              ? 'border-primary-500 bg-primary-50 dark:bg-primary-900/20'\r\n                              : 'border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600'\r\n                          }`}\r\n                        >\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <ArrowRight className=\"w-4 h-4 text-primary-600\" />\r\n                              <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                                {suggestion.description}\r\n                              </span>\r\n                            </div>\r\n                            <Badge variant={\r\n                              suggestion.impact === 'high' ? 'danger' :\r\n                              suggestion.impact === 'medium' ? 'warning' : 'default'\r\n                            }>\r\n                              Impact {suggestion.impact === 'high' ? '√©lev√©' : \r\n                                     suggestion.impact === 'medium' ? 'moyen' : 'faible'}\r\n                            </Badge>\r\n                          </div>\r\n                        </button>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </CardBody>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n          <Button variant=\"secondary\" onClick={onClose}>\r\n            Annuler\r\n          </Button>\r\n          {conflicts.length > 0 && (\r\n            <>\r\n              <Button \r\n                variant=\"outline\" \r\n                onClick={() => {\r\n                  conflicts.forEach(c => {\r\n                    if (onResolve) {\r\n                      onResolve({\r\n                        conflictId: c.id,\r\n                        suggestionId: '',\r\n                        action: 'ignore'\r\n                      });\r\n                    }\r\n                  });\r\n                  onClose();\r\n                }}\r\n              >\r\n                Ignorer les conflits\r\n              </Button>\r\n              <Button \r\n                variant=\"primary\" \r\n                onClick={handleApplyResolutions}\r\n                disabled={selectedResolutions.size === 0}\r\n              >\r\n                Appliquer les solutions ({selectedResolutions.size})\r\n              </Button>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React, { useState } from 'react';\r\nimport { XCircle, Calendar, MessageSquare, RotateCcw, Send, AlertTriangle } from 'lucide-react';\r\nimport { Modal } from '@/components/ui/Modal';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Visit } from '@/types';\r\n\r\ninterface CancellationModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  visit: Visit;\r\n  onCancel: (cancellationData: CancellationData) => void;\r\n}\r\n\r\nexport interface CancellationData {\r\n  visitId: string;\r\n  reason: CancellationReason;\r\n  customReason?: string;\r\n  notifySpeaker: boolean;\r\n  notifyHost: boolean;\r\n  proposeReschedule: boolean;\r\n  suggestedNewDate?: string;\r\n  internalNotes?: string;\r\n  cancelledBy: string;\r\n  cancelledAt: string;\r\n}\r\n\r\ntype CancellationReason = \r\n  | 'speaker_unavailable'\r\n  | 'host_unavailable'\r\n  | 'congregation_conflict'\r\n  | 'weather'\r\n  | 'health'\r\n  | 'emergency'\r\n  | 'duplicate'\r\n  | 'other';\r\n\r\nconst CANCELLATION_REASONS: { value: CancellationReason; label: string; icon: string }[] = [\r\n  { value: 'speaker_unavailable', label: 'Orateur indisponible', icon: 'üë§' },\r\n  { value: 'host_unavailable', label: 'H√¥te indisponible', icon: 'üè†' },\r\n  { value: 'congregation_conflict', label: 'Conflit de congr√©gation', icon: '‚ö†Ô∏è' },\r\n  { value: 'weather', label: 'Conditions m√©t√©o', icon: 'üåßÔ∏è' },\r\n  { value: 'health', label: 'Raisons de sant√©', icon: 'üè•' },\r\n  { value: 'emergency', label: 'Urgence', icon: 'üö®' },\r\n  { value: 'duplicate', label: 'Doublon d√©tect√©', icon: 'üìã' },\r\n  { value: 'other', label: 'Autre raison', icon: 'üìù' },\r\n];\r\n\r\nexport const CancellationModal: React.FC<CancellationModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  visit,\r\n  onCancel\r\n}) => {\r\n  const [selectedReason, setSelectedReason] = useState<CancellationReason | null>(null);\r\n  const [customReason, setCustomReason] = useState('');\r\n  const [notifySpeaker, setNotifySpeaker] = useState(true);\r\n  const [notifyHost, setNotifyHost] = useState(true);\r\n  const [proposeReschedule, setProposeReschedule] = useState(false);\r\n  const [suggestedNewDate, setSuggestedNewDate] = useState('');\r\n  const [internalNotes, setInternalNotes] = useState('');\r\n  const [showConfirmation, setShowConfirmation] = useState(false);\r\n\r\n  const handleSubmit = () => {\r\n    if (!selectedReason) return;\r\n\r\n    const cancellationData: CancellationData = {\r\n      visitId: visit.visitId,\r\n      reason: selectedReason,\r\n      customReason: selectedReason === 'other' ? customReason : undefined,\r\n      notifySpeaker,\r\n      notifyHost,\r\n      proposeReschedule,\r\n      suggestedNewDate: proposeReschedule ? suggestedNewDate : undefined,\r\n      internalNotes,\r\n      cancelledBy: 'Coordinateur', // √Ä remplacer par l'utilisateur connect√©\r\n      cancelledAt: new Date().toISOString()\r\n    };\r\n\r\n    onCancel(cancellationData);\r\n    onClose();\r\n  };\r\n\r\n  const getNotificationPreview = () => {\r\n    const reason = CANCELLATION_REASONS.find(r => r.value === selectedReason);\r\n    return `Bonjour ${visit.nom},\\n\\nNous sommes au regret de vous informer que la visite pr√©vue le ${new Date(visit.visitDate).toLocaleDateString('fr-FR')} doit √™tre annul√©e.\\n\\nRaison : ${reason?.label}${selectedReason === 'other' && customReason ? ` - ${customReason}` : ''}\\n\\n${proposeReschedule && suggestedNewDate ? `Nous vous proposons de reprogrammer cette visite le ${new Date(suggestedNewDate).toLocaleDateString('fr-FR')}.\\n\\n` : ''}Nous vous contacterons prochainement pour convenir d'une nouvelle date.\\n\\nCordialement,\\nKBV Lyon`;\r\n  };\r\n\r\n  if (showConfirmation) {\r\n    return (\r\n      <Modal\r\n        isOpen={isOpen}\r\n        onClose={onClose}\r\n        title=\"Confirmer l'annulation\"\r\n        size=\"md\"\r\n      >\r\n        <div className=\"space-y-6\">\r\n          <div className=\"flex items-start gap-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg\">\r\n            <AlertTriangle className=\"w-6 h-6 text-red-600 flex-shrink-0 mt-1\" />\r\n            <div>\r\n              <h4 className=\"font-semibold text-red-900 dark:text-red-200 mb-2\">\r\n                Attention : Action irr√©versible\r\n              </h4>\r\n              <p className=\"text-sm text-red-800 dark:text-red-300\">\r\n                Vous √™tes sur le point d'annuler d√©finitivement cette visite. Cette action ne peut pas √™tre annul√©e.\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-3\">\r\n            <div className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n              <span className=\"text-sm text-gray-600 dark:text-gray-400\">Orateur</span>\r\n              <span className=\"font-medium text-gray-900 dark:text-white\">{visit.nom}</span>\r\n            </div>\r\n            <div className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n              <span className=\"text-sm text-gray-600 dark:text-gray-400\">Date</span>\r\n              <span className=\"font-medium text-gray-900 dark:text-white\">\r\n                {new Date(visit.visitDate).toLocaleDateString('fr-FR')}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n              <span className=\"text-sm text-gray-600 dark:text-gray-400\">Raison</span>\r\n              <span className=\"font-medium text-gray-900 dark:text-white\">\r\n                {CANCELLATION_REASONS.find(r => r.value === selectedReason)?.label}\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          {(notifySpeaker || notifyHost) && (\r\n            <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\r\n              <div className=\"flex items-center gap-2 mb-2\">\r\n                <Send className=\"w-4 h-4 text-blue-600\" />\r\n                <span className=\"font-medium text-blue-900 dark:text-blue-200\">\r\n                  Notifications √† envoyer\r\n                </span>\r\n              </div>\r\n              <ul className=\"text-sm text-blue-800 dark:text-blue-300 space-y-1\">\r\n                {notifySpeaker && <li>‚Ä¢ Notification √† l'orateur ({visit.nom})</li>}\r\n                {notifyHost && <li>‚Ä¢ Notification √† l'h√¥te ({visit.host})</li>}\r\n              </ul>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n            <Button variant=\"secondary\" onClick={() => setShowConfirmation(false)}>\r\n              Retour\r\n            </Button>\r\n            <Button variant=\"danger\" onClick={handleSubmit}>\r\n              <XCircle className=\"w-4 h-4 mr-2\" />\r\n              Confirmer l'annulation\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Annuler une visite\"\r\n      size=\"lg\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {/* Informations de la visite */}\r\n        <div className=\"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n          <div className=\"flex items-center gap-3 mb-3\">\r\n            <Calendar className=\"w-5 h-5 text-primary-600\" />\r\n            <div>\r\n              <h4 className=\"font-semibold text-gray-900 dark:text-white\">\r\n                {visit.nom}\r\n              </h4>\r\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                {new Date(visit.visitDate).toLocaleDateString('fr-FR', {\r\n                  weekday: 'long',\r\n                  day: 'numeric',\r\n                  month: 'long',\r\n                  year: 'numeric'\r\n                })} √† {visit.visitTime}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div className=\"grid grid-cols-2 gap-2 text-sm\">\r\n            <div>\r\n              <span className=\"text-gray-500 dark:text-gray-400\">Discours :</span>\r\n              <span className=\"ml-2 text-gray-900 dark:text-white\">{visit.talkNoOrType}</span>\r\n            </div>\r\n            <div>\r\n              <span className=\"text-gray-500 dark:text-gray-400\">H√¥te :</span>\r\n              <span className=\"ml-2 text-gray-900 dark:text-white\">{visit.host}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Raison de l'annulation */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n            Raison de l'annulation *\r\n          </label>\r\n          <div className=\"grid grid-cols-2 gap-3\">\r\n            {CANCELLATION_REASONS.map((reason) => (\r\n              <button\r\n                key={reason.value}\r\n                onClick={() => setSelectedReason(reason.value)}\r\n                className={`p-3 rounded-lg border-2 text-left transition-all ${\r\n                  selectedReason === reason.value\r\n                    ? 'border-primary-500 bg-primary-50 dark:bg-primary-900/20'\r\n                    : 'border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-2xl\">{reason.icon}</span>\r\n                  <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                    {reason.label}\r\n                  </span>\r\n                </div>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Raison personnalis√©e */}\r\n        {selectedReason === 'other' && (\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n              Pr√©cisez la raison\r\n            </label>\r\n            <textarea\r\n              value={customReason}\r\n              onChange={(e) => setCustomReason(e.target.value)}\r\n              className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n              rows={3}\r\n              placeholder=\"D√©crivez la raison de l'annulation...\"\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {/* Options de notification */}\r\n        <div className=\"space-y-3\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n            Notifications\r\n          </h4>\r\n          <label className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={notifySpeaker}\r\n              onChange={(e) => setNotifySpeaker(e.target.checked)}\r\n              className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n            />\r\n            <div className=\"flex-1\">\r\n              <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                Notifier l'orateur\r\n              </span>\r\n              <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                Envoyer un message d'annulation √† {visit.nom}\r\n              </p>\r\n            </div>\r\n          </label>\r\n          <label className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={notifyHost}\r\n              onChange={(e) => setNotifyHost(e.target.checked)}\r\n              className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n            />\r\n            <div className=\"flex-1\">\r\n              <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                Notifier l'h√¥te\r\n              </span>\r\n              <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                Envoyer un message d'annulation √† {visit.host}\r\n              </p>\r\n            </div>\r\n          </label>\r\n        </div>\r\n\r\n        {/* Proposition de reprogrammation */}\r\n        <div className=\"space-y-3\">\r\n          <label className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={proposeReschedule}\r\n              onChange={(e) => setProposeReschedule(e.target.checked)}\r\n              className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n            />\r\n            <div className=\"flex-1\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <RotateCcw className=\"w-4 h-4 text-primary-600\" />\r\n                <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                  Proposer une reprogrammation\r\n                </span>\r\n              </div>\r\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n                Sugg√©rer une nouvelle date dans le message d'annulation\r\n              </p>\r\n            </div>\r\n          </label>\r\n\r\n          {proposeReschedule && (\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Nouvelle date propos√©e\r\n              </label>\r\n              <input\r\n                type=\"date\"\r\n                value={suggestedNewDate}\r\n                onChange={(e) => setSuggestedNewDate(e.target.value)}\r\n                min={new Date().toISOString().split('T')[0]}\r\n                aria-label=\"Nouvelle date propos√©e\"\r\n                className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Notes internes */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            Notes internes (optionnel)\r\n          </label>\r\n          <textarea\r\n            value={internalNotes}\r\n            onChange={(e) => setInternalNotes(e.target.value)}\r\n            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n            rows={2}\r\n            placeholder=\"Notes pour l'√©quipe (non envoy√©es aux participants)...\"\r\n          />\r\n        </div>\r\n\r\n        {/* Pr√©visualisation du message */}\r\n        {(notifySpeaker || notifyHost) && selectedReason && (\r\n          <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <MessageSquare className=\"w-4 h-4 text-blue-600\" />\r\n              <span className=\"text-sm font-medium text-blue-900 dark:text-blue-200\">\r\n                Aper√ßu du message\r\n              </span>\r\n            </div>\r\n            <pre className=\"text-xs text-blue-800 dark:text-blue-300 whitespace-pre-wrap font-sans\">\r\n              {getNotificationPreview()}\r\n            </pre>\r\n          </div>\r\n        )}\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n          <Button variant=\"secondary\" onClick={onClose}>\r\n            Annuler\r\n          </Button>\r\n          <Button \r\n            variant=\"danger\" \r\n            onClick={() => setShowConfirmation(true)}\r\n            disabled={!selectedReason || (selectedReason === 'other' && !customReason)}\r\n          >\r\n            <XCircle className=\"w-4 h-4 mr-2\" />\r\n            Annuler la visite\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React, { useState, useMemo } from 'react';\r\nimport { AlertCircle, User, Phone, MapPin, Calendar, Send, Search, Filter } from 'lucide-react';\r\nimport { Modal } from '@/components/ui/Modal';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Card, CardBody } from '@/components/ui/Card';\r\nimport { Visit, Speaker } from '@/types';\r\nimport { useData } from '@/contexts/DataContext';\r\n\r\ninterface EmergencyReplacementModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  visit: Visit;\r\n  onSelectReplacement: (speaker: Speaker, sendNotification: boolean) => void;\r\n}\r\n\r\ninterface SpeakerMatch {\r\n  speaker: Speaker;\r\n  score: number;\r\n  reasons: string[];\r\n  availableTalks: string[];\r\n  distance?: number;\r\n  lastVisit?: string;\r\n}\r\n\r\nexport const EmergencyReplacementModal: React.FC<EmergencyReplacementModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  visit,\r\n  onSelectReplacement\r\n}) => {\r\n  const { speakers, visits } = useData();\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filterByDistance, setFilterByDistance] = useState(false);\r\n  const [filterByAvailability, setFilterByAvailability] = useState(true);\r\n  const [selectedSpeaker, setSelectedSpeaker] = useState<Speaker | null>(null);\r\n  const [sendNotification, setSendNotification] = useState(true);\r\n  const [showFilters, setShowFilters] = useState(false);\r\n\r\n  // Algorithme de matching intelligent\r\n  const matchedSpeakers = useMemo(() => {\r\n    const matches: SpeakerMatch[] = [];\r\n\r\n    speakers.forEach(speaker => {\r\n      // Ne pas sugg√©rer l'orateur original\r\n      if (speaker.id === visit.id) return;\r\n\r\n      let score = 0;\r\n      const reasons: string[] = [];\r\n      const availableTalks: string[] = [];\r\n\r\n      // 1. V√©rifier les discours disponibles\r\n      const speakerTalks = speaker.talkHistory.map(t => t.talkNo.toString());\r\n      if (visit.talkNoOrType && speakerTalks.includes(visit.talkNoOrType)) {\r\n        score += 50;\r\n        reasons.push('Poss√®de le m√™me discours');\r\n        availableTalks.push(visit.talkNoOrType);\r\n      } else {\r\n        // Ajouter tous les discours disponibles\r\n        speakerTalks.forEach(talk => availableTalks.push(talk));\r\n      }\r\n\r\n      // 2. V√©rifier la disponibilit√© (pas de visite le m√™me jour)\r\n      const hasConflict = visits.some(v => \r\n        v.id === speaker.id && \r\n        v.visitDate === visit.visitDate &&\r\n        v.status !== 'cancelled'\r\n      );\r\n\r\n      if (!hasConflict) {\r\n        score += 30;\r\n        reasons.push('Disponible √† cette date');\r\n      } else {\r\n        if (filterByAvailability) return; // Exclure si filtre activ√©\r\n        reasons.push('‚ö†Ô∏è D√©j√† programm√© ce jour');\r\n      }\r\n\r\n      // 3. V√©rifier la proximit√© g√©ographique\r\n      if (speaker.congregation === visit.congregation) {\r\n        score += 20;\r\n        reasons.push('M√™me congr√©gation');\r\n      }\r\n\r\n      // 4. V√©rifier l'historique r√©cent\r\n      const recentVisits = visits.filter(v => \r\n        v.id === speaker.id &&\r\n        v.status === 'completed' &&\r\n        new Date(v.visitDate) > new Date(Date.now() - 90 * 24 * 60 * 60 * 1000)\r\n      );\r\n\r\n      if (recentVisits.length === 0) {\r\n        score += 15;\r\n        reasons.push('Pas de visite r√©cente');\r\n      }\r\n\r\n      // 5. V√©rifier si v√©hicul√©\r\n      if (speaker.isVehiculed) {\r\n        score += 10;\r\n        reasons.push('V√©hicul√©');\r\n      }\r\n\r\n      // 6. V√©rifier les contacts disponibles\r\n      if (speaker.telephone) {\r\n        score += 5;\r\n        reasons.push('T√©l√©phone disponible');\r\n      }\r\n\r\n      // Calculer la derni√®re visite\r\n      const lastVisit = visits\r\n        .filter(v => v.id === speaker.id && v.status === 'completed')\r\n        .sort((a, b) => new Date(b.visitDate).getTime() - new Date(a.visitDate).getTime())[0];\r\n\r\n      matches.push({\r\n        speaker,\r\n        score,\r\n        reasons,\r\n        availableTalks,\r\n        lastVisit: lastVisit?.visitDate\r\n      });\r\n    });\r\n\r\n    // Trier par score d√©croissant\r\n    return matches\r\n      .sort((a, b) => b.score - a.score)\r\n      .filter(m => {\r\n        if (searchTerm) {\r\n          return m.speaker.nom.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                 m.speaker.congregation.toLowerCase().includes(searchTerm.toLowerCase());\r\n        }\r\n        return true;\r\n      });\r\n  }, [speakers, visits, visit, searchTerm, filterByAvailability]);\r\n\r\n  const handleSelectSpeaker = () => {\r\n    if (selectedSpeaker) {\r\n      onSelectReplacement(selectedSpeaker, sendNotification);\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const getScoreColor = (score: number) => {\r\n    if (score >= 80) return 'text-green-600 bg-green-100 dark:bg-green-900/20';\r\n    if (score >= 50) return 'text-blue-600 bg-blue-100 dark:bg-blue-900/20';\r\n    if (score >= 30) return 'text-orange-600 bg-orange-100 dark:bg-orange-900/20';\r\n    return 'text-gray-600 bg-gray-100 dark:bg-gray-900/20';\r\n  };\r\n\r\n  const getScoreLabel = (score: number) => {\r\n    if (score >= 80) return 'Excellent match';\r\n    if (score >= 50) return 'Bon match';\r\n    if (score >= 30) return 'Match acceptable';\r\n    return 'Match faible';\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Trouver un rempla√ßant d'urgence\"\r\n      size=\"xl\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {/* Alerte urgence */}\r\n        <div className=\"flex items-start gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg\">\r\n          <AlertCircle className=\"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5\" />\r\n          <div>\r\n            <h4 className=\"font-semibold text-red-900 dark:text-red-200\">\r\n              Remplacement d'urgence requis\r\n            </h4>\r\n            <p className=\"text-sm text-red-800 dark:text-red-300 mt-1\">\r\n              Visite de <strong>{visit.nom}</strong> le{' '}\r\n              <strong>{new Date(visit.visitDate).toLocaleDateString('fr-FR')}</strong> √†{' '}\r\n              <strong>{visit.visitTime}</strong>\r\n            </p>\r\n            {visit.talkNoOrType && (\r\n              <p className=\"text-sm text-red-800 dark:text-red-300\">\r\n                Discours : <strong>{visit.talkNoOrType}</strong> - {visit.talkTheme}\r\n              </p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Barre de recherche et filtres */}\r\n        <div className=\"space-y-3\">\r\n          <div className=\"flex gap-3\">\r\n            <div className=\"flex-1 relative\">\r\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\r\n              <input\r\n                type=\"text\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                placeholder=\"Rechercher un orateur...\"\r\n                className=\"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n              />\r\n            </div>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setShowFilters(!showFilters)}\r\n            >\r\n              <Filter className=\"w-4 h-4 mr-2\" />\r\n              Filtres\r\n            </Button>\r\n          </div>\r\n\r\n          {showFilters && (\r\n            <div className=\"flex gap-3 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n              <label className=\"flex items-center gap-2 cursor-pointer\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={filterByAvailability}\r\n                  onChange={(e) => setFilterByAvailability(e.target.checked)}\r\n                  className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n                />\r\n                <span className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n                  Uniquement disponibles\r\n                </span>\r\n              </label>\r\n              <label className=\"flex items-center gap-2 cursor-pointer\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={filterByDistance}\r\n                  onChange={(e) => setFilterByDistance(e.target.checked)}\r\n                  className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n                />\r\n                <span className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n                  Proximit√© g√©ographique\r\n                </span>\r\n              </label>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Statistiques */}\r\n        <div className=\"grid grid-cols-3 gap-4\">\r\n          <div className=\"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-blue-600\">{matchedSpeakers.length}</div>\r\n            <div className=\"text-sm text-blue-800 dark:text-blue-300\">Orateurs trouv√©s</div>\r\n          </div>\r\n          <div className=\"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              {matchedSpeakers.filter(m => m.score >= 50).length}\r\n            </div>\r\n            <div className=\"text-sm text-green-800 dark:text-green-300\">Bons matchs</div>\r\n          </div>\r\n          <div className=\"p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg\">\r\n            <div className=\"text-2xl font-bold text-purple-600\">\r\n              {matchedSpeakers.filter(m => m.availableTalks.includes(visit.talkNoOrType || '')).length}\r\n            </div>\r\n            <div className=\"text-sm text-purple-800 dark:text-purple-300\">M√™me discours</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Liste des orateurs */}\r\n        <div className=\"space-y-3 max-h-96 overflow-y-auto\">\r\n          {matchedSpeakers.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <AlertCircle className=\"w-16 h-16 mx-auto mb-4 text-gray-400\" />\r\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\r\n                Aucun orateur trouv√©\r\n              </h3>\r\n              <p className=\"text-gray-600 dark:text-gray-400\">\r\n                Essayez de modifier vos crit√®res de recherche\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            matchedSpeakers.map((match) => (\r\n              <Card\r\n                key={match.speaker.id}\r\n                hoverable\r\n                className={`cursor-pointer transition-all ${\r\n                  selectedSpeaker?.id === match.speaker.id\r\n                    ? 'ring-2 ring-primary-500 bg-primary-50 dark:bg-primary-900/20'\r\n                    : ''\r\n                }`}\r\n                onClick={() => setSelectedSpeaker(match.speaker)}\r\n              >\r\n                <CardBody>\r\n                  <div className=\"flex items-start justify-between gap-4\">\r\n                    {/* Informations orateur */}\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center gap-3 mb-2\">\r\n                        <div className=\"w-12 h-12 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center text-primary-700 dark:text-primary-300 font-bold text-lg\">\r\n                          {match.speaker.nom.charAt(0).toUpperCase()}\r\n                        </div>\r\n                        <div>\r\n                          <h4 className=\"font-semibold text-gray-900 dark:text-white\">\r\n                            {match.speaker.nom}\r\n                          </h4>\r\n                          <div className=\"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400\">\r\n                            <MapPin className=\"w-3 h-3\" />\r\n                            {match.speaker.congregation}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Raisons du match */}\r\n                      <div className=\"flex flex-wrap gap-2 mb-3\">\r\n                        {match.reasons.map((reason, idx) => (\r\n                          <Badge key={idx} variant=\"default\" className=\"text-xs\">\r\n                            {reason}\r\n                          </Badge>\r\n                        ))}\r\n                      </div>\r\n\r\n                      {/* Discours disponibles */}\r\n                      {match.availableTalks.length > 0 && (\r\n                        <div className=\"text-sm\">\r\n                          <span className=\"text-gray-600 dark:text-gray-400\">Discours : </span>\r\n                          <span className=\"text-gray-900 dark:text-white\">\r\n                            {match.availableTalks.slice(0, 5).join(', ')}\r\n                            {match.availableTalks.length > 5 && ` +${match.availableTalks.length - 5}`}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n\r\n                      {/* Contact */}\r\n                      {match.speaker.telephone && (\r\n                        <div className=\"flex items-center gap-2 mt-2 text-sm text-gray-600 dark:text-gray-400\">\r\n                          <Phone className=\"w-3 h-3\" />\r\n                          {match.speaker.telephone}\r\n                        </div>\r\n                      )}\r\n\r\n                      {/* Derni√®re visite */}\r\n                      {match.lastVisit && (\r\n                        <div className=\"flex items-center gap-2 mt-1 text-xs text-gray-500 dark:text-gray-500\">\r\n                          <Calendar className=\"w-3 h-3\" />\r\n                          Derni√®re visite : {new Date(match.lastVisit).toLocaleDateString('fr-FR')}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Score */}\r\n                    <div className=\"text-right\">\r\n                      <div className={`inline-flex items-center gap-2 px-3 py-1 rounded-full ${getScoreColor(match.score)}`}>\r\n                        <span className=\"text-lg font-bold\">{match.score}</span>\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-600 dark:text-gray-400 mt-1\">\r\n                        {getScoreLabel(match.score)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </CardBody>\r\n              </Card>\r\n            ))\r\n          )}\r\n        </div>\r\n\r\n        {/* Option de notification */}\r\n        {selectedSpeaker && (\r\n          <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\r\n            <label className=\"flex items-start gap-3 cursor-pointer\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={sendNotification}\r\n                onChange={(e) => setSendNotification(e.target.checked)}\r\n                className=\"mt-1 w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500\"\r\n              />\r\n              <div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Send className=\"w-4 h-4 text-blue-600\" />\r\n                  <span className=\"font-medium text-blue-900 dark:text-blue-200\">\r\n                    Envoyer une notification imm√©diate\r\n                  </span>\r\n                </div>\r\n                <p className=\"text-sm text-blue-800 dark:text-blue-300 mt-1\">\r\n                  Un message sera envoy√© √† {selectedSpeaker.nom} pour l'informer du remplacement d'urgence\r\n                </p>\r\n              </div>\r\n            </label>\r\n          </div>\r\n        )}\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n          <Button variant=\"secondary\" onClick={onClose}>\r\n            Annuler\r\n          </Button>\r\n          <Button\r\n            variant=\"primary\"\r\n            onClick={handleSelectSpeaker}\r\n            disabled={!selectedSpeaker}\r\n          >\r\n            <User className=\"w-4 h-4 mr-2\" />\r\n            S√©lectionner ce rempla√ßant\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React, { useState, useRef } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { Calendar, MapPin, User, Clock, MoreVertical, Edit2, Trash2, MessageSquare, CheckCircle, Star, CreditCard, Truck } from 'lucide-react';\r\nimport { Visit } from '@/types';\r\nimport { Card, CardBody } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { CommunicationProgress } from '@/components/messages/CommunicationProgress';\r\nimport { format } from 'date-fns';\r\nimport { fr } from 'date-fns/locale';\r\n\r\ninterface VisitCardProps {\r\n  visit: Visit;\r\n  onClick?: () => void;\r\n  onAction?: (visit: Visit, action: 'edit' | 'delete' | 'status' | 'message' | 'feedback' | 'expenses' | 'logistics') => void;\r\n}\r\n\r\nexport const VisitCard: React.FC<VisitCardProps> = ({ visit, onClick, onAction }) => {\r\n  const [showMenu, setShowMenu] = useState(false);\r\n  const buttonRef = useRef<HTMLButtonElement>(null);\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    switch (status) {\r\n      case 'confirmed':\r\n        return <Badge variant=\"success\" size=\"sm\">Confirm√©</Badge>;\r\n      case 'pending':\r\n        return <Badge variant=\"warning\" size=\"sm\">En attente</Badge>;\r\n      case 'completed':\r\n        return <Badge variant=\"default\" size=\"sm\">Termin√©</Badge>;\r\n      case 'cancelled':\r\n        return <Badge variant=\"danger\" size=\"sm\">Annul√©</Badge>;\r\n      default:\r\n        return <Badge variant=\"default\" size=\"sm\">{status}</Badge>;\r\n    }\r\n  };\r\n\r\n  const handleActionClick = (action: 'edit' | 'delete' | 'status' | 'message' | 'feedback' | 'expenses', e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    if (onAction) {\r\n      onAction(visit, action);\r\n    }\r\n    setShowMenu(false);\r\n  };\r\n\r\n  const actionOptions = [\r\n    { action: 'edit', label: 'Modifier', icon: Edit2, color: 'text-blue-600' },\r\n    { action: 'message', label: 'Envoyer un message', icon: MessageSquare, color: 'text-green-600' },\r\n    { action: 'expenses', label: 'D√©penses', icon: CreditCard, color: 'text-purple-600' },\r\n    { action: 'logistics', label: 'Logistique', icon: Truck, color: 'text-blue-500' },\r\n    { action: 'status', label: 'Changer le statut', icon: CheckCircle, color: 'text-orange-600' },\r\n    { action: 'feedback', label: 'Bilan', icon: Star, color: 'text-yellow-500' },\r\n    { action: 'delete', label: 'Supprimer', icon: Trash2, color: 'text-red-600' },\r\n  ];\r\n\r\n  return (\r\n    <Card hoverable className=\"h-full relative overflow-visible\" onClick={onClick}>\r\n      <CardBody className=\"p-4 flex flex-col h-full\">\r\n        <div className=\"flex justify-between items-start mb-3\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <div className=\"w-8 h-8 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center text-primary-700 dark:text-primary-300 font-bold text-sm\">\r\n              {visit.nom.charAt(0)}\r\n            </div>\r\n            <div>\r\n              <h4 className=\"font-semibold text-gray-900 dark:text-white text-sm line-clamp-1\">\r\n                {visit.nom}\r\n              </h4>\r\n              <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                {visit.congregation}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          {getStatusBadge(visit.status)}\r\n        </div>\r\n\r\n        <div className=\"space-y-2 mb-4 flex-1\">\r\n          <div className=\"flex items-center text-sm text-gray-600 dark:text-gray-300\">\r\n            <Calendar className=\"w-4 h-4 mr-2 text-gray-400\" />\r\n            <span className=\"capitalize\">\r\n              {format(new Date(visit.visitDate), 'EEEE d MMMM yyyy', { locale: fr })}\r\n            </span>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center text-sm text-gray-600 dark:text-gray-300\">\r\n            <Clock className=\"w-4 h-4 mr-2 text-gray-400\" />\r\n            <span>{visit.visitTime}</span>\r\n          </div>\r\n\r\n          <div className=\"flex items-center text-sm text-gray-600 dark:text-gray-300\">\r\n            <MapPin className=\"w-4 h-4 mr-2 text-gray-400\" />\r\n            <span className=\"line-clamp-1\">\r\n              {visit.locationType === 'physical' ? 'Salle du Royaume' : 'Visioconf√©rence'}\r\n            </span>\r\n          </div>\r\n\r\n          {visit.host && (\r\n            <div className=\"flex items-center text-sm text-gray-600 dark:text-gray-300\">\r\n              <User className=\"w-4 h-4 mr-2 text-gray-400\" />\r\n              <span className=\"line-clamp-1\">Chez {visit.host}</span>\r\n            </div>\r\n          )}\r\n\r\n          {/* Logistics Indicator */}\r\n          {visit.logistics?.checklist && visit.logistics.checklist.some(item => !item.isCompleted) && (\r\n            <div className=\"flex items-center text-xs text-orange-600 dark:text-orange-400 mt-1\">\r\n              <Truck className=\"w-3 h-3 mr-2\" />\r\n              <span>Logistique √† compl√©ter</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Barre de progression communication */}\r\n        <div className=\"pt-3 mt-3 border-t border-gray-100 dark:border-gray-700\">\r\n          <CommunicationProgress visit={visit} size=\"sm\" />\r\n        </div>\r\n\r\n        <div className=\"pt-3 border-t border-gray-100 dark:border-gray-700\">\r\n          <div className=\"flex justify-between items-start mb-2\">\r\n            <div className=\"flex-1 min-w-0\">\r\n              <div className=\"text-xs font-medium text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20 px-2 py-1 rounded inline-block mb-1\">\r\n                Discours n¬∞{visit.talkNoOrType}\r\n              </div>\r\n              {visit.talkTheme && (\r\n                <p className=\"text-xs text-gray-600 dark:text-gray-400 line-clamp-2 mt-1\">\r\n                  {visit.talkTheme}\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"relative\">\r\n            <button\r\n              ref={buttonRef}\r\n              aria-label=\"Options\"\r\n              className=\"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700\"\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                setShowMenu(!showMenu);\r\n              }}\r\n            >\r\n              <MoreVertical className=\"w-4 h-4\" />\r\n            </button>\r\n\r\n            {showMenu && createPortal(\r\n              <>\r\n                <div \r\n                  className=\"fixed inset-0 z-50 bg-black/20 backdrop-blur-sm\"\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    setShowMenu(false);\r\n                  }}\r\n                />\r\n                <div \r\n                  className=\"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-2xl z-50 w-72 overflow-hidden animate-in fade-in zoom-in-95 duration-200\"\r\n                >\r\n                  <div className=\"p-2\">\r\n                    {actionOptions.map((option) => (\r\n                      <button\r\n                        key={option.action}\r\n                        className=\"w-full px-4 py-3 text-left text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg flex items-center gap-3 transition-colors mb-1 last:mb-0\"\r\n                        onClick={(e) => handleActionClick(option.action as any, e)}\r\n                      >\r\n                        <div className={`p-2 rounded-full bg-opacity-10 ${option.color.replace('text-', 'bg-')}`}>\r\n                           <option.icon className={`w-5 h-5 ${option.color}`} />\r\n                        </div>\r\n                        {option.label}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </>,\r\n              document.body\r\n            )}\r\n          </div>\r\n        </div>\r\n      </CardBody>\r\n\r\n      {/* Overlay to close menu when clicking outside */}\r\n\r\n    </Card>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { Visit } from '@/types';\r\nimport { VisitCard } from './VisitCard';\r\n\r\ninterface PlanningCardsViewProps {\r\n  visits: Visit[];\r\n  onVisitClick?: (visit: Visit) => void;\r\n  onVisitAction?: (visit: Visit, action: 'edit' | 'delete' | 'status' | 'message' | 'feedback' | 'expenses' | 'logistics') => void;\r\n}\r\n\r\nexport const PlanningCardsView: React.FC<PlanningCardsViewProps> = ({ visits, onVisitClick, onVisitAction }) => {\r\n  if (visits.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <p className=\"text-gray-500 dark:text-gray-400\">Aucune visite trouv√©e pour cette p√©riode.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n      {visits.map((visit, index) => (\r\n        <VisitCard \r\n          key={`${visit.id}-${index}`} \r\n          visit={visit} \r\n          onClick={() => onVisitClick?.(visit)}\r\n          onAction={onVisitAction}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { Visit } from '@/types';\r\nimport { format } from 'date-fns';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Edit, Trash2, MessageSquare } from 'lucide-react';\r\n\r\ninterface PlanningListViewProps {\r\n  visits: Visit[];\r\n  onVisitClick?: (visit: Visit) => void;\r\n  onVisitAction?: (visit: Visit, action: 'edit' | 'delete' | 'status' | 'message' | 'feedback' | 'expenses' | 'logistics') => void;\r\n}\r\n\r\nexport const PlanningListView: React.FC<PlanningListViewProps> = ({ visits, onVisitClick, onVisitAction }) => {\r\n  const getStatusBadge = (status: string) => {\r\n    switch (status) {\r\n      case 'confirmed':\r\n        return <Badge variant=\"success\" size=\"sm\">Confirm√©</Badge>;\r\n      case 'pending':\r\n        return <Badge variant=\"warning\" size=\"sm\">En attente</Badge>;\r\n      case 'completed':\r\n        return <Badge variant=\"default\" size=\"sm\">Termin√©</Badge>;\r\n      case 'cancelled':\r\n        return <Badge variant=\"danger\" size=\"sm\">Annul√©</Badge>;\r\n      default:\r\n        return <Badge variant=\"default\" size=\"sm\">{status}</Badge>;\r\n    }\r\n  };\r\n\r\n  if (visits.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-12 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700\">\r\n        <p className=\"text-gray-500 dark:text-gray-400\">Aucune visite trouv√©e pour cette p√©riode.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\">\r\n      <div className=\"overflow-x-auto\">\r\n        <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\r\n          <thead className=\"bg-gray-50 dark:bg-gray-900/50\">\r\n            <tr>\r\n              <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                Date\r\n              </th>\r\n              <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                Orateur\r\n              </th>\r\n              <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                Discours\r\n              </th>\r\n              <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                Lieu / H√¥te\r\n              </th>\r\n              <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                Statut\r\n              </th>\r\n              <th scope=\"col\" className=\"relative px-6 py-3\">\r\n                <span className=\"sr-only\">Actions</span>\r\n              </th>\r\n            </tr>\r\n          </thead>\r\n          <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\r\n            {visits.map((visit) => (\r\n              <tr \r\n                key={visit.id} \r\n                className=\"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors cursor-pointer\"\r\n                onClick={() => onVisitClick?.(visit)}\r\n              >\r\n                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                  <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                    {format(new Date(visit.visitDate), 'dd/MM/yyyy')}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                    {visit.visitTime}\r\n                  </div>\r\n                </td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                  <div className=\"flex items-center\">\r\n                    <div className=\"flex-shrink-0 h-8 w-8 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center text-primary-700 dark:text-primary-300 font-bold text-xs mr-3\">\r\n                      {visit.nom.charAt(0)}\r\n                    </div>\r\n                    <div>\r\n                      <div className=\"text-sm font-medium text-gray-900 dark:text-white\">{visit.nom}</div>\r\n                      <div className=\"text-sm text-gray-500 dark:text-gray-400\">{visit.congregation}</div>\r\n                    </div>\r\n                  </div>\r\n                </td>\r\n                <td className=\"px-6 py-4\">\r\n                  <div className=\"text-sm text-gray-900 dark:text-white\">N¬∞{visit.talkNoOrType}</div>\r\n                  <div className=\"text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs\">{visit.talkTheme}</div>\r\n                </td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                  <div className=\"text-sm text-gray-900 dark:text-white\">\r\n                    {visit.locationType === 'physical' ? 'Salle du Royaume' : 'Visioconf√©rence'}\r\n                  </div>\r\n                  {visit.host && (\r\n                    <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                      Chez {visit.host}\r\n                    </div>\r\n                  )}\r\n                </td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                  {getStatusBadge(visit.status)}\r\n                </td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\r\n                  <div className=\"flex items-center justify-end gap-2\">\r\n                    <button \r\n                      className=\"text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 p-1\"\r\n                      onClick={(e) => { e.stopPropagation(); onVisitAction?.(visit, 'edit'); }}\r\n                      title=\"Modifier\"\r\n                    >\r\n                      <Edit className=\"w-4 h-4\" />\r\n                    </button>\r\n                    <button \r\n                      className=\"text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 p-1\"\r\n                      onClick={(e) => { e.stopPropagation(); onVisitAction?.(visit, 'message'); }}\r\n                      title=\"Message\"\r\n                    >\r\n                      <MessageSquare className=\"w-4 h-4\" />\r\n                    </button>\r\n                    <button \r\n                      className=\"text-gray-400 hover:text-red-600 dark:hover:text-red-400 p-1\"\r\n                      onClick={(e) => { e.stopPropagation(); onVisitAction?.(visit, 'delete'); }}\r\n                      title=\"Supprimer\"\r\n                    >\r\n                      <Trash2 className=\"w-4 h-4\" />\r\n                    </button>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from 'react';\r\nimport { Visit } from '@/types';\r\nimport { \r\n  format, \r\n  startOfMonth, \r\n  endOfMonth, \r\n  startOfWeek, \r\n  endOfWeek, \r\n  eachDayOfInterval, \r\n  isSameMonth, \r\n  isSameDay, \r\n  addMonths, \r\n  subMonths,\r\n  isToday\r\n} from 'date-fns';\r\nimport { fr } from 'date-fns/locale';\r\nimport { ChevronLeft, ChevronRight } from 'lucide-react';\r\n\r\ninterface PlanningCalendarViewProps {\r\n  visits: Visit[];\r\n  onVisitClick?: (visit: Visit) => void;\r\n}\r\n\r\nexport const PlanningCalendarView: React.FC<PlanningCalendarViewProps> = ({ visits, onVisitClick }) => {\r\n  const [currentDate, setCurrentDate] = useState(new Date());\r\n\r\n  const nextMonth = () => setCurrentDate(addMonths(currentDate, 1));\r\n  const prevMonth = () => setCurrentDate(subMonths(currentDate, 1));\r\n  const today = () => setCurrentDate(new Date());\r\n\r\n  const monthStart = startOfMonth(currentDate);\r\n  const monthEnd = endOfMonth(monthStart);\r\n  const startDate = startOfWeek(monthStart, { locale: fr });\r\n  const endDate = endOfWeek(monthEnd, { locale: fr });\r\n\r\n  const calendarDays = eachDayOfInterval({\r\n    start: startDate,\r\n    end: endDate,\r\n  });\r\n\r\n  const weekDays = ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'];\r\n\r\n  const getVisitsForDay = (date: Date) => visits.filter(visit => isSameDay(new Date(visit.visitDate), date));\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\">\r\n      {/* Calendar Header */}\r\n      <div className=\"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white capitalize\">\r\n          {format(currentDate, 'MMMM yyyy', { locale: fr })}\r\n        </h3>\r\n        <div className=\"flex items-center gap-2\">\r\n          <button\r\n            onClick={prevMonth}\r\n            aria-label=\"Mois pr√©c√©dent\"\r\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full text-gray-600 dark:text-gray-400\"\r\n          >\r\n            <ChevronLeft className=\"w-5 h-5\" />\r\n          </button>\r\n          <button \r\n            onClick={today}\r\n            className=\"px-3 py-1 text-sm font-medium text-primary-600 hover:bg-primary-50 dark:text-primary-400 dark:hover:bg-primary-900/20 rounded-md\"\r\n          >\r\n            Aujourd'hui\r\n          </button>\r\n          <button\r\n            onClick={nextMonth}\r\n            aria-label=\"Mois suivant\"\r\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full text-gray-600 dark:text-gray-400\"\r\n          >\r\n            <ChevronRight className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Calendar Grid */}\r\n      <div className=\"grid grid-cols-7 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50\">\r\n        {weekDays.map((day) => (\r\n          <div key={day} className=\"py-3 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n            {day}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-7 auto-rows-fr bg-gray-200 dark:bg-gray-700 gap-px\">\r\n        {calendarDays.map((day) => {\r\n          const dayVisits = getVisitsForDay(day);\r\n          const isCurrentMonth = isSameMonth(day, monthStart);\r\n          const isCurrentDay = isToday(day);\r\n\r\n          return (\r\n            <div \r\n              key={day.toString()} \r\n              className={`\r\n                min-h-[120px] bg-white dark:bg-gray-800 p-2 transition-colors\r\n                ${!isCurrentMonth ? 'bg-gray-50 dark:bg-gray-800/50 text-gray-400 dark:text-gray-600' : ''}\r\n                ${isCurrentDay ? 'bg-blue-50/30 dark:bg-blue-900/10' : ''}\r\n              `}\r\n            >\r\n              <div className=\"flex justify-between items-start mb-1\">\r\n                <span \r\n                  className={`\r\n                    text-sm font-medium w-7 h-7 flex items-center justify-center rounded-full\r\n                    ${isCurrentDay \r\n                      ? 'bg-primary-600 text-white' \r\n                      : isCurrentMonth ? 'text-gray-900 dark:text-white' : 'text-gray-400 dark:text-gray-600'\r\n                    }\r\n                  `}\r\n                >\r\n                  {format(day, 'd')}\r\n                </span>\r\n                {dayVisits.length > 0 && (\r\n                  <span className=\"text-xs font-medium text-gray-400\">\r\n                    {dayVisits.length}\r\n                  </span>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"space-y-1 mt-1\">\r\n                {dayVisits.map((visit) => (\r\n                  <button\r\n                    key={visit.id}\r\n                    onClick={() => onVisitClick?.(visit)}\r\n                    className={`\r\n                      w-full text-left px-2 py-1 rounded text-xs font-medium truncate transition-colors\r\n                      ${visit.status === 'confirmed' \r\n                        ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 hover:bg-green-200 dark:hover:bg-green-900/50' \r\n                        : visit.status === 'pending'\r\n                        ? 'bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300 hover:bg-orange-200 dark:hover:bg-orange-900/50'\r\n                        : 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\r\n                      }\r\n                    `}\r\n                  >\r\n                    {visit.visitTime} - {visit.nom}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Modal } from '@/components/ui/Modal';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Input } from '@/components/ui/Input';\r\nimport { Select } from '@/components/ui/Select';\r\nimport { useData } from '@/contexts/DataContext';\r\nimport { useToast } from '@/contexts/ToastContext';\r\nimport { Visit } from '@/types';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { AlertTriangle } from 'lucide-react';\r\n\r\ninterface ScheduleVisitModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  initialDate?: Date;\r\n}\r\n\r\nexport const ScheduleVisitModal: React.FC<ScheduleVisitModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  initialDate\r\n}) => {\r\n  const { speakers, hosts, addVisit, publicTalks, visits, congregationProfile } = useData();\r\n  const { addToast } = useToast();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [dateError, setDateError] = useState<string>('');\r\n  const [dateConflict, setDateConflict] = useState<{has: boolean; speakerName?: string}>({ has: false });\r\n\r\n  // Form state\r\n  const [formData, setFormData] = useState<Partial<Visit>>({\r\n    visitDate: initialDate ? initialDate.toISOString().split('T')[0] : '',\r\n    visitTime: congregationProfile.meetingTime || '14:30',\r\n    locationType: 'physical',\r\n    status: 'pending',\r\n    talkNoOrType: '',\r\n    talkTheme: '',\r\n    nom: '', // Speaker name\r\n    id: '', // Speaker ID\r\n    host: '',\r\n    congregation: '',\r\n  });\r\n\r\n  // Validate date when it changes\r\n  useEffect(() => {\r\n    if (formData.visitDate) {\r\n      validateDate(formData.visitDate);\r\n      checkDateConflict(formData.visitDate);\r\n    }\r\n  }, [formData.visitDate]);\r\n\r\n  const validateDate = (dateStr: string) => {\r\n    const visitDate = new Date(dateStr);\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n    \r\n    if (visitDate < today) {\r\n      setDateError('La date doit √™tre dans le futur');\r\n      return false;\r\n    }\r\n    setDateError('');\r\n    return true;\r\n  };\r\n\r\n  const checkDateConflict = (date: string) => {\r\n    const conflict = visits.find(v => v.visitDate === date);\r\n    \r\n    if (conflict) {\r\n      setDateConflict({\r\n        has: true,\r\n        speakerName: conflict.nom\r\n      });\r\n    } else {\r\n      setDateConflict({ has: false });\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    // Validate before submit\r\n    if (!validateDate(formData.visitDate || '')) {\r\n      addToast('Veuillez s√©lectionner une date valide dans le futur', 'error');\r\n      return;\r\n    }\r\n    \r\n    setIsLoading(true);\r\n\r\n    try {\r\n      if (!formData.id || !formData.visitDate) {\r\n        throw new Error('Veuillez remplir les champs obligatoires');\r\n      }\r\n\r\n      const newVisit: Visit = {\r\n        ...formData as Visit,\r\n        visitId: uuidv4(),\r\n        createdAt: new Date().toISOString(),\r\n        updatedAt: new Date().toISOString(),\r\n      };\r\n\r\n      await addVisit(newVisit);\r\n      addToast('Visite programm√©e avec succ√®s', 'success');\r\n      onClose();\r\n    } catch (error) {\r\n      addToast(error instanceof Error ? error.message : 'Erreur lors de la cr√©ation', 'error');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSpeakerChange = (speakerId: string) => {\r\n    const speaker = speakers.find(s => s.id === speakerId);\r\n    if (speaker) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        id: speaker.id,\r\n        nom: speaker.nom,\r\n        congregation: speaker.congregation\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleTalkChange = (talkNumber: string) => {\r\n    const talk = publicTalks.find(t => t.number.toString() === talkNumber);\r\n    if (talk) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        talkNoOrType: talk.number.toString(),\r\n        talkTheme: talk.theme\r\n      }));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Programmer une visite\"\r\n      size=\"lg\"\r\n      footer={\r\n        <>\r\n          <Button variant=\"ghost\" onClick={onClose} disabled={isLoading}>\r\n            Annuler\r\n          </Button>\r\n          <Button onClick={handleSubmit} isLoading={isLoading}>\r\n            Enregistrer\r\n          </Button>\r\n        </>\r\n      }\r\n    >\r\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n          {/* Orateur */}\r\n          <div className=\"col-span-2\">\r\n            <Select\r\n              label=\"Orateur\"\r\n              options={[\r\n                { value: '', label: 'S√©lectionner un orateur' },\r\n                ...speakers.map(s => ({ value: s.id, label: `${s.nom} (${s.congregation})` }))\r\n              ]}\r\n              value={formData.id}\r\n              onChange={(e) => handleSpeakerChange(e.target.value)}\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* Date et Heure */}\r\n          <Input\r\n            type=\"date\"\r\n            label=\"Date\"\r\n            value={formData.visitDate}\r\n            onChange={(e) => setFormData(prev => ({ ...prev, visitDate: e.target.value }))}\r\n            required\r\n            error={dateError}\r\n          />\r\n          \r\n          {/* Date conflict warning */}\r\n          {dateConflict.has && !dateError && (\r\n            <div className=\"col-span-2 -mt-4\">\r\n              <div className=\"flex items-start gap-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg\">\r\n                <AlertTriangle className=\"w-4 h-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0\" />\r\n                <div className=\"text-sm text-yellow-700 dark:text-yellow-300\">\r\n                  <p className=\"font-medium\">Une visite est d√©j√† programm√©e ce jour</p>\r\n                  <p className=\"text-xs mt-1\">Orateur pr√©vu : {dateConflict.speakerName}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          <Input\r\n            type=\"time\"\r\n            label=\"Heure\"\r\n            value={formData.visitTime}\r\n            onChange={(e) => setFormData(prev => ({ ...prev, visitTime: e.target.value }))}\r\n            required\r\n          />\r\n\r\n          {/* Discours */}\r\n          <div className=\"col-span-2\">\r\n            <Select\r\n              label=\"Discours (liste)\"\r\n              options={[\r\n                { value: '', label: 'S√©lectionner un discours' },\r\n                ...publicTalks.map(t => ({ value: t.number.toString(), label: `N¬∞${t.number} - ${t.theme}` }))\r\n              ]}\r\n              value={formData.talkNoOrType || ''}\r\n              onChange={(e) => handleTalkChange(e.target.value)}\r\n            />\r\n          </div>\r\n          \r\n          <Input\r\n            label=\"N¬∞ Discours (manuel)\"\r\n            value={formData.talkNoOrType || ''}\r\n            onChange={(e) => setFormData(prev => ({ ...prev, talkNoOrType: e.target.value }))}\r\n            placeholder=\"Ex: 185\"\r\n          />\r\n          \r\n          <Input\r\n            label=\"Titre du discours (manuel)\"\r\n            value={formData.talkTheme || ''}\r\n            onChange={(e) => setFormData(prev => ({ ...prev, talkTheme: e.target.value }))}\r\n            placeholder=\"Ex: Nega iluzon di mundu...\"\r\n          />\r\n\r\n          {/* Lieu et H√¥te */}\r\n          <Select\r\n            label=\"Type de lieu\"\r\n            options={[\r\n              { value: 'physical', label: 'Salle du Royaume' },\r\n              { value: 'zoom', label: 'Visioconf√©rence' },\r\n              { value: 'streaming', label: 'Streaming' }\r\n            ]}\r\n            value={formData.locationType}\r\n            onChange={(e) => setFormData(prev => ({ ...prev, locationType: e.target.value as any }))}\r\n          />\r\n\r\n          <Select\r\n            label=\"Contact d'accueil\"\r\n            options={[\r\n              { value: '', label: 'Aucun' },\r\n              ...hosts.map(h => ({ value: h.nom, label: h.nom }))\r\n            ]}\r\n            value={formData.host || ''}\r\n            onChange={(e) => setFormData(prev => ({ ...prev, host: e.target.value }))}\r\n          />\r\n        </div>\r\n      </form>\r\n    </Modal>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { useData } from '@/contexts/DataContext';\r\nimport { calculateWorkload } from '@/utils/workload';\r\nimport { WorkloadIndicator } from '@/components/workload/WorkloadIndicator';\r\nimport { Card, CardBody } from '@/components/ui/Card';\r\nimport { Search } from 'lucide-react';\r\nimport { Input } from '@/components/ui/Input';\r\n\r\nexport const PlanningWorkloadView: React.FC = () => {\r\n  const { speakers, visits } = useData();\r\n  const [searchTerm, setSearchTerm] = React.useState('');\r\n\r\n  const workloadData = React.useMemo(() => \r\n     speakers.map(speaker => ({\r\n      speaker,\r\n      workload: calculateWorkload(speaker, visits)\r\n    })).sort((a, b) => b.workload.currentLoad - a.workload.currentLoad) // Tri par charge d√©croissante\r\n  , [speakers, visits]);\r\n\r\n  const filteredData = workloadData.filter(({ speaker }) =>\r\n    speaker.nom.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    speaker.congregation.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex justify-between items-center bg-white dark:bg-gray-800 p-4 rounded-xl border border-gray-200 dark:border-gray-700\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n          Analyse de la Charge et Disponibilit√©\r\n        </h3>\r\n        <div className=\"w-64\">\r\n          <Input\r\n            placeholder=\"Rechercher un orateur...\"\r\n            leftIcon={<Search className=\"w-4 h-4\" />}\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n        {filteredData.map(({ speaker, workload }) => (\r\n          <Card key={speaker.id} className=\"overflow-hidden\">\r\n            <CardBody className=\"p-4\">\r\n              <div className=\"flex justify-between items-start mb-3\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <div className=\"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-gray-600 dark:text-gray-300 font-bold\">\r\n                    {speaker.nom.charAt(0)}\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"font-semibold text-gray-900 dark:text-white\">{speaker.nom}</h4>\r\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400\">{speaker.congregation}</p>\r\n                  </div>\r\n                </div>\r\n                <WorkloadIndicator workload={workload} />\r\n              </div>\r\n\r\n              <div className=\"mt-4 space-y-3\">\r\n                <div>\r\n                  <div className=\"flex justify-between text-xs mb-1\">\r\n                    <span className=\"text-gray-500\">Charge actuelle</span>\r\n                    <span className=\"font-medium text-gray-900 dark:text-white\">{workload.currentLoad}%</span>\r\n                  </div>\r\n                  <progress\r\n                    value={workload.currentLoad}\r\n                    max={100}\r\n                    className={`w-full h-2 rounded-full ${\r\n                      workload.workloadScore >= 5 ? '[&::-webkit-progress-value]:bg-red-500 [&::-moz-progress-bar]:bg-red-500' :\r\n                      workload.workloadScore >= 4 ? '[&::-webkit-progress-value]:bg-orange-500 [&::-moz-progress-bar]:bg-orange-500' :\r\n                      workload.workloadScore >= 3 ? '[&::-webkit-progress-value]:bg-yellow-500 [&::-moz-progress-bar]:bg-yellow-500' :\r\n                      '[&::-webkit-progress-value]:bg-green-500 [&::-moz-progress-bar]:bg-green-500'\r\n                    } [&::-webkit-progress-bar]:bg-gray-100 [&::-webkit-progress-bar]:dark:bg-gray-700 [&::-moz-progress-bar]:bg-gray-100 [&::-moz-progress-bar]:dark:bg-gray-700`}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center text-xs text-gray-500 border-t border-gray-100 dark:border-gray-700 pt-3\">\r\n                  <span>Derni√®re visite:</span>\r\n                  <span className=\"font-medium text-gray-700 dark:text-gray-300\">\r\n                    {workload.lastVisit \r\n                      ? new Date(workload.lastVisit).toLocaleDateString() \r\n                      : 'Aucune'}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </CardBody>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { Visit } from '@/types';\r\nimport { format, parseISO } from 'date-fns';\r\nimport { fr } from 'date-fns/locale';\r\nimport { Calendar, User, MapPin, Clock } from 'lucide-react';\r\nimport { Card } from '@/components/ui/Card';\r\n\r\ninterface PlanningTimelineViewProps {\r\n  visits: Visit[];\r\n}\r\n\r\nexport const PlanningTimelineView: React.FC<PlanningTimelineViewProps> = ({ visits }) => {\r\n  if (visits.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\r\n        Aucune visite √† afficher dans la chronologie.\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Grouper par mois\r\n  const groupedVisits = visits.reduce((acc, visit) => {\r\n    const date = parseISO(visit.visitDate);\r\n    const key = format(date, 'yyyy-MM', { locale: fr });\r\n    \r\n    if (!acc[key]) {\r\n      acc[key] = [];\r\n    }\r\n    acc[key].push(visit);\r\n    return acc;\r\n  }, {} as Record<string, Visit[]>);\r\n\r\n  const sortedMonthKeys = Object.keys(groupedVisits).sort();\r\n\r\n  return (\r\n    <div className=\"relative space-y-8 p-4\">\r\n      {/* Ligne verticale centralis√©e */}\r\n      <div className=\"absolute left-4 md:left-1/2 top-4 bottom-4 w-0.5 bg-gray-200 dark:bg-gray-700 -ml-[1px]\" />\r\n\r\n      {sortedMonthKeys.map((monthKey) => (\r\n        <div key={monthKey} className=\"relative\">\r\n          {/* En-t√™te de mois */}\r\n          <div className=\"flex justify-center mb-6 relative z-10\">\r\n            <span className=\"bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 px-4 py-1 rounded-full text-sm font-semibold border-4 border-white dark:border-gray-900\">\r\n              {format(parseISO(`${monthKey}-01`), 'MMMM yyyy', { locale: fr })}\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"space-y-6\">\r\n            {groupedVisits[monthKey].map((visit, index) => {\r\n              const date = parseISO(visit.visitDate);\r\n              const isLeft = index % 2 === 0;\r\n\r\n              return (\r\n                <div key={visit.id} className={`flex flex-col md:flex-row items-center gap-4 md:gap-8 ${isLeft ? 'md:flex-row-reverse' : ''}`}>\r\n                  \r\n                  {/* Contenu (Carte) */}\r\n                  <div className=\"w-full md:w-1/2 pl-8 md:pl-0\">\r\n                    <Card className=\"p-4 hover:shadow-lg transition-shadow border-l-4 border-l-primary-500\">\r\n                      <div className=\"flex justify-between items-start mb-2\">\r\n                        <div className=\"flex items-center gap-2 text-sm text-primary-600 font-medium\">\r\n                          <Calendar className=\"w-4 h-4\" />\r\n                          {format(date, 'EEEE d', { locale: fr })}\r\n                        </div>\r\n                        <span className={`text-xs px-2 py-0.5 rounded-full ${\r\n                          visit.status === 'confirmed' ? 'bg-green-100 text-green-800' :\r\n                          visit.status === 'pending' ? 'bg-orange-100 text-orange-800' :\r\n                          'bg-gray-100 text-gray-800'\r\n                        }`}>\r\n                          {visit.status === 'confirmed' ? 'Confirm√©' : visit.status === 'pending' ? 'En attente' : visit.status}\r\n                        </span>\r\n                      </div>\r\n                      \r\n                      <h4 className=\"font-bold text-gray-900 dark:text-white mb-2\">{visit.nom}</h4>\r\n                      <div className=\"text-sm text-gray-600 dark:text-gray-400 space-y-1\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <MapPin className=\"w-3 h-3\" />\r\n                          {visit.congregation}\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                           <User className=\"w-3 h-3\" />\r\n                           <div className=\"flex-1 min-w-0\">\r\n                             {visit.talkNoOrType ? (\r\n                               <>\r\n                                 <div className=\"font-medium\">N¬∞{visit.talkNoOrType}</div>\r\n                                 {visit.talkTheme && <div className=\"text-xs truncate\">{visit.talkTheme}</div>}\r\n                               </>\r\n                             ) : 'Pas de discours'}\r\n                           </div>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                           <Clock className=\"w-3 h-3\" />\r\n                           {visit.visitTime}\r\n                        </div>\r\n                      </div>\r\n                    </Card>\r\n                  </div>\r\n\r\n                  {/* Point central */}\r\n                  <div className=\"absolute left-4 md:left-1/2 w-4 h-4 bg-primary-500 rounded-full md:-ml-2 border-4 border-white dark:border-gray-900 shadow-sm z-10 flex items-center justify-center\">\r\n                    <div className=\"w-1.5 h-1.5 bg-white rounded-full\" />\r\n                  </div>\r\n\r\n                  {/* Espace vide pour l'√©quilibrage */}\r\n                  <div className=\"hidden md:block w-1/2\" />\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useMemo, useState } from 'react';\r\nimport { useData } from '@/contexts/DataContext';\r\nimport { Visit, Expense } from '@/types';\r\nimport { Card, CardBody } from '@/components/ui/Card';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Select } from '@/components/ui/Select';\r\nimport {\r\n  Euro,\r\n  TrendingUp,\r\n  PieChart,\r\n  Calendar,\r\n  ArrowUpRight,\r\n  ArrowDownRight,\r\n  Download\r\n} from 'lucide-react';\r\nimport { format, startOfMonth, endOfMonth, isWithinInterval, subMonths } from 'date-fns';\r\nimport { fr } from 'date-fns/locale';\r\n\r\nexport const FinancialDashboard: React.FC = () => {\r\n  const { visits } = useData();\r\n  const [selectedMonth, setSelectedMonth] = useState<string>(new Date().toISOString().slice(0, 7)); // YYYY-MM\r\n  const [currency] = useState('‚Ç¨');\r\n\r\n  // Helper to extract all expenses from visits\r\n  const allExpenses = useMemo(() => visits.flatMap((v: Visit) => (v.expenses || []).map((e: Expense) => ({ ...e, visitNom: v.nom, visitDate: v.visitDate }))), [visits]);\r\n\r\n  // Filter expenses by selected month\r\n  const monthlyStats = useMemo(() => {\r\n    const [year, month] = selectedMonth.split('-').map(Number);\r\n    const start = startOfMonth(new Date(year, month - 1));\r\n    const end = endOfMonth(new Date(year, month - 1));\r\n    const previousStart = startOfMonth(subMonths(start, 1));\r\n    const previousEnd = endOfMonth(subMonths(start, 1));\r\n\r\n    // Define the type for the flattened expense object\r\n    type DashboardExpense = Expense & { visitNom: string; visitDate: string };\r\n\r\n    const currentMonthExpenses = allExpenses.filter((e: DashboardExpense) =>\r\n      isWithinInterval(new Date(e.date), { start, end })\r\n    );\r\n\r\n    const previousMonthExpenses = allExpenses.filter((e: DashboardExpense) =>\r\n      isWithinInterval(new Date(e.date), { start: previousStart, end: previousEnd })\r\n    );\r\n\r\n    const totalCurrent = currentMonthExpenses.reduce((sum: number, e: DashboardExpense) => sum + e.amount, 0);\r\n    const totalPrevious = previousMonthExpenses.reduce((sum: number, e: DashboardExpense) => sum + e.amount, 0);\r\n\r\n    // Calculate variations\r\n    const variation = totalPrevious === 0 ? 0 : ((totalCurrent - totalPrevious) / totalPrevious) * 100;\r\n\r\n    // By Category\r\n    const byCategory = currentMonthExpenses.reduce((acc: Record<string, number>, e: DashboardExpense) => {\r\n      const cat = e.category || 'Autre';\r\n      acc[cat] = (acc[cat] || 0) + e.amount;\r\n      return acc;\r\n    }, {} as Record<string, number>);\r\n\r\n    return {\r\n      total: totalCurrent,\r\n      variation,\r\n      count: currentMonthExpenses.length,\r\n      byCategory,\r\n      expenses: currentMonthExpenses.sort((a: DashboardExpense, b: DashboardExpense) => new Date(b.date).getTime() - new Date(a.date).getTime())\r\n    };\r\n  }, [allExpenses, selectedMonth]);\r\n\r\n  // Overall stats (Year to date could be added here)\r\n  const totalVisitsWithExpenses = visits.filter((v: Visit) => (v.expenses?.length || 0) > 0).length;\r\n  const averageCostPerVisit = totalVisitsWithExpenses === 0 ? 0 :\r\n    allExpenses.reduce((sum: number, e: Expense & { visitNom: string; visitDate: string }) => sum + e.amount, 0) / totalVisitsWithExpenses;\r\n\r\n  const exportData = () => {\r\n    const headers = ['Date', 'Visite', 'Description', 'Cat√©gorie', 'Montant'];\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...monthlyStats.expenses.map((e: Expense & { visitNom: string; visitDate: string }) => [\r\n        e.date,\r\n        `\"${e.visitNom}\"`,\r\n        `\"${e.description}\"`,\r\n        e.category,\r\n        e.amount\r\n      ].join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const link = document.createElement('a');\r\n    link.href = URL.createObjectURL(blob);\r\n    link.download = `depenses_${selectedMonth}.csv`;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  };\r\n\r\n  const monthOptions = Array.from({ length: 12 }, (_, i) => {\r\n    const d = subMonths(new Date(), i);\r\n    const value = format(d, 'yyyy-MM');\r\n    const label = format(d, 'MMMM yyyy', { locale: fr });\r\n    return { value, label: label.charAt(0).toUpperCase() + label.slice(1) };\r\n  });\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header & Controls */}\r\n      <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-white dark:bg-gray-800 p-4 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm\">\r\n        <div>\r\n          <h2 className=\"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2\">\r\n            <PieChart className=\"w-5 h-5 text-purple-600\" />\r\n            Tableau de bord financier\r\n          </h2>\r\n          <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n            Suivi des co√ªts et remboursements\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-3 w-full sm:w-auto\">\r\n          <Select\r\n            value={selectedMonth}\r\n            onChange={(e) => setSelectedMonth(e.target.value)}\r\n            options={monthOptions}\r\n            className=\"min-w-[180px]\"\r\n          />\r\n          <Button variant=\"secondary\" onClick={exportData} leftIcon={<Download className=\"w-4 h-4\" />}>\r\n            Export\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* KPI Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <Card>\r\n          <CardBody className=\"p-4 flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">D√©penses du mois</p>\r\n              <h3 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                {monthlyStats.total.toFixed(2)} {currency}\r\n              </h3>\r\n              <div className={`flex items-center text-xs mt-1 ${monthlyStats.variation > 0 ? 'text-red-500' : 'text-green-500'}`}>\r\n                {monthlyStats.variation > 0 ? <ArrowUpRight className=\"w-3 h-3 mr-1\" /> : <ArrowDownRight className=\"w-3 h-3 mr-1\" />}\r\n                {Math.abs(monthlyStats.variation).toFixed(1)}% vs mois dernier\r\n              </div>\r\n            </div>\r\n            <div className=\"w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center text-purple-600 dark:text-purple-400\">\r\n              <Euro className=\"w-5 h-5\" />\r\n            </div>\r\n          </CardBody>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardBody className=\"p-4 flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">Co√ªt moyen / Visite</p>\r\n              <h3 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                {averageCostPerVisit.toFixed(2)} {currency}\r\n              </h3>\r\n              <p className=\"text-xs text-gray-400 mt-1\">Sur toutes les visites</p>\r\n            </div>\r\n            <div className=\"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400\">\r\n              <TrendingUp className=\"w-5 h-5\" />\r\n            </div>\r\n          </CardBody>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardBody className=\"p-4 flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">Nombre de notes</p>\r\n              <h3 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                {monthlyStats.count}\r\n              </h3>\r\n              <p className=\"text-xs text-gray-400 mt-1\">Ce mois-ci</p>\r\n            </div>\r\n            <div className=\"w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-400\">\r\n              <Calendar className=\"w-5 h-5\" />\r\n            </div>\r\n          </CardBody>\r\n        </Card>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Categories Breakdown */}\r\n        <Card className=\"h-full\">\r\n          <CardBody className=\"p-5\">\r\n            <h3 className=\"font-semibold text-gray-900 dark:text-white mb-4\">R√©partition par cat√©gorie</h3>\r\n            <div className=\"space-y-4\">\r\n              {Object.entries(monthlyStats.byCategory).length === 0 ? (\r\n                <p className=\"text-center text-gray-500 py-4\">Aucune donn√©e</p>\r\n              ) : (\r\n                (Object.entries(monthlyStats.byCategory) as [string, number][])\r\n                  .sort(([, a], [, b]) => b - a)\r\n                  .map(([cat, amount]) => {\r\n                    const percentage = (amount / monthlyStats.total) * 100;\r\n                    return (\r\n                      <div key={cat}>\r\n                        <div className=\"flex justify-between text-sm mb-1\">\r\n                          <span className=\"text-gray-700 dark:text-gray-300\">{cat}</span>\r\n                          <span className=\"font-medium text-gray-900 dark:text-white\">{amount.toFixed(2)} {currency} ({percentage.toFixed(0)}%)</span>\r\n                        </div>\r\n                        <div className=\"w-full bg-gray-100 dark:bg-gray-700 rounded-full h-2\">\r\n                          <div\r\n                            className={`bg-purple-600 h-2 rounded-full transition-all duration-500 w-[${percentage}%]`}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })\r\n              )}\r\n            </div>\r\n          </CardBody>\r\n        </Card>\r\n\r\n        {/* Recent Expenses List */}\r\n        <Card className=\"h-full\">\r\n          <CardBody className=\"p-0\">\r\n            <div className=\"p-5 border-b border-gray-100 dark:border-gray-700\">\r\n              <h3 className=\"font-semibold text-gray-900 dark:text-white\">Derni√®res d√©penses</h3>\r\n            </div>\r\n            <div className=\"divide-y divide-gray-100 dark:divide-gray-700 max-h-[300px] overflow-y-auto\">\r\n              {monthlyStats.expenses.length === 0 ? (\r\n                <p className=\"text-center text-gray-500 py-8\">Aucune d√©pense ce mois-ci</p>\r\n              ) : (\r\n                monthlyStats.expenses.map((expense: Expense & { visitNom: string; visitDate: string }) => (\r\n                  <div key={expense.id} className=\"p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors\">\r\n                    <div className=\"flex justify-between items-start\">\r\n                      <div>\r\n                        <p className=\"font-medium text-gray-900 dark:text-white text-sm\">{expense.description}</p>\r\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-0.5\">\r\n                          {format(new Date(expense.date), 'dd MMM', { locale: fr })} ‚Ä¢ {expense.visitNom}\r\n                        </p>\r\n                      </div>\r\n                      <span className=\"font-semibold text-gray-900 dark:text-white text-sm\">\r\n                        {expense.amount.toFixed(2)} {currency}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </CardBody>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { Calendar } from 'lucide-react';\r\n\r\ninterface DatePickerProps {\r\n  value?: string;\r\n  onChange?: (date: string) => void;\r\n  placeholder?: string;\r\n  className?: string;\r\n  required?: boolean;\r\n  disabled?: boolean;\r\n  min?: string;\r\n  max?: string;\r\n}\r\n\r\nexport const DatePicker: React.FC<DatePickerProps> = ({\r\n  value,\r\n  onChange,\r\n  placeholder = 'S√©lectionner une date',\r\n  className = '',\r\n  required = false,\r\n  disabled = false,\r\n  min,\r\n  max\r\n}) => (\r\n    <div className={`relative ${className}`}>\r\n      <div className=\"relative\">\r\n        <input\r\n          type=\"date\"\r\n          value={value || ''}\r\n          onChange={(e) => onChange?.(e.target.value)}\r\n          className=\"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors\"\r\n          placeholder={placeholder}\r\n          required={required}\r\n          disabled={disabled}\r\n          min={min}\r\n          max={max}\r\n        />\r\n        <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\r\n          <Calendar className=\"w-4 h-4 text-gray-400\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Modal } from '@/components/ui/Modal';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { DatePicker } from '@/components/ui/DatePicker';\r\nimport { format, parseISO } from 'date-fns';\r\nimport { LocationType, VisitStatus } from '@/types';\r\n\r\ninterface PlanningFilterModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  dateRange: { start: Date | null; end: Date | null };\r\n  setDateRange: (range: { start: Date | null; end: Date | null }) => void;\r\n  statusFilter: VisitStatus | 'all';\r\n  setStatusFilter: (status: VisitStatus | 'all') => void;\r\n  typeFilter: LocationType | 'all';\r\n  setTypeFilter: (type: LocationType | 'all') => void;\r\n}\r\n\r\n// Helper to convert Date to string for input\r\nconst dateToString = (date: Date | null): string => {\r\n  if (!date) return '';\r\n  return format(date, 'yyyy-MM-dd');\r\n};\r\n\r\n// Helper to convert string to Date\r\nconst stringToDate = (dateStr: string): Date | null => {\r\n  if (!dateStr) return null;\r\n  return parseISO(dateStr);\r\n};\r\n\r\nexport const PlanningFilterModal: React.FC<PlanningFilterModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  dateRange,\r\n  setDateRange,\r\n  statusFilter,\r\n  setStatusFilter,\r\n  typeFilter,\r\n  setTypeFilter,\r\n}) => {\r\n  const [localDateRange, setLocalDateRange] = useState(dateRange);\r\n  const [localStatusFilter, setLocalStatusFilter] = useState(statusFilter);\r\n  const [localTypeFilter, setLocalTypeFilter] = useState(typeFilter);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setLocalDateRange(dateRange);\r\n      setLocalStatusFilter(statusFilter);\r\n      setLocalTypeFilter(typeFilter);\r\n    }\r\n  }, [isOpen, dateRange, statusFilter, typeFilter]);\r\n\r\n  const handleApply = () => {\r\n    setDateRange(localDateRange);\r\n    setStatusFilter(localStatusFilter);\r\n    setTypeFilter(localTypeFilter);\r\n    onClose();\r\n  };\r\n  \r\n  const handleCancel = () => {\r\n    onClose();\r\n  };\r\n\r\n  const handleClear = () => {\r\n    setLocalDateRange({ start: null, end: null });\r\n    setLocalStatusFilter('all');\r\n    setLocalTypeFilter('all');\r\n  };\r\n\r\n  return (\r\n    <Modal isOpen={isOpen} onClose={onClose} title=\"Filtres avanc√©s\">\r\n      <div className=\"space-y-6\">\r\n        {/* Statut */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n            Statut\r\n          </label>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {[\r\n              { value: 'all', label: 'Tous' },\r\n              { value: 'pending', label: 'En attente' },\r\n              { value: 'confirmed', label: 'Confirm√©' },\r\n              { value: 'completed', label: 'Termin√©' },\r\n              { value: 'cancelled', label: 'Annul√©' }\r\n            ].map(option => (\r\n              <button\r\n                key={option.value}\r\n                onClick={() => setLocalStatusFilter(option.value as VisitStatus | 'all')}\r\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\r\n                  localStatusFilter === option.value\r\n                    ? 'bg-blue-500 text-white'\r\n                    : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\r\n                }`}\r\n              >\r\n                {option.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Type */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n            Type de visite\r\n          </label>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {[\r\n              { value: 'all', label: 'Tous' },\r\n              { value: 'physical', label: 'Physique' },\r\n              { value: 'zoom', label: 'Zoom' },\r\n              { value: 'streaming', label: 'Streaming' }\r\n            ].map(option => (\r\n              <button\r\n                key={option.value}\r\n                onClick={() => setLocalTypeFilter(option.value as LocationType | 'all')}\r\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\r\n                  localTypeFilter === option.value\r\n                    ? 'bg-purple-500 text-white'\r\n                    : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\r\n                }`}\r\n              >\r\n                {option.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Plage de dates */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n            Plage de dates\r\n          </label>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <DatePicker\r\n              value={dateToString(localDateRange.start)}\r\n              onChange={(dateStr) => setLocalDateRange(prev => ({...prev, start: stringToDate(dateStr)}))}\r\n              placeholder=\"Date de d√©but\"\r\n            />\r\n            <span className=\"text-gray-500\">-</span>\r\n            <DatePicker\r\n              value={dateToString(localDateRange.end)}\r\n              onChange={(dateStr) => setLocalDateRange(prev => ({...prev, end: stringToDate(dateStr)}))}\r\n              placeholder=\"Date de fin\"\r\n              min={dateToString(localDateRange.start)}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"mt-8 flex justify-end space-x-3\">\r\n        <Button variant=\"ghost\" onClick={handleClear}>R√©initialiser</Button>\r\n        <Button variant=\"ghost\" onClick={handleCancel}>Annuler</Button>\r\n        <Button onClick={handleApply}>Appliquer les filtres</Button>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React, { useState, useMemo, memo, useCallback, useRef } from 'react';\r\nimport { useData } from '@/contexts/DataContext';\r\nimport { PlanningCardsView } from '@/components/planning/PlanningCardsView';\r\nimport { PlanningListView } from '@/components/planning/PlanningListView';\r\nimport { PlanningCalendarView } from '@/components/planning/PlanningCalendarView';\r\nimport { ScheduleVisitModal } from '@/components/planning/ScheduleVisitModal';\r\nimport { VisitActionModal } from '@/components/planning/VisitActionModal';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Input } from '@/components/ui/Input';\r\nimport {\r\n  LayoutGrid,\r\n  List,\r\n  Calendar as CalendarIcon,\r\n  Plus,\r\n  Search,\r\n  Download,\r\n  Filter,\r\n  X,\r\n  Eye,\r\n  BarChart,\r\n  PieChart,\r\n  MoreHorizontal,\r\n  Clock,\r\n  Archive,\r\n  MessageSquare,\r\n  Star\r\n} from 'lucide-react';\r\nimport { LocationType, VisitStatus, Visit } from '@/types';\r\nimport { PlanningWorkloadView } from '@/components/planning/PlanningWorkloadView';\r\nimport { PlanningTimelineView } from '@/components/planning/PlanningTimelineView';\r\nimport { FinancialDashboard } from '@/components/expenses/FinancialDashboard';\r\nimport { useReactToPrint } from 'react-to-print';\r\nimport { PlanningFilterModal } from '@/components/planning/PlanningFilterModal';\r\nimport { ConflictDetectionModal, CancellationModal, EmergencyReplacementModal } from '@/components/modals';\r\n\r\n\r\ntype ViewType = 'cards' | 'list' | 'calendar' | 'timeline' | 'workload' | 'finance' | 'archives';\r\n\r\n// Memoized statistics component for performance\r\nconst StatCard = memo(({\r\n  icon: Icon,\r\n  value,\r\n  label,\r\n  bgColor,\r\n  textColor,\r\n  iconBg\r\n}: {\r\n  icon: any;\r\n  value: number;\r\n  label: string;\r\n  bgColor: string;\r\n  textColor: string;\r\n  iconBg: string;\r\n}) => (\r\n  <div className={`${bgColor} p-4 rounded-lg border`}>\r\n    <div className=\"flex items-center gap-2\">\r\n      <div className={`w-8 h-8 rounded-full ${iconBg} flex items-center justify-center`}>\r\n        <Icon className={`w-4 h-4 ${textColor}`} />\r\n      </div>\r\n      <div>\r\n        <div className={`text-lg font-semibold ${textColor.replace('text-', 'text-').replace('blue-600', 'blue-900').replace('dark:text-blue-400', 'dark:text-blue-100')}`}>\r\n          {value}\r\n        </div>\r\n        <div className=\"text-xs text-blue-700 dark:text-blue-300\">{label}</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n));\r\n\r\n// Memoized view option component\r\nconst ViewOption = memo(({\r\n  viewOption,\r\n  currentView,\r\n  onViewChange\r\n}: {\r\n  viewOption: any;\r\n  currentView: ViewType;\r\n  onViewChange: (view: ViewType) => void;\r\n}) => (\r\n  <button\r\n    onClick={() => onViewChange(viewOption.id as ViewType)}\r\n    className={`p-2 rounded-md transition-all text-xs ${currentView === viewOption.id\r\n      ? 'bg-white dark:bg-gray-600 shadow-sm text-primary-600 dark:text-primary-400'\r\n      : 'text-gray-500 dark:text-gray-400 hover:text-gray-700'\r\n      }`}\r\n    title={viewOption.description}\r\n  >\r\n    <viewOption.icon className=\"w-4 h-4\" />\r\n  </button>\r\n));\r\n\r\nexport const Planning: React.FC = () => {\r\n  const { visits, archivedVisits } = useData();\r\n  const [view, setView] = useState<ViewType>('cards');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState<VisitStatus | 'all'>('all');\r\n  const [typeFilter, setTypeFilter] = useState<LocationType | 'all'>('all');\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [isActionModalOpen, setIsActionModalOpen] = useState(false);\r\n  const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\r\n  const [dateRange, setDateRange] = useState<{ start: Date | null, end: Date | null }>({ start: null, end: null });\r\n  const [selectedVisit, setSelectedVisit] = useState<Visit | null>(null);\r\n  const [selectedAction, setSelectedAction] = useState<'edit' | 'delete' | 'status' | 'message' | 'feedback' | 'expenses' | 'logistics'>('edit');\r\n  const [isConflictModalOpen, setIsConflictModalOpen] = useState(false);\r\n  const [isCancellationModalOpen, setIsCancellationModalOpen] = useState(false);\r\n  const [isReplacementModalOpen, setIsReplacementModalOpen] = useState(false);\r\n  const [isViewMenuOpen, setIsViewMenuOpen] = useState(false);\r\n\r\n  const componentRef = useRef<HTMLDivElement>(null);\r\n  const handlePrint = useReactToPrint({\r\n    contentRef: componentRef,\r\n    documentTitle: `Planning-visites-${new Date().toLocaleDateString()}`,\r\n  });\r\n\r\n  const handleExport = () => {\r\n    if (view === 'archives') {\r\n      const headers = ['Date', 'Heure', 'Orateur', 'Congr√©gation', 'Discours', 'Th√®me', 'H√¥te'];\r\n      const csvContent = [\r\n        headers.join(','),\r\n        ...archivedVisits.map(visit => [\r\n          visit.visitDate,\r\n          visit.visitTime,\r\n          `\"${visit.nom}\"`,\r\n          `\"${visit.congregation}\"`,\r\n          visit.talkNoOrType || '',\r\n          `\"${visit.talkTheme || ''}\"`,\r\n          `\"${visit.host || ''}\"`\r\n        ].join(','))\r\n      ].join('\\n');\r\n\r\n      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n      const link = document.createElement('a');\r\n      link.href = URL.createObjectURL(blob);\r\n      link.download = `visites_archivees_${new Date().toISOString().slice(0, 10)}.csv`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n    } else if (view === 'finance') {\r\n      // Le composant FinancialDashboard g√®re son propre export, mais on peut ajouter un toast ou une logique ici si n√©cessaire\r\n      // Pour l'instant on laisse le bouton interne du dashboard\r\n    } else {\r\n      handlePrint();\r\n    }\r\n  };\r\n\r\n\r\n  // Memoized event handlers to prevent unnecessary re-renders\r\n  const handleSetView = useCallback((newView: ViewType) => setView(newView), []);\r\n  const handleSearchChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) =>\r\n    setSearchTerm(e.target.value), []);\r\n  const handleOpenModal = useCallback(() => setIsModalOpen(true), []);\r\n  const handleCloseModal = useCallback(() => setIsModalOpen(false), []);\r\n  const handleVisitAction = useCallback((visit: Visit, action: 'edit' | 'delete' | 'status' | 'message' | 'feedback' | 'expenses' | 'logistics') => {\r\n    setSelectedVisit(visit);\r\n    setSelectedAction(action);\r\n    setIsActionModalOpen(true);\r\n  }, []);\r\n  const handleCloseActionModal = useCallback(() => {\r\n    setIsActionModalOpen(false);\r\n    setSelectedVisit(null);\r\n  }, []);\r\n\r\n  // Optimized filtered and sorted visits with proper dependencies\r\n  const filteredVisits = useMemo(() => visits\r\n    .filter((visit: Visit) => {\r\n      const matchesSearch =\r\n        visit.nom.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        visit.congregation.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        visit.talkNoOrType?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        visit.notes?.toLowerCase().includes(searchTerm.toLowerCase());\r\n\r\n      const matchesStatus = statusFilter === 'all' || visit.status === statusFilter;\r\n      const matchesType = typeFilter === 'all' || visit.locationType === typeFilter;\r\n\r\n      const visitDate = new Date(visit.visitDate);\r\n      const matchesDateRange =\r\n        (!dateRange.start || visitDate >= dateRange.start) &&\r\n        (!dateRange.end || visitDate <= dateRange.end);\r\n\r\n      return matchesSearch && matchesStatus && matchesType && matchesDateRange;\r\n    })\r\n    .sort((a: Visit, b: Visit) => new Date(a.visitDate).getTime() - new Date(b.visitDate).getTime()), [visits, searchTerm, statusFilter, typeFilter, dateRange]);\r\n\r\n  // Optimized statistics calculation\r\n  const stats = useMemo(() => {\r\n    const total = filteredVisits.length;\r\n    const confirmed = filteredVisits.filter((v: Visit) => v.status === 'confirmed').length;\r\n    const pending = filteredVisits.filter((v: Visit) => v.status === 'pending').length;\r\n    const completed = filteredVisits.filter((v: Visit) => v.status === 'completed').length;\r\n    const upcoming = filteredVisits.filter((v: Visit) => {\r\n      const visitDate = new Date(v.visitDate);\r\n      const today = new Date();\r\n      return visitDate >= today && v.status === 'confirmed';\r\n    }).length;\r\n\r\n    return { total, confirmed, pending, completed, upcoming };\r\n  }, [filteredVisits]);\r\n\r\n  const mainViewOptions = useMemo(() => [\r\n    { id: 'cards', label: 'Cartes', icon: LayoutGrid, description: 'Vue visuelle des visites' },\r\n    { id: 'list', label: 'Liste', icon: List, description: 'Tableau d√©taill√©' },\r\n    { id: 'calendar', label: 'Calendrier', icon: CalendarIcon, description: 'Vue calendrier' },\r\n  ], []);\r\n\r\n  const specializedViews = useMemo(() => [\r\n    { id: 'archives', label: 'Archives', icon: Archive, description: 'Visites termin√©es' },\r\n    { id: 'timeline', label: 'Chronologie', icon: Eye, description: 'Timeline verticale' },\r\n    { id: 'workload', label: 'Disponibilit√©', icon: BarChart, description: 'Charge des orateurs' },\r\n    { id: 'finance', label: 'Finances', icon: PieChart, description: 'Suivi des co√ªts' }\r\n  ], []);\r\n\r\n  return (\r\n    <div className=\"space-y-4 md:space-y-6\">\r\n      {/* Header & Stats */}\r\n      <div className=\"flex justify-end\">\r\n        <Button\r\n          leftIcon={<Plus className=\"w-4 h-4\" />}\r\n          onClick={handleOpenModal}\r\n          size=\"lg\"\r\n        >\r\n          Programmer une visite\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Statistics Cards - Mobile Optimized */}\r\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4\">\r\n        <StatCard\r\n          icon={CalendarIcon}\r\n          value={stats.total}\r\n          label=\"Total\"\r\n          bgColor=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800\"\r\n          textColor=\"text-blue-600 dark:text-blue-400\"\r\n          iconBg=\"bg-blue-100 dark:bg-blue-900\"\r\n        />\r\n        <StatCard\r\n          icon={() => <div className=\"w-2 h-2 rounded-full bg-green-500\" />}\r\n          value={stats.confirmed}\r\n          label=\"Confirm√©es\"\r\n          bgColor=\"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800\"\r\n          textColor=\"text-green-600 dark:text-green-400\"\r\n          iconBg=\"bg-green-100 dark:bg-green-900\"\r\n        />\r\n        <StatCard\r\n          icon={Clock}\r\n          value={stats.pending}\r\n          label=\"En attente\"\r\n          bgColor=\"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800\"\r\n          textColor=\"text-orange-600 dark:text-orange-400\"\r\n          iconBg=\"bg-orange-100 dark:bg-orange-900\"\r\n        />\r\n        <StatCard\r\n          icon={() => <div className=\"w-2 h-2 rounded-full bg-purple-500\" />}\r\n          value={stats.upcoming}\r\n          label=\"√Ä venir\"\r\n          bgColor=\"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800\"\r\n          textColor=\"text-purple-600 dark:text-purple-400\"\r\n          iconBg=\"bg-purple-100 dark:bg-purple-900\"\r\n        />\r\n      </div>\r\n\r\n      {/* Filters & View Toggle - Mobile Responsive */}\r\n      <div className=\"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between bg-white dark:bg-gray-800 p-3 md:p-4 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700\">\r\n        <div className=\"flex flex-col gap-3 w-full lg:w-auto\">\r\n          <div className=\"flex gap-3\">\r\n            <div className=\"flex-1 min-w-0 md:min-w-64\">\r\n              <Input\r\n                placeholder=\"Rechercher une visite...\"\r\n                leftIcon={<Search className=\"w-4 h-4\" />}\r\n                value={searchTerm}\r\n                onChange={handleSearchChange}\r\n              />\r\n            </div>\r\n            <Button\r\n              variant=\"secondary\"\r\n              size=\"sm\"\r\n              leftIcon={<Filter className=\"w-4 h-4\" />}\r\n              onClick={() => setIsFilterModalOpen(true)}\r\n            >\r\n              Filtres\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Active Filters Chips */}\r\n          {(statusFilter !== 'all' || typeFilter !== 'all') && (\r\n            <div className=\"flex gap-2 flex-wrap items-center\">\r\n              {statusFilter !== 'all' && (\r\n                <button\r\n                  onClick={() => setStatusFilter('all')}\r\n                  className=\"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors\"\r\n                >\r\n                  {statusFilter === 'pending' && 'En attente'}\r\n                  {statusFilter === 'confirmed' && 'Confirm√©'}\r\n                  {statusFilter === 'completed' && 'Termin√©'}\r\n                  {statusFilter === 'cancelled' && 'Annul√©'}\r\n                  <X className=\"w-3 h-3\" />\r\n                </button>\r\n              )}\r\n              {typeFilter !== 'all' && (\r\n                <button\r\n                  onClick={() => setTypeFilter('all')}\r\n                  className=\"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 hover:bg-purple-200 dark:hover:bg-purple-900/50 transition-colors\"\r\n                >\r\n                  {typeFilter === 'physical' && 'Physique'}\r\n                  {typeFilter === 'zoom' && 'Zoom'}\r\n                  {typeFilter === 'streaming' && 'Streaming'}\r\n                  <X className=\"w-3 h-3\" />\r\n                </button>\r\n              )}\r\n              <button\r\n                onClick={() => {\r\n                  setStatusFilter('all');\r\n                  setTypeFilter('all');\r\n                }}\r\n                className=\"text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 underline\"\r\n              >\r\n                Effacer tout\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2 w-full lg:w-auto justify-between lg:justify-end\">\r\n          {/* View Toggle - 3 vues principales */}\r\n          <div className=\"flex items-center bg-gray-100 dark:bg-gray-700 p-1 rounded-lg\">\r\n            {mainViewOptions.map((viewOption) => (\r\n              <ViewOption\r\n                key={viewOption.id}\r\n                viewOption={viewOption}\r\n                currentView={view}\r\n                onViewChange={handleSetView}\r\n              />\r\n            ))}\r\n\r\n            {/* Menu d√©roulant pour vues sp√©cialis√©es */}\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => setIsViewMenuOpen(!isViewMenuOpen)}\r\n                className={`p-2 rounded-md transition-all text-xs ${['timeline', 'workload', 'finance'].includes(view)\r\n                  ? 'bg-white dark:bg-gray-600 shadow-sm text-primary-600 dark:text-primary-400'\r\n                  : 'text-gray-500 dark:text-gray-400 hover:text-gray-700'\r\n                  }`}\r\n                title=\"Plus de vues\"\r\n              >\r\n                <MoreHorizontal className=\"w-4 h-4\" />\r\n              </button>\r\n\r\n              {isViewMenuOpen && (\r\n                <>\r\n                  <div\r\n                    className=\"fixed inset-0 z-10\"\r\n                    onClick={() => setIsViewMenuOpen(false)}\r\n                  />\r\n                  <div className=\"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-20\">\r\n                    {specializedViews.map((viewOption) => (\r\n                      <button\r\n                        key={viewOption.id}\r\n                        onClick={() => {\r\n                          handleSetView(viewOption.id as ViewType);\r\n                          setIsViewMenuOpen(false);\r\n                        }}\r\n                        className={`w-full flex items-center gap-3 px-4 py-3 text-sm transition-colors ${view === viewOption.id\r\n                          ? 'bg-primary-50 text-primary-700 dark:bg-primary-900/20 dark:text-primary-400'\r\n                          : 'text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700'\r\n                          }`}\r\n                      >\r\n                        <viewOption.icon className=\"w-4 h-4\" />\r\n                        <div className=\"text-left\">\r\n                          <div className=\"font-medium\">{viewOption.label}</div>\r\n                          <div className=\"text-xs text-gray-500 dark:text-gray-400\">{viewOption.description}</div>\r\n                        </div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <Button variant=\"secondary\" size=\"sm\" leftIcon={<Download className=\"w-4 h-4\" />} onClick={handleExport}>\r\n            Exporter\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"min-h-[400px] md:min-h-[600px]\" ref={componentRef}>\r\n        {view === 'cards' && (\r\n          <PlanningCardsView\r\n            visits={filteredVisits}\r\n            onVisitAction={handleVisitAction}\r\n            onVisitClick={(visit) => handleVisitAction(visit, 'edit')}\r\n          />\r\n        )}\r\n\r\n        {view === 'list' && (\r\n          <PlanningListView\r\n            visits={filteredVisits}\r\n            onVisitAction={handleVisitAction}\r\n            onVisitClick={(visit) => handleVisitAction(visit, 'edit')}\r\n          />\r\n        )}\r\n\r\n        {view === 'calendar' && (\r\n          <PlanningCalendarView\r\n            visits={filteredVisits}\r\n            onVisitClick={(visit) => handleVisitAction(visit, 'edit')}\r\n          />\r\n        )}\r\n\r\n        {view === 'timeline' && (\r\n          <PlanningTimelineView visits={filteredVisits} />\r\n        )}\r\n\r\n        {view === 'workload' && (\r\n          <PlanningWorkloadView />\r\n        )}\r\n\r\n        {view === 'finance' && (\r\n          <FinancialDashboard />\r\n        )}\r\n\r\n        {view === 'archives' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center gap-3 mb-4\">\r\n              <Archive className=\"w-6 h-6 text-gray-600 dark:text-gray-400\" />\r\n              <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">\r\n                Visites archiv√©es ({archivedVisits.length})\r\n              </h2>\r\n            </div>\r\n\r\n            {archivedVisits.length === 0 ? (\r\n              <div className=\"text-center py-12\">\r\n                <Archive className=\"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4\" />\r\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\r\n                  Aucune visite archiv√©e\r\n                </h3>\r\n                <p className=\"text-gray-500 dark:text-gray-400\">\r\n                  Les visites termin√©es appara√Ætront ici automatiquement.\r\n                </p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                {archivedVisits\r\n                  .sort((a, b) => new Date(b.visitDate).getTime() - new Date(a.visitDate).getTime())\r\n                  .map((visit) => (\r\n                    <div\r\n                      key={visit.visitId}\r\n                      className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow-sm hover:shadow-md transition-shadow\"\r\n                    >\r\n                      <div className=\"flex items-start justify-between mb-3\">\r\n                        <div>\r\n                          <h3 className=\"font-semibold text-gray-900 dark:text-white\">\r\n                            {visit.nom}\r\n                          </h3>\r\n                          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                            {visit.congregation}\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <span className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400\">\r\n                            Termin√©e\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"space-y-2 text-sm\">\r\n                        <div className=\"flex justify-between\">\r\n                          <span className=\"text-gray-600 dark:text-gray-400\">Date:</span>\r\n                          <span className=\"font-medium\">\r\n                            {new Date(visit.visitDate).toLocaleDateString('fr-FR')}\r\n                          </span>\r\n                        </div>\r\n                        <div className=\"flex justify-between\">\r\n                          <span className=\"text-gray-600 dark:text-gray-400\">Heure:</span>\r\n                          <span>{visit.visitTime}</span>\r\n                        </div>\r\n                        {visit.talkNoOrType && (\r\n                          <div className=\"flex justify-between\">\r\n                            <span className=\"text-gray-600 dark:text-gray-400\">Discours:</span>\r\n                            <span>{visit.talkNoOrType}</span>\r\n                          </div>\r\n                        )}\r\n                        {visit.host && (\r\n                          <div className=\"flex justify-between\">\r\n                            <span className=\"text-gray-600 dark:text-gray-400\">H√¥te:</span>\r\n                            <span>{visit.host}</span>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n\r\n                      {visit.talkTheme && (\r\n                        <div className=\"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700\">\r\n                          <p className=\"text-sm text-gray-700 dark:text-gray-300 italic\">\r\n                            \"{visit.talkTheme}\"\r\n                          </p>\r\n                        </div>\r\n                      )}\r\n\r\n                      <div className=\"mt-4 flex gap-2\">\r\n                        <Button\r\n                          variant=\"secondary\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleVisitAction(visit, 'message')}\r\n                          leftIcon={<MessageSquare className=\"w-3 h-3\" />}\r\n                        >\r\n                          Message\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"secondary\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleVisitAction(visit, 'feedback')}\r\n                          leftIcon={<Star className=\"w-3 h-3\" />}\r\n                        >\r\n                          Bilan\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Past Visits Alert */}\r\n      {visits.filter((v: Visit) => v.status === 'confirmed' && new Date(v.visitDate) < new Date()).length > 0 && (\r\n        <div className=\"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-900/50 rounded-lg p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"w-8 h-8 md:w-10 md:h-10 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center\">\r\n                <Clock className=\"w-4 h-4 md:w-5 md:h-5 text-orange-600 dark:text-orange-400\" />\r\n              </div>\r\n              <div>\r\n                <h4 className=\"font-medium text-orange-900 dark:text-orange-100\">\r\n                  Visites pass√©es √† archiver\r\n                </h4>\r\n                <p className=\"text-sm text-orange-700 dark:text-orange-300\">\r\n                  {visits.filter((v: Visit) => v.status === 'confirmed' && new Date(v.visitDate) < new Date()).length} visite(s) pass√©e(s) n√©cessite(nt) une action\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <Button variant=\"secondary\" size=\"sm\">\r\n              Voir tout\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <ScheduleVisitModal\r\n        isOpen={isModalOpen}\r\n        onClose={handleCloseModal}\r\n      />\r\n\r\n      <VisitActionModal\r\n        isOpen={isActionModalOpen}\r\n        onClose={handleCloseActionModal}\r\n        visit={selectedVisit}\r\n        action={selectedAction}\r\n      />\r\n\r\n      <PlanningFilterModal\r\n        isOpen={isFilterModalOpen}\r\n        onClose={() => setIsFilterModalOpen(false)}\r\n        dateRange={dateRange}\r\n        setDateRange={setDateRange}\r\n        statusFilter={statusFilter}\r\n        setStatusFilter={setStatusFilter}\r\n        typeFilter={typeFilter}\r\n        setTypeFilter={setTypeFilter}\r\n      />\r\n\r\n      {selectedVisit && (\r\n        <>\r\n          <ConflictDetectionModal\r\n            isOpen={isConflictModalOpen}\r\n            onClose={() => setIsConflictModalOpen(false)}\r\n            visit={selectedVisit}\r\n            onResolve={(resolution) => {\r\n              console.log('Conflict resolved:', resolution);\r\n              setIsConflictModalOpen(false);\r\n            }}\r\n          />\r\n\r\n          <CancellationModal\r\n            isOpen={isCancellationModalOpen}\r\n            onClose={() => setIsCancellationModalOpen(false)}\r\n            visit={selectedVisit}\r\n            onCancel={(data) => {\r\n              console.log('Visit cancelled:', data);\r\n              setIsCancellationModalOpen(false);\r\n            }}\r\n          />\r\n\r\n          <EmergencyReplacementModal\r\n            isOpen={isReplacementModalOpen}\r\n            onClose={() => setIsReplacementModalOpen(false)}\r\n            visit={selectedVisit}\r\n            onSelectReplacement={(speaker) => {\r\n              console.log('Replacement selected:', speaker);\r\n              setIsReplacementModalOpen(false);\r\n            }}\r\n          />\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n"],"names":["ArrowDownRight","createLucideIcon","ArrowUpRight","BarChart","Eye","LayoutGrid","List","MoreHorizontal","MoreVertical","PieChart","ConflictDetectionModal","isOpen","onClose","visit","onResolve","visits","hosts","useData","selectedResolutions","setSelectedResolutions","useState","conflicts","useMemo","detected","sameDateSpeaker","v","h","availableHosts","idx","recentSameTalk","sameMonthVisits","vDate","visitDate","getSeverityColor","severity","getSeverityIcon","jsx","XCircle","AlertTriangle","CheckCircle","handleSelectSuggestion","conflictId","suggestionId","prev","newMap","handleApplyResolutions","Modal","jsxs","Calendar","Badge","c","conflict","Card","CardBody","suggestion","ArrowRight","Button","Fragment","CANCELLATION_REASONS","CancellationModal","onCancel","selectedReason","setSelectedReason","customReason","setCustomReason","notifySpeaker","setNotifySpeaker","notifyHost","setNotifyHost","proposeReschedule","setProposeReschedule","suggestedNewDate","setSuggestedNewDate","internalNotes","setInternalNotes","showConfirmation","setShowConfirmation","handleSubmit","cancellationData","getNotificationPreview","reason","r","Send","e","RotateCcw","MessageSquare","EmergencyReplacementModal","onSelectReplacement","speakers","searchTerm","setSearchTerm","filterByDistance","setFilterByDistance","filterByAvailability","setFilterByAvailability","selectedSpeaker","setSelectedSpeaker","sendNotification","setSendNotification","showFilters","setShowFilters","matchedSpeakers","matches","speaker","score","reasons","availableTalks","speakerTalks","t","talk","lastVisit","a","b","m","handleSelectSpeaker","getScoreColor","getScoreLabel","AlertCircle","Search","Filter","match","MapPin","Phone","User","VisitCard","onClick","onAction","showMenu","setShowMenu","buttonRef","useRef","getStatusBadge","status","handleActionClick","action","actionOptions","Edit2","CreditCard","Truck","Star","Trash2","fr","Clock","item","CommunicationProgress","createPortal","option","PlanningCardsView","onVisitClick","onVisitAction","index","PlanningListView","format","Edit","PlanningCalendarView","currentDate","setCurrentDate","nextMonth","addMonths","prevMonth","subMonths","today","monthStart","startOfMonth","monthEnd","endOfMonth","startDate","startOfWeek","endDate","endOfWeek","calendarDays","eachDayOfInterval","weekDays","getVisitsForDay","date","isSameDay","ChevronLeft","ChevronRight","day","dayVisits","isCurrentMonth","isSameMonth","isCurrentDay","isToday","ScheduleVisitModal","initialDate","addVisit","publicTalks","congregationProfile","addToast","useToast","isLoading","setIsLoading","dateError","setDateError","dateConflict","setDateConflict","formData","setFormData","useEffect","validateDate","checkDateConflict","dateStr","newVisit","uuidv4","error","handleSpeakerChange","speakerId","s","handleTalkChange","talkNumber","Select","Input","PlanningWorkloadView","React","filteredData","calculateWorkload","workload","WorkloadIndicator","PlanningTimelineView","groupedVisits","acc","parseISO","key","sortedMonthKeys","monthKey","isLeft","FinancialDashboard","selectedMonth","setSelectedMonth","currency","allExpenses","monthlyStats","year","month","start","end","previousStart","previousEnd","currentMonthExpenses","isWithinInterval","previousMonthExpenses","totalCurrent","sum","totalPrevious","variation","byCategory","cat","totalVisitsWithExpenses","averageCostPerVisit","exportData","csvContent","blob","link","monthOptions","_","i","d","value","label","Download","Euro","TrendingUp","amount","percentage","expense","DatePicker","onChange","placeholder","className","required","disabled","min","max","dateToString","stringToDate","PlanningFilterModal","dateRange","setDateRange","statusFilter","setStatusFilter","typeFilter","setTypeFilter","localDateRange","setLocalDateRange","localStatusFilter","setLocalStatusFilter","localTypeFilter","setLocalTypeFilter","handleApply","handleCancel","handleClear","StatCard","memo","Icon","bgColor","textColor","iconBg","ViewOption","viewOption","currentView","onViewChange","Planning","archivedVisits","view","setView","isModalOpen","setIsModalOpen","isActionModalOpen","setIsActionModalOpen","isFilterModalOpen","setIsFilterModalOpen","selectedVisit","setSelectedVisit","selectedAction","setSelectedAction","isConflictModalOpen","setIsConflictModalOpen","isCancellationModalOpen","setIsCancellationModalOpen","isReplacementModalOpen","setIsReplacementModalOpen","isViewMenuOpen","setIsViewMenuOpen","componentRef","handlePrint","useReactToPrint","handleExport","handleSetView","useCallback","newView","handleSearchChange","handleOpenModal","handleCloseModal","handleVisitAction","handleCloseActionModal","filteredVisits","matchesSearch","matchesStatus","matchesType","matchesDateRange","stats","total","confirmed","pending","completed","upcoming","mainViewOptions","CalendarIcon","specializedViews","Archive","Plus","X","VisitActionModal","resolution","data"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8]}