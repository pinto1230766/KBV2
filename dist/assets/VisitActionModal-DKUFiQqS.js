import{c as U,j as e,B as y,P as be,C as Re,n as Le,H as me,X as _e,q as Ne,u as Ee,k as ve,U as Ue,i as xe,f as fe,g as je,A as Ye,m as de,l as We,a as Xe,r as Ke,M as Qe}from"./index-AmzywnQ-.js";import{r as b}from"./charts-CCOFnOOy.js";import{I as K,M as le,U as Oe,P as Ze}from"./Select-D3AihcAO.js";import{S as Je,T as Ae}from"./trash-2-DmDBTQF6.js";import{f as pe,p as ke}from"./utils-FTT-aY8U.js";import{C as Se,S as He,F as et}from"./FeedbackFormModal-DPgQ6wkp.js";import{C as we}from"./copy-OLxS_7Ei.js";import{L as tt}from"./link-DNLUTRLk.js";import{C as rt,M as st}from"./MessageGeneratorModal-PCxOSBF7.js";import{r as at}from"./react-vendor-B9D_A6Vq.js";const nt=U("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const Fe=U("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);const lt=U("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);const it=U("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const ot=U("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);const Te=U("Hotel",[["path",{d:"M18 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z",key:"p9z69c"}],["path",{d:"m9 16 .348-.24c1.465-1.013 3.84-1.013 5.304 0L15 16",key:"1bvcvh"}],["path",{d:"M8 7h.01",key:"1vti4s"}],["path",{d:"M16 7h.01",key:"1kdx03"}],["path",{d:"M12 7h.01",key:"1ivr5q"}],["path",{d:"M12 11h.01",key:"z322tv"}],["path",{d:"M16 11h.01",key:"xkw8gn"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M10 22v-6.5m4 0V22",key:"16gs4s"}]]);const qe=U("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);const Me=U("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);const ze=U("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);const Ve=U("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);const ct=U("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);const dt=U("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);const mt=U("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);const Ge=U("TramFront",[["rect",{width:"16",height:"16",x:"4",y:"3",rx:"2",key:"1wxw4b"}],["path",{d:"M4 11h16",key:"mpoxn0"}],["path",{d:"M12 3v8",key:"1h2ygw"}],["path",{d:"m8 19-2 3",key:"13i0xs"}],["path",{d:"m18 22-2-3",key:"1p0ohu"}],["path",{d:"M8 15h0",key:"q9eq1f"}],["path",{d:"M16 15h0",key:"pzrbjg"}]]);const Ce=U("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);const he=U("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]);const ge=U("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ie=["Transport","H√©bergement","Repas","Mat√©riel","Autre"],gt=({onSubmit:t,onCancel:h,initialData:r,currency:x="‚Ç¨"})=>{const[p,l]=b.useState(r?.description||""),[n,g]=b.useState(r?.amount?.toString()||""),[D,o]=b.useState(r?.date||new Date().toISOString().split("T")[0]),[S,N]=b.useState(r?.category||Ie[0]),L=C=>{C.preventDefault(),!(!p||!n||!D)&&t({description:p,amount:parseFloat(n),date:D,category:S})};return e.jsxs("form",{onSubmit:L,className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description *"}),e.jsx("input",{type:"text",value:p,onChange:C=>l(C.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:"Ex: Billet de train...",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Cat√©gorie"}),e.jsx("select",{value:S,onChange:C=>N(C.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",title:"Cat√©gorie de la d√©pense",children:Ie.map(C=>e.jsx("option",{value:C,children:C},C))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Montant (",x,") *"]}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:n,onChange:C=>g(C.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",required:!0,title:"Montant de la d√©pense",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:D,onChange:C=>o(C.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",required:!0,title:"Date de la d√©pense"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(y,{variant:"ghost",onClick:h,type:"button",children:"Annuler"}),e.jsx(y,{variant:"primary",type:"submit",leftIcon:e.jsx(Je,{className:"w-4 h-4"}),children:"Enregistrer"})]})]})},ut=({expenses:t=[],onAdd:h,onEdit:r,onDelete:x,currency:p="‚Ç¨",readOnly:l=!1})=>{const n=b.useMemo(()=>t.reduce((g,D)=>g+D.amount,0),[t]);return t.length===0&&l?e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Aucune d√©pense enregistr√©e."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total des d√©penses"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[n.toFixed(2)," ",p]})]}),!l&&e.jsx(y,{onClick:h,variant:"primary",leftIcon:e.jsx(be,{className:"w-4 h-4"}),children:"Ajouter une d√©pense"})]}),e.jsx("div",{className:"space-y-2",children:t.length===0?e.jsxs("div",{className:"text-center py-8 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-dashed border-gray-300 dark:border-gray-700",children:[e.jsx(ot,{className:"w-10 h-10 mx-auto text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucune d√©pense pour le moment"}),!l&&e.jsx(y,{onClick:h,variant:"ghost",className:"mt-2 text-primary-600",children:"Commencer √† ajouter"})]}):t.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-100 dark:border-gray-700 hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:g.description}),g.category&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200",children:[e.jsx(mt,{className:"w-3 h-3 mr-1"}),g.category]})]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(Re,{className:"w-3 h-3 mr-1"}),pe(new Date(g.date),"dd MMMM yyyy",{locale:Le})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[g.amount.toFixed(2)," ",p]}),!l&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>r(g),className:"p-1 text-gray-400 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",title:"Modifier",children:e.jsx(ze,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x(g.id),className:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"Supprimer",children:e.jsx(Ae,{className:"w-4 h-4"})})]})]})]},g.id))})]})},$e=b.memo(ut);$e.displayName="ExpenseList";const xt=({itinerary:t,onUpdate:h,readOnly:r=!1})=>{const x=(l,n)=>{h({...t,[l]:n})},p=l=>{const n=encodeURIComponent(t.meetingPoint||"");if(!n)return;const g=l==="waze"?`https://waze.com/ul?q=${n}&navigate=yes`:`https://www.google.com/maps/search/?api=1&query=${n}`;window.open(g,"_blank")};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex gap-4",children:[{mode:"car",icon:Se,label:"Voiture"},{mode:"train",icon:Ge,label:"Train"},{mode:"plane",icon:Ve,label:"Avion"}].map(({mode:l,icon:n,label:g})=>e.jsxs("button",{type:"button",onClick:()=>x("transportMode",l),className:`flex-1 flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all ${t.transportMode===l?"border-primary bg-primary/5 text-primary":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 text-gray-500"}`,disabled:r,children:[e.jsx(n,{className:"w-6 h-6 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:g})]},l))}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(K,{label:"Distance (km)",type:"number",value:t.distance?.toString()||"",onChange:l=>x("distance",l.target.value?parseFloat(l.target.value):void 0),disabled:r,leftIcon:e.jsx(Me,{className:"w-4 h-4"})}),e.jsx(K,{label:"Dur√©e estim√©e",placeholder:"ex: 1h 30m",value:t.duration?.toString()||"",onChange:l=>x("duration",l.target.value),disabled:r,leftIcon:e.jsx(we,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(K,{label:"Point de rendez-vous / Adresse",value:t.meetingPoint||"",onChange:l=>x("meetingPoint",l.target.value),disabled:r,leftIcon:e.jsx(le,{className:"w-4 h-4"})}),t.meetingPoint&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"outline",className:"flex-1",onClick:()=>p("google"),leftIcon:e.jsx(qe,{className:"w-4 h-4"}),children:"Google Maps"}),e.jsx(y,{variant:"outline",className:"flex-1",onClick:()=>p("waze"),leftIcon:e.jsx(Me,{className:"w-4 h-4"}),children:"Waze"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes de voyage"}),e.jsx("textarea",{value:t.notes||"",onChange:l=>x("notes",l.target.value),disabled:r,className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800 text-gray-900 dark:text-white text-sm focus:ring-primary focus:border-primary p-3 min-h-[100px]",placeholder:"Informations suppl√©mentaires..."})]})]})},Pe=t=>t?t.slice(0,16):"",pt=({accommodation:t,onUpdate:h,readOnly:r=!1,hosts:x=[]})=>{const p=(n,g)=>{h({...t,[n]:g})},l=()=>{const n=encodeURIComponent(t.address||t.name||"");n&&window.open(`https://www.google.com/maps/search/?api=1&query=${n}`,"_blank")};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex gap-4",children:[{type:"host",icon:me,label:"Chez l'habitant"},{type:"hotel",icon:nt,label:"H√¥tel"}].map(({type:n,icon:g,label:D})=>e.jsxs("button",{onClick:()=>!r&&p("type",n),className:`flex-1 flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all ${t.type===n?"border-primary bg-primary/5 text-primary":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 text-gray-500"}`,disabled:r,children:[e.jsx(g,{className:"w-6 h-6 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:D})]},n))}),e.jsxs("div",{className:"space-y-4",children:[t.type==="hotel"?e.jsx(K,{label:"Nom de l'h√¥tel",value:t.name||"",onChange:n=>p("name",n.target.value),disabled:r,placeholder:"Ex: H√¥tel de la Gare"}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nom de l'h√¥te"}),e.jsxs("select",{value:t.name||"",onChange:n=>{const g=x.find(D=>D.nom===n.target.value);h({...t,name:n.target.value,address:g?.address||t.address||""})},disabled:r,title:"S√©lectionner un h√¥te",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"S√©lectionner un h√¥te..."}),x.map(n=>e.jsx("option",{value:n.nom,children:n.nom},n.nom))]})]}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsx(K,{label:"Adresse",value:t.address||"",onChange:n=>p("address",n.target.value),disabled:r,leftIcon:e.jsx(le,{className:"w-4 h-4"})})}),t.address&&e.jsx(y,{variant:"outline",className:"mb-[2px]",onClick:l,leftIcon:e.jsx(le,{className:"w-4 h-4"}),children:"Voir"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(K,{label:"Arriv√©e (Check-in)",type:"datetime-local",value:Pe(t.checkIn),onChange:n=>p("checkIn",n.target.value),disabled:r}),e.jsx(K,{label:"D√©part (Check-out)",type:"datetime-local",value:Pe(t.checkOut),onChange:n=>p("checkOut",n.target.value),disabled:r})]}),t.type==="hotel"&&e.jsx(K,{label:"R√©f√©rence r√©servation",value:t.bookingReference||"",onChange:n=>p("bookingReference",n.target.value),disabled:r,leftIcon:e.jsx(tt,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes / Instructions"}),e.jsx("textarea",{value:t.notes||"",onChange:n=>p("notes",n.target.value),disabled:r,className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800 text-gray-900 dark:text-white text-sm focus:ring-primary focus:border-primary p-3 min-h-[100px]",placeholder:"Codes d'acc√®s, petit-d√©jeuner, etc."})]})]})]})},ht=({items:t=[],onUpdate:h})=>{const[r,x]=b.useState(""),[p,l]=b.useState(!1),n=o=>{const S=t.map(N=>N.id===o?{...N,isCompleted:!N.isCompleted}:N);h(S)},g=o=>{const S=t.filter(N=>N.id!==o);h(S)},D=o=>{if(o?.preventDefault(),!r.trim())return;const S={id:Ne(),label:r.trim(),isCompleted:!1};h([...t,S]),x(""),l(!1)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Liste des t√¢ches (",t.filter(o=>o.isCompleted).length,"/",t.length,")"]}),e.jsxs(y,{size:"sm",variant:"ghost",onClick:()=>l(!p),className:"text-primary hover:text-primary/80 p-0 h-auto",children:[e.jsx(be,{className:"w-4 h-4 mr-1"}),"Ajouter"]})]}),p&&e.jsxs("form",{onSubmit:D,className:"flex gap-2 items-center mb-4 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx(K,{autoFocus:!0,value:r,onChange:o=>x(o.target.value),placeholder:"Nouvelle t√¢che...",className:"flex-1 h-9 text-sm"}),e.jsx(y,{type:"submit",size:"sm",disabled:!r.trim(),children:"Ajouter"}),e.jsx(y,{type:"button",variant:"ghost",size:"sm",onClick:()=>l(!1),leftIcon:e.jsx(_e,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-2",children:t.length===0&&!p?e.jsxs("div",{className:"text-center py-6 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Aucune t√¢che pour le moment"}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>l(!0),children:"Commencer une liste"})]}):t.map(o=>e.jsxs("div",{className:`flex items-center group p-2 rounded-lg transition-colors hover:bg-gray-50 dark:hover:bg-gray-800/50 ${o.isCompleted?"opacity-75":""}`,children:[e.jsx("button",{onClick:()=>n(o.id),className:`flex-shrink-0 w-5 h-5 rounded border flex items-center justify-center mr-3 transition-colors ${o.isCompleted?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600 hover:border-green-500"}`,children:o.isCompleted&&e.jsx(rt,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:`flex-1 text-sm transition-all ${o.isCompleted?"text-gray-400 line-through":"text-gray-700 dark:text-gray-200"}`,children:o.label}),e.jsx("button",{onClick:()=>g(o.id),className:"opacity-0 group-hover:opacity-100 p-1 text-gray-400 hover:text-red-500 transition-opacity",title:"Supprimer",children:e.jsx(Ae,{className:"w-4 h-4"})})]},o.id))})]})},yt=({logistics:t={},onUpdate:h,readOnly:r=!1,hosts:x=[]})=>{const[p,l]=b.useState("itinerary"),n=S=>{h({...t,itinerary:S})},g=S=>{h({...t,accommodation:S})},D=S=>{h({...t,checklist:S})},o=[{id:"itinerary",label:"Trajet",icon:qe},{id:"accommodation",label:"H√©bergement",icon:me},{id:"checklist",label:"T√¢ches",icon:Fe}];return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-700 mb-6",children:o.map(({id:S,label:N,icon:L})=>e.jsxs("button",{onClick:()=>l(S),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${p===S?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[e.jsx(L,{className:"w-4 h-4"}),N]},S))}),e.jsxs("div",{className:"flex-1 overflow-y-auto min-h-[400px]",children:[p==="itinerary"&&e.jsx(xt,{itinerary:t.itinerary||{transportMode:"car"},onUpdate:n,readOnly:r}),p==="accommodation"&&e.jsx(pt,{accommodation:t.accommodation||{type:"host",name:""},onUpdate:g,readOnly:r,hosts:x}),p==="checklist"&&e.jsx(ht,{items:t.checklist||[],onUpdate:D})]})]})},bt=[{value:"car",label:"Voiture personnelle",icon:Se,color:"blue"},{value:"carpool",label:"Covoiturage",icon:Ue,color:"green"},{value:"train",label:"Train",icon:Ge,color:"purple"},{value:"plane",label:"Avion",icon:Ve,color:"orange"},{value:"other",label:"Autre",icon:le,color:"gray"}],ft=({isOpen:t,onClose:h,visit:r,onSave:x})=>{const{visits:p}=Ee(),[l,n]=b.useState("car"),[g,D]=b.useState(""),[o,S]=b.useState(""),[N,L]=b.useState(""),[C,z]=b.useState(""),[v,A]=b.useState(),[w,a]=b.useState(""),[i,k]=b.useState(),[T,H]=b.useState([]),[_,M]=b.useState(""),[V,F]=b.useState(""),[q,s]=b.useState(""),d=b.useMemo(()=>p.filter(c=>c.visitDate===r.visitDate&&c.visitId!==r.visitId&&c.status!=="cancelled").map(c=>({visitId:c.visitId,speakerId:c.id,speakerName:c.nom,congregation:c.congregation,time:c.visitTime})),[p,r]),O=c=>{H(ee=>ee.includes(c)?ee.filter(ie=>ie!==c):[...ee,c])},G=()=>{if(!i)return 0;const c=1+T.length;return(i/c).toFixed(2)},te=()=>{const c={visitId:r.visitId,transportMode:l,departureTime:g||void 0,arrivalTime:o||void 0,departureLocation:N||void 0,arrivalLocation:C||void 0,distance:v||void 0,duration:w||void 0,estimatedCost:i||void 0,carpoolPartners:l==="carpool"?T:void 0,notes:_||void 0,mapLink:V||void 0,bookingReference:q||void 0};x(c),h()};return e.jsx(ve,{isOpen:t,onClose:h,title:"Coordination du voyage",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-primary-50 to-blue-50 dark:from-primary-900/20 dark:to-blue-900/20 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:r.nom}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[new Date(r.visitDate).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})," ","√† ",r.visitTime]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Mode de transport"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:bt.map(c=>e.jsxs("button",{onClick:()=>n(c.value),className:`p-4 rounded-lg border-2 transition-all ${l===c.value?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx(c.icon,{className:`w-6 h-6 mx-auto mb-2 ${l===c.value?"text-primary-600":"text-gray-400"}`}),e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c.label})]},c.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(we,{className:"w-4 h-4 inline mr-1"}),"Heure de d√©part"]}),e.jsx("input",{type:"time",value:g,onChange:c=>D(c.target.value),"aria-label":"Heure de d√©part",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(we,{className:"w-4 h-4 inline mr-1"}),"Heure d'arriv√©e"]}),e.jsx("input",{type:"time",value:o,onChange:c=>S(c.target.value),"aria-label":"Heure d'arriv√©e",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline mr-1"}),"Lieu de d√©part"]}),e.jsx("input",{type:"text",value:N,onChange:c=>L(c.target.value),placeholder:"Adresse de d√©part",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline mr-1"}),"Lieu d'arriv√©e"]}),e.jsx("input",{type:"text",value:C,onChange:c=>z(c.target.value),placeholder:"Adresse d'arriv√©e",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Distance (km)"}),e.jsx("input",{type:"number",value:v||"",onChange:c=>A(c.target.value?Number(c.target.value):void 0),placeholder:"150",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Dur√©e estim√©e"}),e.jsx("input",{type:"text",value:w,onChange:c=>a(c.target.value),placeholder:"2h 30min",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(it,{className:"w-4 h-4 inline mr-1"}),"Co√ªt estim√© (‚Ç¨)"]}),e.jsx("input",{type:"number",value:i||"",onChange:c=>k(c.target.value?Number(c.target.value):void 0),placeholder:"50",step:"0.01",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),l==="carpool"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsx(dt,{className:"w-4 h-4 inline mr-1"}),"Partenaires de covoiturage"]}),T.length>0&&i&&e.jsxs(xe,{variant:"success",children:[G(),"‚Ç¨ / personne"]})]}),d.length===0?e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center text-sm text-gray-600 dark:text-gray-400",children:"Aucun orateur disponible pour le covoiturage ce jour-l√†"}):e.jsx("div",{className:"space-y-2",children:d.map(c=>e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsx("input",{type:"checkbox",checked:T.includes(c.visitId),onChange:()=>O(c.visitId),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:c.speakerName}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[c.congregation," ‚Ä¢ ",c.time]})]})]},c.visitId))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Lien Google Maps (optionnel)"}),e.jsx("input",{type:"url",value:V,onChange:c=>F(c.target.value),placeholder:"https://maps.google.com/...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(l==="train"||l==="plane")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"R√©f√©rence de r√©servation"}),e.jsx("input",{type:"text",value:q,onChange:c=>s(c.target.value),placeholder:"ABC123456",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes suppl√©mentaires"}),e.jsx("textarea",{value:_,onChange:c=>M(c.target.value),rows:3,placeholder:"Informations compl√©mentaires sur le voyage...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(v||w||i)&&e.jsx(fe,{className:"bg-blue-50 dark:bg-blue-900/20",children:e.jsxs(je,{children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-200 mb-2",children:"R√©sum√© du voyage"}),e.jsxs("div",{className:"space-y-1 text-sm text-blue-800 dark:text-blue-300",children:[v&&e.jsxs("p",{children:["‚Ä¢ Distance : ",v," km"]}),w&&e.jsxs("p",{children:["‚Ä¢ Dur√©e : ",w]}),i&&e.jsxs("p",{children:["‚Ä¢ Co√ªt : ",i,"‚Ç¨",l==="carpool"&&T.length>0&&e.jsxs("span",{children:[" (",G(),"‚Ç¨ / personne)"]})]}),l==="carpool"&&T.length>0&&e.jsxs("p",{children:["‚Ä¢ ",T.length+1," personne(s) dans le covoiturage"]})]})]})}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(y,{variant:"secondary",onClick:h,children:"Annuler"}),e.jsxs(y,{variant:"primary",onClick:te,children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Enregistrer le plan de voyage"]})]})]})})},ue=[{value:"breakfast",label:"Petit-d√©jeuner",icon:"üåÖ",defaultTime:"08:00"},{value:"lunch",label:"D√©jeuner",icon:"üçΩÔ∏è",defaultTime:"12:30"},{value:"dinner",label:"D√Æner",icon:"üåô",defaultTime:"19:00"},{value:"snack",label:"Collation",icon:"‚òï",defaultTime:"15:00"}],jt=["V√©g√©tarien","V√©g√©talien","Sans gluten","Sans lactose","Halal","Casher","Sans porc","Sans fruits de mer"],vt=["Arachides","Fruits √† coque","Lait","≈íufs","Poisson","Crustac√©s","Soja","Bl√©"],kt=({isOpen:t,onClose:h,visit:r,onSave:x,hosts:p=[]})=>{const[l,n]=b.useState([]),[g,D]=b.useState([]),[o,S]=b.useState([]),[N]=b.useState([]),[L,C]=b.useState(""),[z,v]=b.useState(""),[A,w]=b.useState(""),a=s=>{const d=ue.find(G=>G.value===s),O={id:`meal-${Date.now()}`,type:s,time:d?.defaultTime||"12:00",location:"",attendees:1};n([...l,O])},i=(s,d)=>{n(l.map(O=>O.id===s?{...O,...d}:O))},k=s=>{n(l.filter(d=>d.id!==s))},T=s=>{D(d=>d.includes(s)?d.filter(O=>O!==s):[...d,s])},H=s=>{S(d=>d.includes(s)?d.filter(O=>O!==s):[...d,s])},_=()=>{z.trim()&&(D([...g,z.trim()]),v(""))},M=()=>{A.trim()&&(S([...o,A.trim()]),w(""))},V=()=>{const s={visitId:r.visitId,meals:l,dietaryRestrictions:g,allergies:o,preferences:N,notes:L||void 0};x(s),h()},F=()=>l.reduce((s,d)=>s+(d.cost||0),0),q=s=>ue.find(d=>d.value===s)?.icon||"üçΩÔ∏è";return e.jsx(ve,{isOpen:t,onClose:h,title:"Planification des repas",size:"xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-orange-50 to-yellow-50 dark:from-orange-900/20 dark:to-yellow-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(he,{className:"w-5 h-5 text-orange-600"}),e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:r.nom})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:new Date(r.visitDate).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Restrictions alimentaires"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:jt.map(s=>e.jsx("button",{onClick:()=>T(s),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${g.includes(s)?"bg-orange-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:s},s))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:z,onChange:s=>v(s.target.value),onKeyPress:s=>s.key==="Enter"&&_(),placeholder:"Autre restriction...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),e.jsx(y,{variant:"outline",size:"sm",onClick:_,children:e.jsx(be,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4 text-red-600"}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Allergies (important !)"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:vt.map(s=>e.jsx("button",{onClick:()=>H(s),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${o.includes(s)?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:s},s))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:A,onChange:s=>w(s.target.value),onKeyPress:s=>s.key==="Enter"&&M(),placeholder:"Autre allergie...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),e.jsx(y,{variant:"outline",size:"sm",onClick:M,children:e.jsx(be,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Repas planifi√©s"}),e.jsx("div",{className:"flex gap-2",children:ue.map(s=>e.jsx(y,{variant:"outline",size:"sm",onClick:()=>a(s.value),title:`Ajouter ${s.label}`,children:e.jsx("span",{className:"text-lg",children:s.icon})},s.value))})]}),l.length===0?e.jsxs("div",{className:"p-8 text-center bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx(he,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Aucun repas planifi√©. Cliquez sur les ic√¥nes ci-dessus pour ajouter un repas."})]}):e.jsx("div",{className:"space-y-3",children:l.map(s=>e.jsx(fe,{children:e.jsx(je,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:q(s.type)}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:ue.find(d=>d.value===s.type)?.label})]}),e.jsx("button",{onClick:()=>k(s.id),"aria-label":"Supprimer ce repas",className:"p-1 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:e.jsx(_e,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Heure"}),e.jsx("input",{type:"time",value:s.time,onChange:d=>i(s.id,{time:d.target.value}),"aria-label":"Heure du repas",className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Nombre de personnes"}),e.jsx("input",{type:"number",value:s.attendees,onChange:d=>i(s.id,{attendees:Number(d.target.value)}),min:"1","aria-label":"Nombre de personnes",className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Lieu"}),e.jsx("input",{type:"text",value:s.location,onChange:d=>i(s.id,{location:d.target.value}),placeholder:"Restaurant, domicile, etc.",className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"H√¥te / Responsable"}),e.jsxs("select",{value:s.host||"",onChange:d=>i(s.id,{host:d.target.value}),className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"S√©lectionner un h√¥te..."}),p.map(d=>e.jsx("option",{value:d.nom,children:d.nom},d.nom))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Menu (optionnel)"}),e.jsx("input",{type:"text",value:s.menu||"",onChange:d=>i(s.id,{menu:d.target.value}),placeholder:"Description du menu",className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Co√ªt estim√© (‚Ç¨)"}),e.jsx("input",{type:"number",value:s.cost||"",onChange:d=>i(s.id,{cost:d.target.value?Number(d.target.value):void 0}),placeholder:"0.00",step:"0.01",className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]})})},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes suppl√©mentaires"}),e.jsx("textarea",{value:L,onChange:s=>C(s.target.value),rows:3,placeholder:"Pr√©f√©rences culinaires, informations compl√©mentaires...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(l.length>0||g.length>0||o.length>0)&&e.jsx(fe,{className:"bg-blue-50 dark:bg-blue-900/20",children:e.jsxs(je,{children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-200 mb-2",children:"R√©sum√©"}),e.jsxs("div",{className:"space-y-1 text-sm text-blue-800 dark:text-blue-300",children:[e.jsxs("p",{children:["‚Ä¢ ",l.length," repas planifi√©(s)"]}),g.length>0&&e.jsxs("p",{children:["‚Ä¢ ",g.length," restriction(s) alimentaire(s)"]}),o.length>0&&e.jsxs("p",{className:"text-red-600 dark:text-red-400 font-medium",children:["‚ö†Ô∏è ",o.length," allergie(s) √† prendre en compte"]}),F()>0&&e.jsxs("p",{children:["‚Ä¢ Co√ªt total estim√© : ",F().toFixed(2),"‚Ç¨"]})]})]})}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(y,{variant:"secondary",onClick:h,children:"Annuler"}),e.jsxs(y,{variant:"primary",onClick:V,children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Enregistrer le plan de repas"]})]})]})})},I={AVAILABILITY:40,GENDER_COUPLE_COUPLE:20,GENDER_SAME:15,GENDER_PARTIAL:10,CAPACITY_GOOD:15,CAPACITY_LIMITED:5,EQUIPMENT_PARKING:10,EQUIPMENT_ELEVATOR:5,PREFERENCE_PENALTY:10,EXPERIENCE_PER_HOST:5,MAX_EXPERIENCE:20,RECENT_HOST_PENALTY:10,LONG_TIME_AVAILABLE:10,DAYS_RECENT:30,DAYS_LONG_TIME:180,DAYS_IN_MS:864e5,SCORE_EXCELLENT:80,SCORE_GOOD:60,SCORE_ACCEPTABLE:40,MIN_CAPACITY:2},Nt=({isOpen:t,onClose:h,visit:r,speaker:x,onSelectHost:p})=>{const{hosts:l,visits:n}=Ee(),[g,D]=b.useState(null),[o,S]=b.useState(!0),N=b.useMemo(()=>{const v=[];return l.forEach(A=>{let w=0;const a=[],i=[],{AVAILABILITY:k}=I;if(!A.unavailableDates?.includes(r.visitDate))w+=k,a.push({factor:"Disponible √† cette date",score:k,positive:!0});else if(i.push("Indisponible √† cette date"),o)return;x&&(x.gender==="couple"&&A.gender==="couple"?(w+=I.GENDER_COUPLE_COUPLE,a.push({factor:"Couple accueille couple",score:I.GENDER_COUPLE_COUPLE,positive:!0})):x.gender===A.gender?(w+=I.GENDER_SAME,a.push({factor:"Genre compatible",score:I.GENDER_SAME,positive:!0})):(x.gender==="couple"||A.gender==="couple")&&(w+=I.GENDER_PARTIAL,a.push({factor:"Genre partiellement compatible",score:I.GENDER_PARTIAL,positive:!0}))),A.capacity&&(A.capacity>=I.MIN_CAPACITY?(w+=I.CAPACITY_GOOD,a.push({factor:`Capacit√©: ${A.capacity} personne(s)`,score:I.CAPACITY_GOOD,positive:!0})):a.push({factor:"Capacit√© limit√©e (1 personne)",score:I.CAPACITY_LIMITED,positive:!1})),A.hasParking&&(w+=I.EQUIPMENT_PARKING,a.push({factor:"Parking disponible",score:I.EQUIPMENT_PARKING,positive:!0})),A.hasElevator&&(w+=I.EQUIPMENT_ELEVATOR,a.push({factor:"Ascenseur disponible",score:I.EQUIPMENT_ELEVATOR,positive:!0})),x?.isVehiculed&&!A.hasParking&&(i.push("Orateur v√©hicul√© mais pas de parking"),w-=I.PREFERENCE_PENALTY),A.hasPets&&(a.push({factor:"Animaux de compagnie",score:0,positive:!1}),i.push("Pr√©sence d'animaux"));const H=n.filter(M=>M.host===A.nom&&M.status==="completed");if(H.length>0){const M=Math.min(H.length*I.EXPERIENCE_PER_HOST,I.MAX_EXPERIENCE);w+=M,a.push({factor:`${H.length} accueil(s) r√©ussi(s)`,score:M,positive:!0})}const _=H.sort((M,V)=>new Date(V.visitDate).getTime()-new Date(M.visitDate).getTime())[0];if(_){const M=Math.floor((new Date(r.visitDate).getTime()-new Date(_.visitDate).getTime())/I.DAYS_IN_MS);M<I.DAYS_RECENT?(i.push("A accueilli r√©cemment"),w-=I.RECENT_HOST_PENALTY):M>I.DAYS_LONG_TIME&&(w+=I.LONG_TIME_AVAILABLE,a.push({factor:"Disponible depuis longtemps",score:I.LONG_TIME_AVAILABLE,positive:!0}))}v.push({host:A,score:Math.max(0,w),compatibility:a,warnings:i})}),v.sort((A,w)=>w.score-A.score)},[l,n,r,x,o]),L=()=>{g&&(p(g),h())},C=v=>v>=I.SCORE_EXCELLENT?"text-green-600 bg-green-100 dark:bg-green-900/20":v>=I.SCORE_GOOD?"text-blue-600 bg-blue-100 dark:bg-blue-900/20":v>=I.SCORE_ACCEPTABLE?"text-orange-600 bg-orange-100 dark:bg-orange-900/20":"text-red-600 bg-red-100 dark:bg-red-900/20",z=v=>v>=I.SCORE_EXCELLENT?"Excellent match":v>=I.SCORE_GOOD?"Bon match":v>=I.SCORE_ACCEPTABLE?"Match acceptable":"Match faible";return e.jsx(ve,{isOpen:t,onClose:h,title:"Matching intelligent h√¥te/orateur",size:"xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-primary-50 to-purple-50 dark:from-primary-900/20 dark:to-purple-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Oe,{className:"w-5 h-5 text-primary-600"}),e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:r.nom})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:new Date(r.visitDate).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})}),x&&e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx(xe,{variant:"default",children:x.gender==="male"?"Homme":x.gender==="female"?"Femme":"Couple"}),x.isVehiculed&&e.jsx(xe,{variant:"default",children:"V√©hicul√©"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:v=>S(v.target.checked),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Afficher uniquement les h√¥tes disponibles"})]}),e.jsxs(xe,{variant:"default",children:[N.length," h√¥te(s) trouv√©(s)"]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:N.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(me,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Aucun h√¥te trouv√©"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Essayez de d√©sactiver le filtre de disponibilit√©"})]}):N.map(v=>e.jsx(fe,{hoverable:!0,className:`cursor-pointer transition-all ${g?.nom===v.host.nom?"ring-2 ring-primary-500 bg-primary-50 dark:bg-primary-900/20":""}`,onClick:()=>D(v.host),children:e.jsx(je,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center text-purple-700 dark:text-purple-300 font-bold text-lg",children:v.host.nom.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:v.host.nom}),e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:v.host.address&&e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-3 h-3"}),v.host.address]})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full ${C(v.score)}`,children:[e.jsx(He,{className:"w-4 h-4"}),e.jsx("span",{className:"text-lg font-bold",children:v.score})]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:z(v.score)})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:v.compatibility.map((A,w)=>e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded text-xs ${A.positive?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300":"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-300"}`,children:[A.positive?e.jsx(de,{className:"w-3 h-3"}):e.jsx(We,{className:"w-3 h-3"}),A.factor]},w))}),v.warnings.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:v.warnings.map((A,w)=>e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded text-xs bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-300",children:[e.jsx(ge,{className:"w-3 h-3"}),A]},w))}),v.host.notes&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:['"',v.host.notes,'"']})]})})},v.host.nom))}),g&&e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(me,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx("strong",{children:"H√¥te s√©lectionn√© :"})," ",g.nom,g.telephone&&e.jsxs("div",{className:"mt-1",children:["T√©l√©phone : ",g.telephone]}),g.email&&e.jsxs("div",{className:"mt-1",children:["Email : ",g.email]})]})]})}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(y,{variant:"secondary",onClick:h,children:"Annuler"}),e.jsxs(y,{variant:"primary",onClick:L,disabled:!g,children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"S√©lectionner cet h√¥te"]})]})]})})};var ye={exports:{}},wt=ye.exports,De;function Ct(){return De||(De=1,(function(t,h){(function(r,x){t.exports=x(at())})(typeof self<"u"?self:wt,function(r){return(function(){var x={155:function(a){a.exports=r}},p={};function l(a){var i=p[a];if(i!==void 0)return i.exports;var k=p[a]={exports:{}};return x[a](k,k.exports,l),k.exports}l.d=function(a,i){for(var k in i)l.o(i,k)&&!l.o(a,k)&&Object.defineProperty(a,k,{enumerable:!0,get:i[k]})},l.o=function(a,i){return Object.prototype.hasOwnProperty.call(a,i)},l.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var n={};l.r(n),l.d(n,{useReactToPrint:function(){return w}});var g=l(155);const D="printWindow";function o({level:a="error",messages:i,suppressErrors:k=!1}){k||(a==="error"?console.error(i):a==="warning"?console.warn(i):console.debug(i))}function S(a,i){if(i||!a){const k=document.getElementById(D);k&&document.body.removeChild(k)}}function N(a){return a instanceof Error?a:new Error("Unknown Error")}function L(a,i){const{documentTitle:k,onAfterPrint:T,onPrintError:H,preserveAfterPrint:_,print:M,suppressErrors:V}=i;setTimeout(()=>{var F,q;if(a.contentWindow){let s=function(){T?.(),S(_)};if(a.contentWindow.focus(),M)M(a).then(s).catch(d=>{H?H("print",N(d)):o({messages:["An error was thrown by the specified `print` function"],suppressErrors:V})});else{if(a.contentWindow.print){const d=(q=(F=a.contentDocument)===null||F===void 0?void 0:F.title)!==null&&q!==void 0?q:"",O=a.ownerDocument.title;k&&(a.ownerDocument.title=k,a.contentDocument&&(a.contentDocument.title=k)),a.contentWindow.print(),k&&(a.ownerDocument.title=O,a.contentDocument&&(a.contentDocument.title=d))}else o({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:V});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(d=>{var O,G;return((G=(O=navigator.userAgent)!==null&&O!==void 0?O:navigator.vendor)!==null&&G!==void 0?G:"opera"in window&&window.opera).match(d)})?setTimeout(s,500):s()}}else o({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:V})},500)}function C(a){const i=[],k=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,null);let T=k.nextNode();for(;T;)i.push(T),T=k.nextNode();return i}function z(a,i,k){const T=C(a),H=C(i);if(T.length===H.length)for(let _=0;_<T.length;_++){const M=T[_],V=H[_],F=M.shadowRoot;if(F!==null){const q=V.attachShadow({mode:F.mode});q.innerHTML=F.innerHTML,z(F,q,k)}}else o({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",a,i],suppressErrors:k})}const v=`
    @page {
        /* Remove browser default header (title) and footer (url) */
        margin: 0;
    }
    @media print {
        body {
            /* Tell browsers to print background colors */
            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */
            print-color-adjust: exact; /* Firefox/Safari */
            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
        }
    }
`;function A(a,i,k,T){var H,_,M,V,F;const{contentNode:q,clonedContentNode:s,clonedImgNodes:d,clonedVideoNodes:O,numResourcesToLoad:G,originalCanvasNodes:te}=k,{bodyClass:c,fonts:ee,ignoreGlobalStyles:ie,pageStyle:re,nonce:u,suppressErrors:f,copyShadowRoots:Y}=T;a.onload=null;const m=(H=a.contentDocument)!==null&&H!==void 0?H:(_=a.contentWindow)===null||_===void 0?void 0:_.document;if(m){const E=m.body.appendChild(s);Y&&z(q,E,!!f),ee&&(!((M=a.contentDocument)===null||M===void 0)&&M.fonts&&(!((V=a.contentWindow)===null||V===void 0)&&V.FontFace)?ee.forEach(P=>{const j=new FontFace(P.family,P.source,{weight:P.weight,style:P.style});a.contentDocument.fonts.add(j),j.loaded.then(()=>{i(j)}).catch(W=>{i(j,["Failed loading the font:",j,"Load error:",N(W)])})}):(ee.forEach(P=>{i(P)}),o({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:f})));const se=re??v,$=m.createElement("style");u&&($.setAttribute("nonce",u),m.head.setAttribute("nonce",u)),$.appendChild(m.createTextNode(se)),m.head.appendChild($),c&&m.body.classList.add(...c.split(" "));const Q=m.querySelectorAll("canvas");for(let P=0;P<te.length;++P){const j=te[P],W=Q[P];if(W===void 0){o({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",j],suppressErrors:f});continue}const R=W.getContext("2d");R&&R.drawImage(j,0,0)}for(let P=0;P<d.length;P++){const j=d[P],W=j.getAttribute("src");if(W){const R=new Image;R.onload=()=>{i(j)},R.onerror=(B,X,ae,J,ne)=>{i(j,["Error loading <img>",j,"Error",ne])},R.src=W}else i(j,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',j])}for(let P=0;P<O.length;P++){const j=O[P];j.preload="auto";const W=j.getAttribute("poster");if(W){const R=new Image;R.onload=()=>{i(j)},R.onerror=(B,X,ae,J,ne)=>{i(j,["Error loading video poster",W,"for video",j,"Error:",ne])},R.src=W}else j.readyState>=2?i(j):j.src?(j.onloadeddata=()=>{i(j)},j.onerror=(R,B,X,ae,J)=>{i(j,["Error loading video",j,"Error",J])},j.onstalled=()=>{i(j,["Loading video stalled, skipping",j])}):i(j,["Error loading video, `src` is empty",j])}const ce="select",Z=q.querySelectorAll(ce),oe=m.querySelectorAll(ce);for(let P=0;P<Z.length;P++)oe[P].value=Z[P].value;if(!ie){const P=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let j=0,W=P.length;j<W;++j){const R=P[j];if(R.tagName.toLowerCase()==="style"){const B=m.createElement(R.tagName),X=R.sheet;if(X){let ae="";try{const J=X.cssRules.length;for(let ne=0;ne<J;++ne)typeof X.cssRules[ne].cssText=="string"&&(ae+=`${X.cssRules[ne].cssText}\r
`)}catch(J){o({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",R,`Original error: ${N(J).message}`],level:"warning"})}B.setAttribute("id",`react-to-print-${j}`),u&&B.setAttribute("nonce",u),B.appendChild(m.createTextNode(ae)),m.head.appendChild(B)}}else if(R.getAttribute("href"))if(R.hasAttribute("disabled"))o({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",R],level:"warning"}),i(R);else{const B=m.createElement(R.tagName);for(let X=0,ae=R.attributes.length;X<ae;++X){const J=R.attributes[X];J&&B.setAttribute(J.nodeName,(F=J.nodeValue)!==null&&F!==void 0?F:"")}B.onload=()=>{i(B)},B.onerror=(X,ae,J,ne,Be)=>{i(B,["Failed to load",B,"Error:",Be])},u&&B.setAttribute("nonce",u),m.head.appendChild(B)}else o({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",R],level:"warning"}),i(R)}}}G===0&&L(a,T)}function w({bodyClass:a,contentRef:i,copyShadowRoots:k,documentTitle:T,fonts:H,ignoreGlobalStyles:_,nonce:M,onAfterPrint:V,onBeforePrint:F,onPrintError:q,pageStyle:s,preserveAfterPrint:d,print:O,printIframeProps:G,suppressErrors:te}){return(0,g.useCallback)(ee=>{function ie(){const re={bodyClass:a,contentRef:i,copyShadowRoots:k,documentTitle:T,fonts:H,ignoreGlobalStyles:_,nonce:M,onAfterPrint:V,onPrintError:q,pageStyle:s,preserveAfterPrint:d,print:O,suppressErrors:te},u=(function(m){const E=document.createElement("iframe");return E.width=`${document.documentElement.clientWidth}px`,E.height=`${document.documentElement.clientHeight}px`,E.style.position="absolute",E.style.top=`-${document.documentElement.clientHeight+100}px`,E.style.left=`-${document.documentElement.clientWidth+100}px`,E.id=D,E.srcdoc="<!DOCTYPE html>",m&&(m.allow&&(E.allow=m.allow),m.referrerPolicy!==void 0&&(E.referrerPolicy=m.referrerPolicy),m.sandbox!==void 0&&(E.sandbox=m.sandbox)),E})(G),f=(function(m,E){const{contentRef:se,fonts:$,ignoreGlobalStyles:Q,suppressErrors:ce}=E,Z=(function({contentRef:B,optionalContent:X,suppressErrors:ae}){return X&&typeof X=="function"?(B&&o({level:"warning",messages:['"react-to-print" received a `contentRef` option and an optional-content param passed to its callback. The `contentRef` option will be ignored.']}),X()):B?B.current:void o({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:ae})})({contentRef:se,optionalContent:m,suppressErrors:ce});if(!Z)return;const oe=Z.cloneNode(!0),P=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),j=oe.querySelectorAll("img"),W=oe.querySelectorAll("video"),R=$?$.length:0;return{contentNode:Z,clonedContentNode:oe,clonedImgNodes:j,clonedVideoNodes:W,numResourcesToLoad:(Q?0:P.length)+j.length+W.length+R,originalCanvasNodes:Z.querySelectorAll("canvas")}})(ee,re);if(!f)return void o({messages:["There is nothing to print"],suppressErrors:te});const Y=(function(m,E,se){const{suppressErrors:$}=m,Q=[],ce=[];return function(Z,oe){Q.includes(Z)?o({level:"debug",messages:["Tried to mark a resource that has already been handled",Z],suppressErrors:$}):(oe?(o({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...oe],suppressErrors:$}),ce.push(Z)):Q.push(Z),Q.length+ce.length===E&&L(se,m))}})(re,f.numResourcesToLoad,u);(function(m,E,se,$){m.onload=()=>{A(m,E,se,$)},document.body.appendChild(m)})(u,Y,f,re)}S(d,!0),F?F().then(()=>{ie()}).catch(re=>{q?.("onBeforePrint",N(re))}):ie()},[a,i,k,T,H,_,M,V,F,q,s,d,O,te])}return n})()})})(ye)),ye.exports}var Et=Ct();const At=({visit:t,speaker:h,host:r})=>{const x=b.useRef(null),p=Et.useReactToPrint({content:()=>x.current,documentTitle:`Feuille_de_route_${t.nom}_${t.visitDate}`}),l=n=>{try{return pe(ke(n),"EEEE d MMMM yyyy",{locale:Le})}catch{return n}};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end no-print",children:e.jsx(y,{onClick:p,leftIcon:e.jsx(ct,{className:"w-4 h-4"}),children:"Imprimer la feuille de route"})}),e.jsxs("div",{ref:x,className:"bg-white p-8 max-w-[210mm] mx-auto min-h-[297mm] shadow-sm print:shadow-none print:w-full print:max-w-none",children:[e.jsxs("div",{className:"border-b-2 border-gray-800 pb-6 mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold uppercase tracking-wider mb-2 text-gray-900",children:"Feuille de Route"}),e.jsx("p",{className:"text-xl text-gray-600",children:t.congregation}),e.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 bg-gray-100 px-4 py-2 rounded-lg",children:[e.jsx(Re,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold text-lg",children:l(t.visitDate)}),e.jsx("span",{className:"text-gray-400 mx-2",children:"|"}),e.jsx("span",{className:"font-semibold",children:t.visitTime})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 print:grid-cols-2 print:gap-8",children:[e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold uppercase border-b border-gray-300 pb-2 flex items-center gap-2 text-primary-700 print:text-black",children:[e.jsx(Oe,{className:"w-5 h-5"})," Orateur & Discours"]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-transparent print:border print:border-gray-200",children:[e.jsx("div",{className:"font-semibold text-lg mb-1",children:t.nom}),e.jsx("div",{className:"text-gray-600 mb-2",children:h?.email||"Email non renseign√©"}),e.jsx("div",{className:"text-gray-600 mb-4",children:h?.telephone||"Tel non renseign√©"}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-500 uppercase font-semibold",children:"Discours"}),e.jsxs("div",{className:"font-medium",children:["N¬∞",t.talkNoOrType||"Non d√©fini"]}),t.talkTheme&&e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:t.talkTheme})]})]})]}),t.meals&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold uppercase border-b border-gray-300 pb-2 flex items-center gap-2 text-primary-700 print:text-black",children:[e.jsx(Te,{className:"w-5 h-5"})," Repas"]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-transparent print:border print:border-gray-200",children:e.jsx("div",{className:"text-gray-700",children:t.meals})})]}),(r||t.logistics?.accommodation?.name)&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold uppercase border-b border-gray-300 pb-2 flex items-center gap-2 text-primary-700 print:text-black",children:[e.jsx(Te,{className:"w-5 h-5"})," H√©bergement"]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-transparent print:border print:border-gray-200",children:[r&&t.logistics?.accommodation?.type!=="hotel"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-semibold text-lg mb-1",children:r.nom}),e.jsxs("div",{className:"flex items-start gap-2 text-gray-600 mb-2",children:[e.jsx(le,{className:"w-4 h-4 mt-1 flex-shrink-0"}),e.jsx("span",{children:r.address})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(Ze,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:r.telephone})]}),e.jsx("div",{className:"text-sm text-gray-500 mt-2",children:r.notes&&e.jsxs("p",{className:"italic",children:['"',r.notes,'"']})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-semibold text-lg mb-1",children:t.logistics?.accommodation?.name}),e.jsxs("div",{className:"flex items-start gap-2 text-gray-600 mb-2",children:[e.jsx(le,{className:"w-4 h-4 mt-1 flex-shrink-0"}),e.jsx("span",{children:t.logistics?.accommodation?.address||"Adresse non renseign√©e"})]}),t.logistics?.accommodation?.bookingReference&&e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("strong",{children:"R√©f√©rence:"})," ",t.logistics.accommodation.bookingReference]}),e.jsx("div",{className:"text-sm text-gray-500 mt-2",children:t.logistics?.accommodation?.notes&&e.jsxs("p",{className:"italic",children:['"',t.logistics.accommodation.notes,'"']})})]}),t.logistics?.accommodation&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 text-sm grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block",children:"Check-in"}),e.jsx("span",{className:"font-medium",children:t.logistics.accommodation.checkIn?pe(ke(t.logistics.accommodation.checkIn),"dd/MM HH:mm"):"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block",children:"Check-out"}),e.jsx("span",{className:"font-medium",children:t.logistics.accommodation.checkOut?pe(ke(t.logistics.accommodation.checkOut),"dd/MM HH:mm"):"-"})]})]})]})]}),t.logistics?.itinerary&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold uppercase border-b border-gray-300 pb-2 flex items-center gap-2 text-primary-700 print:text-black",children:[e.jsx(Ce,{className:"w-5 h-5"})," Trajet"]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-transparent print:border print:border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Mode"}),e.jsx("div",{className:"font-medium capitalize",children:t.logistics.itinerary.transportMode})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Dur√©e estim√©e"}),e.jsx("div",{className:"font-medium",children:t.logistics.itinerary.duration||"-"})]})]}),t.logistics.itinerary.meetingPoint&&e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Point de RDV"}),e.jsx("div",{className:"font-medium",children:t.logistics.itinerary.meetingPoint})]})]})]}),t.logistics?.checklist&&t.logistics.checklist.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold uppercase border-b border-gray-300 pb-2 flex items-center gap-2 text-primary-700 print:text-black",children:[e.jsx(Fe,{className:"w-5 h-5"})," √Ä ne pas oublier"]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-transparent print:border print:border-gray-200",children:e.jsxs("ul",{className:"space-y-2",children:[t.logistics.checklist.filter(n=>!n.isCompleted).map(n=>e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-black rounded-sm print:block"}),e.jsx("span",{children:n.label})]},n.id)),t.logistics.checklist.every(n=>n.isCompleted)&&e.jsx("li",{className:"text-green-600 italic",children:"Toutes les t√¢ches logistiques sont compl√©t√©es."})]})})]})]}),e.jsx("div",{className:"mt-16 text-center text-sm text-gray-400 border-t pt-8 print:mt-auto print:absolute print:bottom-8 print:left-0 print:right-0",children:e.jsxs("p",{children:["G√©n√©r√© par KBV2 Manager - ",new Date().toLocaleDateString()]})})]})]})},Ht=({isOpen:t,onClose:h,visit:r,action:x})=>{const{updateVisit:p,deleteVisit:l,completeVisit:n,speakers:g,hosts:D}=Ee(),{addToast:o}=Xe(),{confirm:S}=Ke(),[N,L]=b.useState(!1),[C,z]=b.useState({}),[v,A]=b.useState(!1),[w,a]=b.useState(void 0),[i,k]=b.useState("accommodation"),[T,H]=b.useState(!1),[_,M]=b.useState(!1),[V,F]=b.useState(!1),[q,s]=b.useState({isOpen:!1,type:"confirmation"});if(b.useEffect(()=>{r&&z(r)},[r]),!r)return null;const d=async()=>{if(C){L(!0);try{await p({...r,...C}),o("Visite mise √† jour","success"),h()}catch{o("Erreur lors de la mise √† jour","error")}finally{L(!1)}}},O=async()=>{if(await S({title:"Supprimer la visite",message:"√ätes-vous s√ªr de vouloir supprimer cette visite ?",confirmText:"Supprimer",confirmVariant:"danger",cancelText:"Annuler"})){L(!0);try{await l(r.visitId),o("Visite supprim√©e","success"),h()}catch{o("Erreur lors de la suppression","error")}finally{L(!1)}}},G=async u=>{L(!0);try{u==="completed"?(await n(r),o("Visite termin√©e et archiv√©e","success")):(await p({...r,status:u}),o("Statut mis √† jour","success")),h()}catch{o("Erreur lors de la mise √† jour","error")}finally{L(!1)}},te=async u=>{L(!0);try{const f={...u,id:Ne(),visitId:r.visitId,submittedBy:"currentUser",submittedAt:new Date().toISOString()};await p({...r,visitFeedback:f}),o("Bilan enregistr√© avec succ√®s","success"),h()}catch{o("Erreur lors de l'enregistrement du bilan","error")}finally{L(!1)}},c=async u=>{L(!0);try{const f=r.expenses||[];let Y;w?Y=f.map(E=>E.id===w.id?{...u,id:w.id}:E):Y=[...f,{...u,id:Ne()}];const m={...r,expenses:Y};await p(m),z(m),o(w?"D√©pense modifi√©e":"D√©pense ajout√©e","success"),A(!1),a(void 0)}catch{o("Erreur lors de la sauvegarde de la d√©pense","error")}finally{L(!1)}},ee=async u=>{if(await S({title:"Supprimer la d√©pense",message:"Voulez-vous vraiment supprimer cette d√©pense ?",confirmText:"Supprimer",confirmVariant:"danger",cancelText:"Annuler"})){L(!0);try{const m=(r.expenses||[]).filter(se=>se.id!==u),E={...r,expenses:m};await p(E),z(E),o("D√©pense supprim√©e","success")}catch{o("Erreur lors de la suppression","error")}finally{L(!1)}}},ie=()=>{switch(x){case"edit":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5"}),"Modifier la visite"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(K,{label:"Date",type:"date",value:C.visitDate||"",onChange:u=>z(f=>({...f,visitDate:u.target.value}))}),e.jsx(K,{label:"Heure",type:"time",value:C.visitTime||"",onChange:u=>z(f=>({...f,visitTime:u.target.value}))}),e.jsx(K,{label:"N¬∞ Discours",value:C.talkNoOrType||"",onChange:u=>z(f=>({...f,talkNoOrType:u.target.value})),placeholder:"Ex: 185"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contact d'accueil"}),e.jsxs("select",{value:C.host||"",onChange:u=>{const{value:f}=u.target,Y=D.find(m=>m.nom===f);z(m=>{const E=m.logistics||{},$={...E.accommodation||{}};let Q=m.accommodation;return f==="H√¥tel"?($.type="hotel",$.type,Q=""):Y?($.type="host",$.name=Y.nom,$.address=Y.address,Q=Y.address||""):f==="Pas besoin"&&($.type="other",$.name="",$.address="",Q=""),{...m,host:f,accommodation:Q,logistics:{...E,accommodation:$}}})},title:"S√©lectionner un h√¥te",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"S√©lectionner un h√¥te..."}),e.jsx("option",{value:"Pas besoin",children:"Pas besoin"}),e.jsx("option",{value:"H√¥tel",children:"H√¥tel"}),D.map(u=>e.jsx("option",{value:u.nom,children:u.nom},u.nom))]})]}),e.jsx(K,{label:"Nombre d'accompagnateurs",type:"number",min:0,max:10,value:C.accompanyingPersons||0,onChange:u=>z(f=>({...f,accompanyingPersons:parseInt(u.target.value,10)||0})),placeholder:"0"})]}),e.jsx(K,{label:"Titre du discours",value:C.talkTheme||"",onChange:u=>z(f=>({...f,talkTheme:u.target.value})),placeholder:"Ex: Nega iluzon di mundu..."}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Statut de la visite"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(y,{variant:r.status==="pending"?"primary":"secondary",size:"sm",onClick:()=>G("pending"),disabled:N,leftIcon:e.jsx(ge,{className:"w-3 h-3"}),children:"En attente"}),e.jsx(y,{variant:r.status==="confirmed"?"primary":"secondary",size:"sm",onClick:()=>G("confirmed"),disabled:N,leftIcon:e.jsx(de,{className:"w-3 h-3"}),children:"Confirm√©"}),e.jsx(y,{variant:r.status==="completed"?"primary":"secondary",size:"sm",onClick:()=>G("completed"),disabled:N,leftIcon:e.jsx(de,{className:"w-3 h-3"}),children:"Termin√©"}),e.jsx(y,{variant:r.status==="cancelled"?"danger":"secondary",size:"sm",onClick:()=>G("cancelled"),disabled:N,leftIcon:e.jsx(ge,{className:"w-3 h-3"}),children:"Annul√©"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["Statut actuel: ",e.jsx("span",{className:"font-medium capitalize",children:r.status})]})]}),e.jsx(K,{label:"Notes",value:C.notes||"",onChange:u=>z(f=>({...f,notes:u.target.value}))}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg text-sm text-gray-600 dark:text-gray-400",children:`üí° Pour g√©rer le logement et les repas, utilisez l'onglet "Logistique" du menu`})]});case"delete":return e.jsxs("div",{className:"text-center py-6",children:[e.jsx(Ae,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Supprimer la visite"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["√ätes-vous s√ªr de vouloir supprimer la visite de ",e.jsx("strong",{children:r.nom}),"du ",new Date(r.visitDate).toLocaleDateString("fr-FR")," ?"]}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:"Cette action est irr√©versible."})]});case"status":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5"}),"Changer le statut"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Statut actuel: ",e.jsx("span",{className:"font-medium",children:r.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{variant:"secondary",onClick:()=>G("pending"),className:"w-full justify-start",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),children:"Marquer en attente"}),e.jsx(y,{variant:"secondary",onClick:()=>G("confirmed"),className:"w-full justify-start",leftIcon:e.jsx(de,{className:"w-4 h-4"}),children:"Confirmer"}),e.jsx(y,{variant:"secondary",onClick:()=>G("completed"),className:"w-full justify-start",leftIcon:e.jsx(de,{className:"w-4 h-4"}),children:"Marquer comme termin√©"}),e.jsx(y,{variant:"danger",onClick:()=>G("cancelled"),className:"w-full justify-start",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),children:"Annuler"})]})]})]});case"message":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Qe,{className:"w-5 h-5"}),"G√©n√©rer un message"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Choisissez un type de message pour ouvrir l'assistant de r√©daction :"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx(y,{variant:"secondary",onClick:()=>s({isOpen:!0,type:"confirmation"}),className:"w-full justify-start",children:"Message de confirmation"}),e.jsx(y,{variant:"secondary",onClick:()=>s({isOpen:!0,type:"preparation"}),className:"w-full justify-start",children:"Message de pr√©paration"}),e.jsx(y,{variant:"secondary",onClick:()=>s({isOpen:!0,type:"reminder-7"}),className:"w-full justify-start",children:"Rappel J-7"}),e.jsx(y,{variant:"secondary",onClick:()=>s({isOpen:!0,type:"reminder-2"}),className:"w-full justify-start",children:"Rappel J-2"}),e.jsx(y,{variant:"secondary",onClick:()=>s({isOpen:!0,type:"thanks"}),className:"w-full justify-start",children:"Message de remerciement"}),e.jsx(y,{variant:"secondary",onClick:()=>s({isOpen:!0,type:"host_request"}),className:"w-full justify-start",children:"Demande d'accueil"})]})]});case"feedback":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(He,{className:"w-5 h-5 text-yellow-500"}),"Bilan de la visite"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Utilisez la modale de feedback pour √©valuer cette visite."})]});case"expenses":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(lt,{className:"w-5 h-5 text-green-600"}),"Gestion des co√ªts"]}),v||w?e.jsx(gt,{initialData:w,onSubmit:c,onCancel:()=>{A(!1),a(void 0)}}):e.jsx($e,{expenses:C.expenses||[],onAdd:()=>A(!0),onEdit:a,onDelete:ee,readOnly:N})]});case"logistics":{const u={...r,...C},f=u.logistics?.accommodation||{},Y=(f.type||"host")==="host";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ce,{className:"w-5 h-5 text-blue-600"}),"Logistique"]}),e.jsx(yt,{logistics:{...u.logistics,accommodation:{...f,type:f.type||"host",name:Y?u.host||f.name||"":f.name||"",address:Y?u.accommodation||f.address||"":f.address||""}},onUpdate:m=>{z(E=>({...E,logistics:m,host:m.accommodation?.type==="host"&&m.accommodation?.name||E.host,accommodation:m.accommodation?.type==="host"&&m.accommodation?.address||E.accommodation}))},readOnly:N,hosts:D}),e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Documents"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:e.jsx(At,{visit:u,speaker:g.find(m=>m.id===u.id),host:D.find(m=>m.nom===u.host)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{variant:"outline",onClick:()=>H(!0),leftIcon:e.jsx(Ce,{className:"w-4 h-4"}),children:"Organiser le transport"}),e.jsx(y,{variant:"outline",onClick:()=>M(!0),leftIcon:e.jsx(he,{className:"w-4 h-4"}),children:"Planifier les repas"}),e.jsx(y,{variant:"outline",onClick:()=>F(!0),leftIcon:e.jsx(me,{className:"w-4 h-4"}),children:"G√©rer l'h√©bergement"})]})]})}default:return null}},re=()=>{switch(x){case"edit":case"logistics":return e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"ghost",onClick:h,disabled:N,children:"Annuler"}),e.jsx(y,{onClick:d,isLoading:N,children:"Enregistrer"})]});case"delete":return e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"ghost",onClick:h,disabled:N,children:"Annuler"}),e.jsx(y,{variant:"danger",onClick:O,isLoading:N,children:"Supprimer"})]});case"feedback":case"expenses":return null;case"message":return e.jsx(y,{variant:"ghost",onClick:h,disabled:N,children:"Fermer"})}};return x==="feedback"&&r?e.jsx(et,{isOpen:t,onClose:h,visit:r,onSubmit:te}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{isOpen:t,onClose:h,size:x==="logistics"?"xl":"md",footer:re(),children:ie()}),T&&e.jsx(ft,{isOpen:T,onClose:()=>H(!1),visit:r,onSave:()=>{}}),_&&e.jsx(kt,{isOpen:_,onClose:()=>M(!1),visit:r,onSave:()=>{}}),V&&e.jsx(Nt,{isOpen:V,onClose:()=>F(!1),visit:r,onSelectHost:()=>{}}),q.isOpen&&e.jsx(st,{isOpen:q.isOpen,onClose:()=>s(u=>({...u,isOpen:!1})),speaker:g.find(u=>u.id===r.id)||{id:r.id,nom:r.nom,congregation:r.congregation||"",gender:"male",talkHistory:[]},visit:r,initialType:q.type})]})};export{lt as C,ot as E,ze as P,Ce as T,Ht as V,ge as X,Et as l};
//# sourceMappingURL=VisitActionModal-DKUFiQqS.js.map
