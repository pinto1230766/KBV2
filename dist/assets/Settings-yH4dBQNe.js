import {
  c as H,
  u as ne,
  j as e,
  k as ie,
  m as Q,
  f as U,
  g as q,
  i as Y,
  l as xe,
  B as L,
  D as ae,
  F as Le,
  S as Pe,
  C as $e,
  X as Re,
  U as ke,
  A as Ue,
  t as qe,
  a as Ge,
  x as pe,
  h as _,
  w as Ve,
} from './index-D4MkNNtG.js';
import { r as h, R as He } from './charts-CCOFnOOy.js';
import { P as oe, M as Be, U as de, I as X, S as re } from './Select-Cs8xHSai.js';
import { T as Ne, S as me } from './trash-2-avPRzuE0.js';
import { a as K, C as ue } from './copy-DwuKvwjM.js';
import { A as ce, a as Je, R as _e } from './rotate-ccw-Da3qZHF_.js';
import { L as Ke } from './link-BcWZK_UP.js';
import './react-vendor-B9D_A6Vq.js';
import './utils-FTT-aY8U.js';
const te = H('Database', [
  ['ellipse', { cx: '12', cy: '5', rx: '9', ry: '3', key: 'msslwz' }],
  ['path', { d: 'M3 5V19A9 3 0 0 0 21 19V5', key: '1wlel7' }],
  ['path', { d: 'M3 12A9 3 0 0 0 21 12', key: 'mv7ke4' }],
]);
const ye = H('HardDrive', [
  ['line', { x1: '22', x2: '2', y1: '12', y2: '12', key: '1y58io' }],
  [
    'path',
    {
      d: 'M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z',
      key: 'oot6mr',
    },
  ],
  ['line', { x1: '6', x2: '6.01', y1: '16', y2: '16', key: 'sgf278' }],
  ['line', { x1: '10', x2: '10.01', y1: '16', y2: '16', key: '1l4acy' }],
]);
const be = H('Key', [
  ['circle', { cx: '7.5', cy: '15.5', r: '5.5', key: 'yqb3hr' }],
  ['path', { d: 'm21 2-9.6 9.6', key: '1j0ho8' }],
  ['path', { d: 'm15.5 7.5 3 3L22 7l-3-3', key: '1rn1fs' }],
]);
const Ye = H('Merge', [
  ['path', { d: 'm8 6 4-4 4 4', key: 'ybng9g' }],
  ['path', { d: 'M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22', key: '1hyw0i' }],
  ['path', { d: 'm20 22-5-5', key: '1m27yz' }],
]);
const We = H('Monitor', [
  ['rect', { width: '20', height: '14', x: '2', y: '3', rx: '2', key: '48i651' }],
  ['line', { x1: '8', x2: '16', y1: '21', y2: '21', key: '1svkeh' }],
  ['line', { x1: '12', x2: '12', y1: '17', y2: '21', key: 'vw1qmm' }],
]);
const Xe = H('Moon', [['path', { d: 'M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z', key: 'a7tn18' }]]);
const je = H('Palette', [
  ['circle', { cx: '13.5', cy: '6.5', r: '.5', key: '1xcu5' }],
  ['circle', { cx: '17.5', cy: '10.5', r: '.5', key: '736e4u' }],
  ['circle', { cx: '8.5', cy: '7.5', r: '.5', key: 'clrty' }],
  ['circle', { cx: '6.5', cy: '12.5', r: '.5', key: '1s4xz9' }],
  [
    'path',
    {
      d: 'M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z',
      key: '12rzf8',
    },
  ],
]);
const le = H('Shield', [
  ['path', { d: 'M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10', key: '1irkt0' }],
]);
const Ze = H('Smartphone', [
  ['rect', { width: '14', height: '20', x: '5', y: '2', rx: '2', ry: '2', key: '1yt0o3' }],
  ['path', { d: 'M12 18h.01', key: 'mhygvu' }],
]);
const Qe = H('Sun', [
  ['circle', { cx: '12', cy: '12', r: '4', key: '4exip2' }],
  ['path', { d: 'M12 2v2', key: 'tus03m' }],
  ['path', { d: 'M12 20v2', key: '1lh1kg' }],
  ['path', { d: 'm4.93 4.93 1.41 1.41', key: '149t6j' }],
  ['path', { d: 'm17.66 17.66 1.41 1.41', key: 'ptbguv' }],
  ['path', { d: 'M2 12h2', key: '1t8f8n' }],
  ['path', { d: 'M20 12h2', key: '1q8mjw' }],
  ['path', { d: 'm6.34 17.66-1.41 1.41', key: '1m8zz5' }],
  ['path', { d: 'm19.07 4.93-1.41 1.41', key: '1shlcs' }],
]);
const ee = H('Upload', [
    ['path', { d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4', key: 'ih7n3h' }],
    ['polyline', { points: '17 8 12 3 7 8', key: 't8dd8p' }],
    ['line', { x1: '12', x2: '12', y1: '3', y2: '15', key: 'widbto' }],
  ]),
  es = ({ isOpen: T, onClose: v, onMerge: I }) => {
    const { speakers: i, hosts: g, visits: c, speakerMessages: S, archivedVisits: P } = ne(),
      [k, O] = h.useState(new Set()),
      [p, R] = h.useState('keep-recent'),
      [y, M] = h.useState(!1),
      d = 95,
      f = 90,
      b = h.useMemo(() => {
        const s = [],
          n = new Map();
        (i.forEach((r) => {
          const m = r.nom.toLowerCase().trim().replace(/\s+/g, ' ');
          (n.has(m) || n.set(m, []), n.get(m).push(r));
        }),
          n.forEach((r) => {
            if (r.length > 1) {
              const j = ['Nom identique'],
                m = r.map(($) => $.telephone).filter(Boolean);
              m.length > 1 && new Set(m).size < m.length && j.push('Téléphone identique');
              const F = r.map(($) => $.congregation);
              new Set(F).size === 1 && j.push('Même congrégation');
              const B = d;
              s.push({ type: 'speaker', items: r, similarity: B, reason: j });
            }
          }));
        const a = new Map();
        (g.forEach((r) => {
          const m = r.nom.toLowerCase().trim().replace(/\s+/g, ' ');
          (a.has(m) || a.set(m, []), a.get(m).push(r));
        }),
          a.forEach((r) => {
            if (r.length > 1) {
              const j = ['Nom identique'],
                m = r.map(($) => $.telephone).filter(Boolean);
              m.length > 1 && new Set(m).size < m.length && j.push('Téléphone identique');
              const F = r.map(($) => $.address).filter(Boolean);
              F.length > 1 && new Set(F).size < F.length && j.push('Adresse identique');
              const B = d;
              s.push({ type: 'host', items: r, similarity: B, reason: j });
            }
          }));
        const l = new Map();
        if (
          (c.forEach((r) => {
            const j = `${r.id}-${r.visitDate}-${r.visitTime}`;
            (l.has(j) || l.set(j, []), l.get(j).push(r));
          }),
          l.forEach((r) => {
            r.length > 1 &&
              s.push({
                type: 'visit',
                items: r,
                similarity: 100,
                reason: ['Même orateur, date et heure'],
              });
          }),
          y && P)
        ) {
          const r = new Map();
          (P.forEach((m) => {
            const F = `${m.id}-${m.visitDate}-${m.visitTime}`;
            (r.has(F) || r.set(F, []), r.get(F).push(m));
          }),
            r.forEach((m) => {
              m.length > 1 &&
                s.push({
                  type: 'archivedVisit',
                  items: m,
                  similarity: 100,
                  reason: ['Doublon dans les archives - Même orateur, date et heure'],
                });
            }));
          const j = new Map();
          (c.forEach((m) => {
            const F = `${m.id}-${m.visitDate}-${m.visitTime}`;
            (j.has(F) || j.set(F, []),
              j.get(F).push({ ...m, _source: 'current' }),
              P.filter(
                ($) => $.id === m.id && $.visitDate === m.visitDate && $.visitTime === m.visitTime
              ).forEach(($) => {
                j.get(F).push({ ...$, _source: 'archived' });
              }));
          }),
            j.forEach((m) => {
              m.length > 1 &&
                s.push({
                  type: 'archivedVisit',
                  items: m,
                  similarity: 100,
                  reason: ['Doublon entre visites actuelles et archivées'],
                });
            }));
        }
        const o = new Map();
        return (
          S &&
            S.length > 0 &&
            S.forEach((r) => {
              const j = r.message?.trim().toLowerCase() || '',
                m = r.receivedAt ? new Date(r.receivedAt).toISOString() : 'no-date',
                F = `${r.speakerId}-${j}-${m}`;
              (o.has(F) || o.set(F, []), o.get(F).push(r));
            }),
          o.forEach((r) => {
            r.length > 1 &&
              s.push({
                type: 'message',
                items: r,
                similarity: 100,
                reason: ['Contenu et date identiques'],
              });
          }),
          s
        );
      }, [i, g, c, S, P, y]),
      x = (s) => {
        O((n) => {
          const a = new Set(n);
          return (a.has(s) ? a.delete(s) : a.add(s), a);
        });
      },
      E = () => {
        const s = Array.from(k).map((n) => b[n]);
        (I(s, 'merge', p), O(new Set()));
      },
      N = () => {
        const s = Array.from(k).map((n) => b[n]);
        (I(s, 'delete', p), O(new Set()));
      },
      A = (s) => {
        switch (s) {
          case 'speaker':
            return 'Orateur';
          case 'host':
            return 'Hôte';
          case 'visit':
            return 'Visite';
          case 'archivedVisit':
            return 'Visite archivée';
          case 'message':
            return 'Message';
          default:
            return 'Inconnu';
        }
      },
      z = (s) => {
        switch (s) {
          case 'speaker':
            return 'bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300';
          case 'host':
            return 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300';
          case 'visit':
            return 'bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-300';
          case 'archivedVisit':
            return 'bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-300';
          case 'message':
            return 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300';
          default:
            return 'bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-300';
        }
      };
    return e.jsx(ie, {
      isOpen: T,
      onClose: v,
      title: 'Détection de doublons',
      size: 'xl',
      children: e.jsxs('div', {
        className: 'space-y-6',
        children: [
          e.jsxs('div', {
            className: 'grid grid-cols-2 md:grid-cols-5 gap-4',
            children: [
              e.jsxs('div', {
                className: 'p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg',
                children: [
                  e.jsx('div', {
                    className: 'text-2xl font-bold text-blue-600',
                    children: b.filter((s) => s.type === 'speaker').length,
                  }),
                  e.jsx('div', {
                    className: 'text-sm text-blue-800 dark:text-blue-300',
                    children: 'Orateurs',
                  }),
                ],
              }),
              e.jsxs('div', {
                className: 'p-4 bg-green-50 dark:bg-green-900/20 rounded-lg',
                children: [
                  e.jsx('div', {
                    className: 'text-2xl font-bold text-green-600',
                    children: b.filter((s) => s.type === 'host').length,
                  }),
                  e.jsx('div', {
                    className: 'text-sm text-green-800 dark:text-green-300',
                    children: 'Hôtes',
                  }),
                ],
              }),
              e.jsxs('div', {
                className: 'p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg',
                children: [
                  e.jsx('div', {
                    className: 'text-2xl font-bold text-purple-600',
                    children: b.filter((s) => s.type === 'visit').length,
                  }),
                  e.jsx('div', {
                    className: 'text-sm text-purple-800 dark:text-purple-300',
                    children: 'Visites',
                  }),
                ],
              }),
              e.jsxs('div', {
                className: 'p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg',
                children: [
                  e.jsx('div', {
                    className: 'text-2xl font-bold text-orange-600',
                    children: b.filter((s) => s.type === 'archivedVisit').length,
                  }),
                  e.jsx('div', {
                    className: 'text-sm text-orange-800 dark:text-orange-300',
                    children: 'Archives',
                  }),
                ],
              }),
              e.jsxs('div', {
                className: 'p-4 bg-red-50 dark:bg-red-900/20 rounded-lg',
                children: [
                  e.jsx('div', {
                    className: 'text-2xl font-bold text-red-600',
                    children: b.filter((s) => s.type === 'message').length,
                  }),
                  e.jsx('div', {
                    className: 'text-sm text-red-800 dark:text-red-300',
                    children: 'Messages',
                  }),
                ],
              }),
            ],
          }),
          e.jsxs('div', {
            className: 'flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg',
            children: [
              e.jsx('input', {
                type: 'checkbox',
                id: 'include-archives',
                checked: y,
                onChange: (s) => M(s.target.checked),
                className:
                  'w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500',
              }),
              e.jsxs('label', {
                htmlFor: 'include-archives',
                className: 'cursor-pointer',
                children: [
                  e.jsx('div', {
                    className: 'font-medium text-gray-900 dark:text-white',
                    children: "Inclure les archives dans l'analyse",
                  }),
                  e.jsx('div', {
                    className: 'text-sm text-gray-600 dark:text-gray-400',
                    children:
                      'Détecte les doublons dans les visites archivées et entre visites actuelles/archivées',
                  }),
                ],
              }),
            ],
          }),
          k.size > 0 &&
            e.jsxs('div', {
              className: 'p-4 bg-gray-50 dark:bg-gray-800 rounded-lg',
              children: [
                e.jsx('label', {
                  className: 'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3',
                  children: 'Stratégie de fusion',
                }),
                e.jsxs('div', {
                  className: 'space-y-2',
                  children: [
                    e.jsxs('label', {
                      className: 'flex items-center gap-2 cursor-pointer',
                      children: [
                        e.jsx('input', {
                          type: 'radio',
                          value: 'keep-recent',
                          checked: p === 'keep-recent',
                          onChange: (s) => R(s.target.value),
                          className: 'w-4 h-4 text-primary-600',
                        }),
                        e.jsx('span', {
                          className: 'text-sm text-gray-700 dark:text-gray-300',
                          children: "Conserver l'entrée la plus récente",
                        }),
                      ],
                    }),
                    e.jsxs('label', {
                      className: 'flex items-center gap-2 cursor-pointer',
                      children: [
                        e.jsx('input', {
                          type: 'radio',
                          value: 'keep-first',
                          checked: p === 'keep-first',
                          onChange: (s) => R(s.target.value),
                          className: 'w-4 h-4 text-primary-600',
                        }),
                        e.jsx('span', {
                          className: 'text-sm text-gray-700 dark:text-gray-300',
                          children: 'Conserver la première entrée',
                        }),
                      ],
                    }),
                  ],
                }),
              ],
            }),
          e.jsx('div', {
            className: 'space-y-4 max-h-96 overflow-y-auto',
            children:
              b.length === 0
                ? e.jsxs('div', {
                    className: 'text-center py-12',
                    children: [
                      e.jsx(Q, { className: 'w-16 h-16 mx-auto mb-4 text-green-500' }),
                      e.jsx('h3', {
                        className: 'text-lg font-semibold text-gray-900 dark:text-white mb-2',
                        children: 'Aucun doublon détecté',
                      }),
                      e.jsx('p', {
                        className: 'text-gray-600 dark:text-gray-400',
                        children: 'Vos données sont propres et sans doublons',
                      }),
                    ],
                  })
                : e.jsxs(e.Fragment, {
                    children: [
                      e.jsxs('div', {
                        className:
                          'flex items-center gap-3 p-3 bg-gray-100 dark:bg-gray-800 rounded-lg mb-2 sticky top-0 z-10',
                        children: [
                          e.jsx('input', {
                            type: 'checkbox',
                            'aria-label': 'Tout sélectionner',
                            checked: b.length > 0 && k.size === b.length,
                            onChange: (s) => {
                              s.target.checked ? O(new Set(b.map((n, a) => a))) : O(new Set());
                            },
                            className:
                              'w-5 h-5 text-primary-600 border-gray-300 rounded focus:ring-primary-500',
                          }),
                          e.jsxs('span', {
                            className: 'font-medium text-gray-700 dark:text-gray-300',
                            children: ['Tout sélectionner (', b.length, ')'],
                          }),
                          k.size > 0 &&
                            e.jsxs('span', {
                              className: 'text-sm text-gray-500 ml-auto',
                              children: [k.size, ' sélectionné(s)'],
                            }),
                        ],
                      }),
                      b.map((s, n) =>
                        e.jsx(
                          U,
                          {
                            className: `${s.similarity >= f ? 'border-l-4 border-l-red-600' : 'border-l-4 border-l-orange-500'} ${k.has(n) ? 'ring-2 ring-primary-500' : ''}`,
                            children: e.jsx(q, {
                              children: e.jsxs('div', {
                                className: 'space-y-4',
                                children: [
                                  e.jsxs('div', {
                                    className: 'flex items-start justify-between',
                                    children: [
                                      e.jsxs('div', {
                                        className: 'flex items-center gap-3',
                                        children: [
                                          e.jsx('input', {
                                            type: 'checkbox',
                                            checked: k.has(n),
                                            onChange: () => x(n),
                                            'aria-label': `Sélectionner ce groupe de doublons ${A(s.type)}`,
                                            className:
                                              'w-5 h-5 text-primary-600 border-gray-300 rounded focus:ring-primary-500',
                                          }),
                                          e.jsxs('div', {
                                            children: [
                                              e.jsxs('div', {
                                                className: 'flex items-center gap-2 mb-1',
                                                children: [
                                                  e.jsx(Y, {
                                                    className: z(s.type),
                                                    children: A(s.type),
                                                  }),
                                                  e.jsxs(Y, {
                                                    variant: 'warning',
                                                    children: [s.similarity, '% similaire'],
                                                  }),
                                                ],
                                              }),
                                              e.jsx('div', {
                                                className: 'flex flex-wrap gap-1',
                                                children: s.reason.map((a, l) =>
                                                  e.jsxs(
                                                    'span',
                                                    {
                                                      className:
                                                        'text-xs text-gray-600 dark:text-gray-400',
                                                      children: ['• ', a],
                                                    },
                                                    l
                                                  )
                                                ),
                                              }),
                                            ],
                                          }),
                                        ],
                                      }),
                                      e.jsx(K, { className: 'w-5 h-5 text-gray-400' }),
                                    ],
                                  }),
                                  e.jsx('div', {
                                    className: 'grid grid-cols-1 md:grid-cols-2 gap-3',
                                    children: s.items.map((a, l) =>
                                      e.jsxs(
                                        'div',
                                        {
                                          className: 'p-3 bg-gray-50 dark:bg-gray-800 rounded-lg',
                                          children: [
                                            e.jsx('div', {
                                              className:
                                                'font-medium text-gray-900 dark:text-white mb-2',
                                              children:
                                                s.type === 'message'
                                                  ? a.subject || 'Message sans sujet'
                                                  : a.nom || `Visite ${l + 1}`,
                                            }),
                                            e.jsxs('div', {
                                              className:
                                                'space-y-1 text-sm text-gray-600 dark:text-gray-400',
                                              children: [
                                                s.type === 'speaker' &&
                                                  e.jsxs(e.Fragment, {
                                                    children: [
                                                      e.jsxs('div', {
                                                        children: [
                                                          'Congrégation : ',
                                                          a.congregation,
                                                        ],
                                                      }),
                                                      a.telephone &&
                                                        e.jsxs('div', {
                                                          children: ['Tél : ', a.telephone],
                                                        }),
                                                      a.email &&
                                                        e.jsxs('div', {
                                                          children: ['Email : ', a.email],
                                                        }),
                                                      e.jsxs('div', {
                                                        children: [
                                                          'Visites : ',
                                                          c.filter((o) => o.id === a.id).length,
                                                        ],
                                                      }),
                                                      e.jsxs('div', {
                                                        children: [
                                                          'Messages : ',
                                                          c.filter(
                                                            (o) =>
                                                              o.id === a.id && o.communicationStatus
                                                          ).length,
                                                        ],
                                                      }),
                                                      a.createdAt &&
                                                        e.jsxs('div', {
                                                          className: 'text-xs',
                                                          children: [
                                                            'Créé : ',
                                                            new Date(
                                                              a.createdAt
                                                            ).toLocaleDateString('fr-FR'),
                                                          ],
                                                        }),
                                                    ],
                                                  }),
                                                s.type === 'host' &&
                                                  e.jsxs(e.Fragment, {
                                                    children: [
                                                      a.telephone &&
                                                        e.jsxs('div', {
                                                          children: ['Tél : ', a.telephone],
                                                        }),
                                                      a.address &&
                                                        e.jsxs('div', {
                                                          children: ['Adresse : ', a.address],
                                                        }),
                                                      a.createdAt &&
                                                        e.jsxs('div', {
                                                          className: 'text-xs',
                                                          children: [
                                                            'Créé : ',
                                                            new Date(
                                                              a.createdAt
                                                            ).toLocaleDateString('fr-FR'),
                                                          ],
                                                        }),
                                                    ],
                                                  }),
                                                s.type === 'visit' &&
                                                  e.jsxs(e.Fragment, {
                                                    children: [
                                                      e.jsxs('div', {
                                                        children: [
                                                          'Date : ',
                                                          new Date(a.visitDate).toLocaleDateString(
                                                            'fr-FR'
                                                          ),
                                                        ],
                                                      }),
                                                      e.jsxs('div', {
                                                        children: ['Heure : ', a.visitTime],
                                                      }),
                                                      e.jsxs('div', {
                                                        children: ['Statut : ', a.status],
                                                      }),
                                                    ],
                                                  }),
                                                s.type === 'message' &&
                                                  e.jsxs(e.Fragment, {
                                                    children: [
                                                      e.jsxs('div', {
                                                        children: ['Orateur : ', a.speakerName],
                                                      }),
                                                      e.jsxs('div', {
                                                        children: [
                                                          'Date : ',
                                                          new Date(a.receivedAt).toLocaleDateString(
                                                            'fr-FR'
                                                          ),
                                                          ' ',
                                                          new Date(a.receivedAt).toLocaleTimeString(
                                                            'fr-FR'
                                                          ),
                                                        ],
                                                      }),
                                                      e.jsxs('div', {
                                                        className: 'line-clamp-2',
                                                        children: ['Contenu : ', a.message],
                                                      }),
                                                    ],
                                                  }),
                                              ],
                                            }),
                                          ],
                                        },
                                        l
                                      )
                                    ),
                                  }),
                                ],
                              }),
                            }),
                          },
                          n
                        )
                      ),
                    ],
                  }),
          }),
          k.size > 0 &&
            e.jsxs('div', {
              className:
                'flex items-start gap-3 p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg',
              children: [
                e.jsx(xe, { className: 'w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5' }),
                e.jsxs('div', {
                  className: 'text-sm text-orange-800 dark:text-orange-300',
                  children: [
                    e.jsx('strong', { children: 'Attention :' }),
                    ' La fusion des doublons est irréversible. Assurez-vous de vérifier les données avant de continuer.',
                  ],
                }),
              ],
            }),
          e.jsxs('div', {
            className: 'flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700',
            children: [
              e.jsx(L, { variant: 'secondary', onClick: v, children: 'Fermer' }),
              k.size > 0 &&
                e.jsxs(e.Fragment, {
                  children: [
                    e.jsxs(L, {
                      variant: 'danger',
                      onClick: N,
                      children: [
                        e.jsx(Ne, { className: 'w-4 h-4 mr-2' }),
                        'Supprimer les doublons (',
                        k.size,
                        ')',
                      ],
                    }),
                    e.jsxs(L, {
                      variant: 'primary',
                      onClick: E,
                      children: [
                        e.jsx(Ye, { className: 'w-4 h-4 mr-2' }),
                        'Fusionner (',
                        k.size,
                        ')',
                      ],
                    }),
                  ],
                }),
            ],
          }),
        ],
      }),
    });
  },
  ss = ({ isOpen: T, onClose: v, onBackup: I, onRestore: i }) => {
    const [g, c] = h.useState('backup'),
      [S, P] = h.useState(!0),
      [k, O] = h.useState(!0),
      [p, R] = h.useState(!0),
      [y, M] = h.useState(!1),
      [d, f] = h.useState(''),
      [b, x] = h.useState(''),
      [E, N] = h.useState(!1),
      [A, z] = h.useState(null),
      s = [
        { id: '1', date: new Date().toISOString(), size: 2048576, itemsCount: 150, encrypted: !0 },
      ],
      n = async () => {
        if (y && d !== b) {
          alert('Les mots de passe ne correspondent pas');
          return;
        }
        N(!0);
        try {
          (await I({
            includeArchived: S,
            includeSettings: k,
            includeTemplates: p,
            encrypt: y,
            password: y ? d : void 0,
          }),
            f(''),
            x(''),
            N(!1));
        } catch (r) {
          (console.error('Erreur lors de la sauvegarde:', r), N(!1));
        }
      },
      a = (r) => {
        const j = r.target.files?.[0];
        j && z(j);
      },
      l = async () => {
        if (
          A &&
          confirm(
            '⚠️ La restauration remplacera toutes les données actuelles. Êtes-vous sûr de vouloir continuer ?'
          )
        )
          try {
            (await i(A), v());
          } catch (r) {
            console.error('Erreur lors de la restauration:', r);
          }
      },
      o = (r) =>
        r < 1024
          ? `${r} B`
          : r < 1024 * 1024
            ? `${(r / 1024).toFixed(2)} KB`
            : `${(r / (1024 * 1024)).toFixed(2)} MB`;
    return e.jsx(ie, {
      isOpen: T,
      onClose: v,
      title: 'Gestion des sauvegardes',
      size: 'lg',
      children: e.jsxs('div', {
        className: 'space-y-6',
        children: [
          e.jsxs('div', {
            className: 'flex gap-2 border-b border-gray-200 dark:border-gray-700',
            children: [
              e.jsxs('button', {
                onClick: () => c('backup'),
                className: `px-4 py-2 font-medium transition-colors ${g === 'backup' ? 'text-primary-600 border-b-2 border-primary-600' : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'}`,
                children: [e.jsx(me, { className: 'w-4 h-4 inline mr-2' }), 'Créer une sauvegarde'],
              }),
              e.jsxs('button', {
                onClick: () => c('restore'),
                className: `px-4 py-2 font-medium transition-colors ${g === 'restore' ? 'text-primary-600 border-b-2 border-primary-600' : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'}`,
                children: [e.jsx(ee, { className: 'w-4 h-4 inline mr-2' }), 'Restaurer'],
              }),
              e.jsxs('button', {
                onClick: () => c('history'),
                className: `px-4 py-2 font-medium transition-colors ${g === 'history' ? 'text-primary-600 border-b-2 border-primary-600' : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'}`,
                children: [e.jsx(ue, { className: 'w-4 h-4 inline mr-2' }), 'Historique'],
              }),
            ],
          }),
          g === 'backup' &&
            e.jsxs('div', {
              className: 'space-y-6',
              children: [
                e.jsx('div', {
                  className:
                    'p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg',
                  children: e.jsxs('div', {
                    className: 'flex items-start gap-3',
                    children: [
                      e.jsx(ye, { className: 'w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5' }),
                      e.jsxs('div', {
                        className: 'text-sm text-blue-800 dark:text-blue-300',
                        children: [
                          e.jsx('strong', { children: 'Sauvegarde locale :' }),
                          ' Les données seront exportées dans un fichier JSON téléchargeable. Conservez ce fichier en lieu sûr pour pouvoir restaurer vos données en cas de besoin.',
                        ],
                      }),
                    ],
                  }),
                }),
                e.jsxs('div', {
                  className: 'space-y-3',
                  children: [
                    e.jsx('h4', {
                      className: 'font-medium text-gray-900 dark:text-white',
                      children: 'Données à inclure',
                    }),
                    e.jsxs('label', {
                      className:
                        'flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer',
                      children: [
                        e.jsx('input', {
                          type: 'checkbox',
                          checked: S,
                          onChange: (r) => P(r.target.checked),
                          className:
                            'w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500',
                        }),
                        e.jsxs('div', {
                          className: 'flex-1',
                          children: [
                            e.jsx('span', {
                              className: 'text-sm font-medium text-gray-900 dark:text-white',
                              children: 'Visites archivées',
                            }),
                            e.jsx('p', {
                              className: 'text-xs text-gray-500 dark:text-gray-400',
                              children: "Inclure l'historique complet des visites passées",
                            }),
                          ],
                        }),
                      ],
                    }),
                    e.jsxs('label', {
                      className:
                        'flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer',
                      children: [
                        e.jsx('input', {
                          type: 'checkbox',
                          checked: k,
                          onChange: (r) => O(r.target.checked),
                          className:
                            'w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500',
                        }),
                        e.jsxs('div', {
                          className: 'flex-1',
                          children: [
                            e.jsx('span', {
                              className: 'text-sm font-medium text-gray-900 dark:text-white',
                              children: "Paramètres de l'application",
                            }),
                            e.jsx('p', {
                              className: 'text-xs text-gray-500 dark:text-gray-400',
                              children: 'Thème, langue, notifications, etc.',
                            }),
                          ],
                        }),
                      ],
                    }),
                    e.jsxs('label', {
                      className:
                        'flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer',
                      children: [
                        e.jsx('input', {
                          type: 'checkbox',
                          checked: p,
                          onChange: (r) => R(r.target.checked),
                          className:
                            'w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500',
                        }),
                        e.jsxs('div', {
                          className: 'flex-1',
                          children: [
                            e.jsx('span', {
                              className: 'text-sm font-medium text-gray-900 dark:text-white',
                              children: 'Templates personnalisés',
                            }),
                            e.jsx('p', {
                              className: 'text-xs text-gray-500 dark:text-gray-400',
                              children: 'Modèles de messages et configurations personnalisées',
                            }),
                          ],
                        }),
                      ],
                    }),
                  ],
                }),
                e.jsxs('div', {
                  className: 'space-y-3',
                  children: [
                    e.jsxs('label', {
                      className:
                        'flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer',
                      children: [
                        e.jsx('input', {
                          type: 'checkbox',
                          checked: y,
                          onChange: (r) => M(r.target.checked),
                          className:
                            'w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500',
                        }),
                        e.jsxs('div', {
                          className: 'flex-1',
                          children: [
                            e.jsxs('div', {
                              className: 'flex items-center gap-2',
                              children: [
                                e.jsx(le, { className: 'w-4 h-4 text-primary-600' }),
                                e.jsx('span', {
                                  className: 'text-sm font-medium text-gray-900 dark:text-white',
                                  children: 'Chiffrer la sauvegarde',
                                }),
                              ],
                            }),
                            e.jsx('p', {
                              className: 'text-xs text-gray-500 dark:text-gray-400 mt-1',
                              children: 'Protéger les données sensibles avec un mot de passe',
                            }),
                          ],
                        }),
                      ],
                    }),
                    y &&
                      e.jsxs('div', {
                        className: 'space-y-3 pl-4',
                        children: [
                          e.jsxs('div', {
                            children: [
                              e.jsx('label', {
                                className:
                                  'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                children: 'Mot de passe',
                              }),
                              e.jsx('input', {
                                type: 'password',
                                value: d,
                                onChange: (r) => f(r.target.value),
                                className:
                                  'w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent',
                                placeholder: 'Entrez un mot de passe',
                              }),
                            ],
                          }),
                          e.jsxs('div', {
                            children: [
                              e.jsx('label', {
                                className:
                                  'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                children: 'Confirmer le mot de passe',
                              }),
                              e.jsx('input', {
                                type: 'password',
                                value: b,
                                onChange: (r) => x(r.target.value),
                                className:
                                  'w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent',
                                placeholder: 'Confirmez le mot de passe',
                              }),
                            ],
                          }),
                        ],
                      }),
                  ],
                }),
                e.jsxs(L, {
                  variant: 'primary',
                  onClick: n,
                  disabled: E || (y && (!d || d !== b)),
                  className: 'w-full',
                  children: [
                    e.jsx(ae, { className: 'w-4 h-4 mr-2' }),
                    E ? 'Création en cours...' : 'Créer et télécharger la sauvegarde',
                  ],
                }),
              ],
            }),
          g === 'restore' &&
            e.jsxs('div', {
              className: 'space-y-6',
              children: [
                e.jsx('div', {
                  className:
                    'p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg',
                  children: e.jsxs('div', {
                    className: 'flex items-start gap-3',
                    children: [
                      e.jsx(xe, { className: 'w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5' }),
                      e.jsxs('div', {
                        className: 'text-sm text-orange-800 dark:text-orange-300',
                        children: [
                          e.jsx('strong', { children: 'Attention :' }),
                          " La restauration remplacera toutes les données actuelles. Assurez-vous d'avoir créé une sauvegarde récente avant de continuer.",
                        ],
                      }),
                    ],
                  }),
                }),
                e.jsx('div', {
                  className:
                    'border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8',
                  children: e.jsxs('div', {
                    className: 'text-center',
                    children: [
                      e.jsx(ee, { className: 'w-12 h-12 mx-auto mb-4 text-gray-400' }),
                      e.jsx('h4', {
                        className: 'text-lg font-medium text-gray-900 dark:text-white mb-2',
                        children: 'Sélectionner un fichier de sauvegarde',
                      }),
                      e.jsx('p', {
                        className: 'text-sm text-gray-600 dark:text-gray-400 mb-4',
                        children: 'Fichier JSON (.json) exporté précédemment',
                      }),
                      e.jsx('input', {
                        type: 'file',
                        accept: '.json',
                        onChange: a,
                        className: 'hidden',
                        id: 'backup-file',
                      }),
                      e.jsx('label', {
                        htmlFor: 'backup-file',
                        children: e.jsx('span', {
                          className:
                            'inline-flex items-center justify-center px-4 py-2 border-2 border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 text-gray-700 dark:text-gray-300 font-medium rounded-lg cursor-pointer transition-colors',
                          children: 'Parcourir',
                        }),
                      }),
                    ],
                  }),
                }),
                A &&
                  e.jsx('div', {
                    className:
                      'p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg',
                    children: e.jsxs('div', {
                      className: 'flex items-center justify-between',
                      children: [
                        e.jsxs('div', {
                          className: 'flex items-center gap-3',
                          children: [
                            e.jsx(Q, { className: 'w-5 h-5 text-green-600' }),
                            e.jsxs('div', {
                              children: [
                                e.jsx('div', {
                                  className: 'font-medium text-green-900 dark:text-green-200',
                                  children: A.name,
                                }),
                                e.jsx('div', {
                                  className: 'text-sm text-green-800 dark:text-green-300',
                                  children: o(A.size),
                                }),
                              ],
                            }),
                          ],
                        }),
                        e.jsx(L, { variant: 'danger', onClick: l, children: 'Restaurer' }),
                      ],
                    }),
                  }),
              ],
            }),
          g === 'history' &&
            e.jsx('div', {
              className: 'space-y-4',
              children:
                s.length === 0
                  ? e.jsxs('div', {
                      className: 'text-center py-12',
                      children: [
                        e.jsx(ue, { className: 'w-16 h-16 mx-auto mb-4 text-gray-400' }),
                        e.jsx('h3', {
                          className: 'text-lg font-semibold text-gray-900 dark:text-white mb-2',
                          children: 'Aucune sauvegarde',
                        }),
                        e.jsx('p', {
                          className: 'text-gray-600 dark:text-gray-400',
                          children: 'Créez votre première sauvegarde pour sécuriser vos données',
                        }),
                      ],
                    })
                  : s.map((r) =>
                      e.jsx(
                        U,
                        {
                          children: e.jsx(q, {
                            children: e.jsxs('div', {
                              className: 'flex items-center justify-between',
                              children: [
                                e.jsxs('div', {
                                  className: 'flex items-center gap-4',
                                  children: [
                                    e.jsx('div', {
                                      className:
                                        'p-3 bg-primary-100 dark:bg-primary-900 rounded-lg',
                                      children: e.jsx(ye, {
                                        className: 'w-6 h-6 text-primary-600',
                                      }),
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('div', {
                                          className: 'font-medium text-gray-900 dark:text-white',
                                          children: new Date(r.date).toLocaleDateString('fr-FR', {
                                            day: 'numeric',
                                            month: 'long',
                                            year: 'numeric',
                                            hour: '2-digit',
                                            minute: '2-digit',
                                          }),
                                        }),
                                        e.jsxs('div', {
                                          className: 'text-sm text-gray-600 dark:text-gray-400',
                                          children: [
                                            r.itemsCount,
                                            ' éléments • ',
                                            o(r.size),
                                            r.encrypted &&
                                              e.jsxs(Y, {
                                                variant: 'default',
                                                className: 'ml-2',
                                                children: [
                                                  e.jsx(le, { className: 'w-3 h-3 mr-1' }),
                                                  'Chiffré',
                                                ],
                                              }),
                                          ],
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                                e.jsx(L, {
                                  variant: 'outline',
                                  size: 'sm',
                                  children: e.jsx(ae, { className: 'w-4 h-4' }),
                                }),
                              ],
                            }),
                          }),
                        },
                        r.id
                      )
                    ),
            }),
          e.jsx('div', {
            className: 'flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700',
            children: e.jsx(L, { variant: 'secondary', onClick: v, children: 'Fermer' }),
          }),
        ],
      }),
    });
  },
  Z = {
    speakers: [
      { key: 'nom', label: 'Nom', required: !0 },
      { key: 'congregation', label: 'Congrégation', required: !0 },
      { key: 'telephone', label: 'Téléphone', required: !1 },
      { key: 'email', label: 'Email', required: !1 },
      { key: 'gender', label: 'Genre (male/female/couple)', required: !1 },
    ],
    visits: [
      { key: 'nom', label: 'Nom orateur', required: !0 },
      { key: 'visitDate', label: 'Date (YYYY-MM-DD)', required: !0 },
      { key: 'visitTime', label: 'Heure (HH:MM)', required: !0 },
      { key: 'talkNoOrType', label: 'N° discours', required: !1 },
      { key: 'talkTheme', label: 'Thème discours', required: !1 },
      { key: 'host', label: 'Hôte', required: !1 },
      { key: 'status', label: 'Statut', required: !1 },
    ],
    hosts: [
      { key: 'nom', label: 'Nom', required: !0 },
      { key: 'telephone', label: 'Téléphone', required: !1 },
      { key: 'email', label: 'Email', required: !1 },
      { key: 'address', label: 'Adresse', required: !1 },
      { key: 'gender', label: 'Genre (male/female/couple)', required: !1 },
    ],
  },
  rs = ({ isOpen: T, onClose: v, onImport: I }) => {
    const [i, g] = h.useState('upload'),
      [c, S] = h.useState('speakers'),
      [P, k] = h.useState(null),
      [O, p] = h.useState([]),
      [R, y] = h.useState([]),
      [M, d] = h.useState({}),
      [f, b] = h.useState(null),
      x = async (s) => {
        const n = s.target.files?.[0];
        if (!n) return;
        k(n);
        const l = (await n.text())
          .split(
            `
`
          )
          .filter((j) => j.trim());
        if (l.length === 0) return;
        const o = l[0].split(',').map((j) => j.trim().replace(/"/g, ''));
        y(o);
        const r = l.slice(1).map((j) => {
          const m = j.split(',').map((B) => B.trim().replace(/"/g, '')),
            F = {};
          return (
            o.forEach((B, $) => {
              F[B] = m[$] || '';
            }),
            F
          );
        });
        (p(r), g('mapping'));
      },
      E = (s, n) => {
        d((a) => ({ ...a, [s]: n }));
      },
      N = async () => {
        g('import');
        try {
          const s = O.map((a) => {
              const l = {};
              return (
                Object.entries(M).forEach(([o, r]) => {
                  r && a[o] && (l[r] = a[o]);
                }),
                l
              );
            }),
            n = await I(s, M);
          (b(n), g('result'));
        } catch (s) {
          console.error("Erreur lors de l'import:", s);
        }
      },
      A = () => {
        const s = Z[c].filter((a) => a.required);
        return `${s.filter((a) => Object.values(M).includes(a.key)).length}/${s.length}`;
      },
      z = () => Z[c].filter((n) => n.required).every((n) => Object.values(M).includes(n.key));
    return e.jsx(ie, {
      isOpen: T,
      onClose: v,
      title: "Assistant d'importation",
      size: 'xl',
      children: e.jsxs('div', {
        className: 'space-y-6',
        children: [
          e.jsx('div', {
            className: 'flex items-center justify-between',
            children: ['upload', 'mapping', 'preview', 'import', 'result'].map((s, n) =>
              e.jsxs(
                He.Fragment,
                {
                  children: [
                    e.jsxs('div', {
                      className: `flex items-center gap-2 ${i === s ? 'text-primary-600' : ['upload', 'mapping', 'preview'].indexOf(i) > n ? 'text-green-600' : 'text-gray-400'}`,
                      children: [
                        e.jsx('div', {
                          className: `w-8 h-8 rounded-full flex items-center justify-center font-medium ${i === s ? 'bg-primary-100 dark:bg-primary-900/20' : ['upload', 'mapping', 'preview'].indexOf(i) > n ? 'bg-green-100 dark:bg-green-900/20' : 'bg-gray-100 dark:bg-gray-800'}`,
                          children: n + 1,
                        }),
                        e.jsxs('span', {
                          className: 'text-sm font-medium hidden md:inline',
                          children: [
                            s === 'upload' && 'Fichier',
                            s === 'mapping' && 'Mapping',
                            s === 'preview' && 'Aperçu',
                            s === 'import' && 'Import',
                            s === 'result' && 'Résultat',
                          ],
                        }),
                      ],
                    }),
                    n < 4 && e.jsx(ce, { className: 'w-4 h-4 text-gray-400' }),
                  ],
                },
                s
              )
            ),
          }),
          i === 'upload' &&
            e.jsxs('div', {
              className: 'space-y-6',
              children: [
                e.jsxs('div', {
                  children: [
                    e.jsx('label', {
                      className: 'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3',
                      children: 'Type de données à importer',
                    }),
                    e.jsx('div', {
                      className: 'grid grid-cols-3 gap-3',
                      children: [
                        { value: 'speakers', label: 'Orateurs', icon: '👤' },
                        { value: 'visits', label: 'Visites', icon: '📅' },
                        { value: 'hosts', label: 'Hôtes', icon: '🏠' },
                      ].map((s) =>
                        e.jsxs(
                          'button',
                          {
                            onClick: () => S(s.value),
                            className: `p-4 rounded-lg border-2 transition-all ${c === s.value ? 'border-primary-500 bg-primary-50 dark:bg-primary-900/20' : 'border-gray-200 dark:border-gray-700 hover:border-gray-300'}`,
                            children: [
                              e.jsx('div', { className: 'text-3xl mb-2', children: s.icon }),
                              e.jsx('div', {
                                className: 'font-medium text-gray-900 dark:text-white',
                                children: s.label,
                              }),
                            ],
                          },
                          s.value
                        )
                      ),
                    }),
                  ],
                }),
                e.jsx('div', {
                  className:
                    'border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-12',
                  children: e.jsxs('div', {
                    className: 'text-center',
                    children: [
                      e.jsx(ee, { className: 'w-16 h-16 mx-auto mb-4 text-gray-400' }),
                      e.jsx('h3', {
                        className: 'text-lg font-medium text-gray-900 dark:text-white mb-2',
                        children: 'Sélectionner un fichier CSV',
                      }),
                      e.jsx('p', {
                        className: 'text-sm text-gray-600 dark:text-gray-400 mb-4',
                        children: 'Fichier CSV avec en-têtes de colonnes',
                      }),
                      e.jsx('input', {
                        type: 'file',
                        accept: '.csv',
                        onChange: x,
                        className: 'hidden',
                        id: 'csv-file',
                      }),
                      e.jsx('label', {
                        htmlFor: 'csv-file',
                        children: e.jsxs('span', {
                          className:
                            'inline-flex items-center justify-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg cursor-pointer transition-colors',
                          children: [e.jsx(ee, { className: 'w-4 h-4 mr-2' }), 'Parcourir'],
                        }),
                      }),
                    ],
                  }),
                }),
                e.jsx('div', {
                  className:
                    'p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg',
                  children: e.jsxs('div', {
                    className: 'flex items-start gap-3',
                    children: [
                      e.jsx(Le, { className: 'w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5' }),
                      e.jsxs('div', {
                        className: 'text-sm text-blue-800 dark:text-blue-300',
                        children: [
                          e.jsx('strong', { children: 'Format attendu :' }),
                          " Fichier CSV avec la première ligne contenant les noms de colonnes. Les colonnes seront mappées à l'étape suivante.",
                        ],
                      }),
                    ],
                  }),
                }),
              ],
            }),
          i === 'mapping' &&
            e.jsxs('div', {
              className: 'space-y-6',
              children: [
                e.jsxs('div', {
                  className:
                    'flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg',
                  children: [
                    e.jsxs('div', {
                      children: [
                        e.jsx('h4', {
                          className: 'font-medium text-gray-900 dark:text-white',
                          children: P?.name,
                        }),
                        e.jsxs('p', {
                          className: 'text-sm text-gray-600 dark:text-gray-400',
                          children: [O.length, ' ligne(s) détectée(s)'],
                        }),
                      ],
                    }),
                    e.jsxs(Y, { variant: 'default', children: ['Champs requis : ', A()] }),
                  ],
                }),
                e.jsxs('div', {
                  children: [
                    e.jsx('h4', {
                      className: 'font-medium text-gray-900 dark:text-white mb-3',
                      children: 'Mapper les colonnes',
                    }),
                    e.jsx('div', {
                      className: 'space-y-3',
                      children: R.map((s) =>
                        e.jsxs(
                          'div',
                          {
                            className: 'flex items-center gap-3',
                            children: [
                              e.jsx('div', {
                                className:
                                  'flex-1 px-4 py-2 bg-gray-50 dark:bg-gray-800 rounded-lg',
                                children: e.jsx('span', {
                                  className: 'text-sm font-medium text-gray-900 dark:text-white',
                                  children: s,
                                }),
                              }),
                              e.jsx(ce, { className: 'w-4 h-4 text-gray-400' }),
                              e.jsxs('select', {
                                value: M[s] || '',
                                onChange: (n) => E(s, n.target.value),
                                'aria-label': `Mapper la colonne ${s}`,
                                className:
                                  'flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent',
                                children: [
                                  e.jsx('option', { value: '', children: '-- Ignorer --' }),
                                  Z[c].map((n) =>
                                    e.jsxs(
                                      'option',
                                      { value: n.key, children: [n.label, ' ', n.required && '*'] },
                                      n.key
                                    )
                                  ),
                                ],
                              }),
                            ],
                          },
                          s
                        )
                      ),
                    }),
                  ],
                }),
                e.jsxs('div', {
                  className: 'flex gap-3 justify-end',
                  children: [
                    e.jsx(L, {
                      variant: 'secondary',
                      onClick: () => g('upload'),
                      children: 'Retour',
                    }),
                    e.jsxs(L, {
                      variant: 'primary',
                      onClick: () => g('preview'),
                      disabled: !z(),
                      children: ['Aperçu', e.jsx(ce, { className: 'w-4 h-4 ml-2' })],
                    }),
                  ],
                }),
              ],
            }),
          i === 'preview' &&
            e.jsxs('div', {
              className: 'space-y-6',
              children: [
                e.jsxs('div', {
                  className:
                    'p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg',
                  children: [
                    e.jsxs('div', {
                      className: 'flex items-center gap-2 mb-2',
                      children: [
                        e.jsx(Q, { className: 'w-5 h-5 text-green-600' }),
                        e.jsx('span', {
                          className: 'font-medium text-green-900 dark:text-green-200',
                          children: 'Prêt à importer',
                        }),
                      ],
                    }),
                    e.jsxs('p', {
                      className: 'text-sm text-green-800 dark:text-green-300',
                      children: [
                        O.length,
                        ' ',
                        c === 'speakers' ? 'orateur(s)' : c === 'visits' ? 'visite(s)' : 'hôte(s)',
                        ' seront importé(s)',
                      ],
                    }),
                  ],
                }),
                e.jsxs('div', {
                  children: [
                    e.jsx('h4', {
                      className: 'font-medium text-gray-900 dark:text-white mb-3',
                      children: 'Aperçu des données (5 premières lignes)',
                    }),
                    e.jsx('div', {
                      className: 'overflow-x-auto',
                      children: e.jsxs('table', {
                        className: 'w-full text-sm',
                        children: [
                          e.jsx('thead', {
                            className: 'bg-gray-50 dark:bg-gray-800',
                            children: e.jsx('tr', {
                              children: Z[c]
                                .filter((s) => Object.values(M).includes(s.key))
                                .map((s) =>
                                  e.jsx(
                                    'th',
                                    {
                                      className:
                                        'px-4 py-2 text-left font-medium text-gray-700 dark:text-gray-300',
                                      children: s.label,
                                    },
                                    s.key
                                  )
                                ),
                            }),
                          }),
                          e.jsx('tbody', {
                            children: O.slice(0, 5).map((s, n) =>
                              e.jsx(
                                'tr',
                                {
                                  className: 'border-t border-gray-200 dark:border-gray-700',
                                  children: Z[c]
                                    .filter((a) => Object.values(M).includes(a.key))
                                    .map((a) => {
                                      const l = Object.keys(M).find((o) => M[o] === a.key);
                                      return e.jsx(
                                        'td',
                                        {
                                          className: 'px-4 py-2 text-gray-900 dark:text-white',
                                          children: l ? s[l] : '-',
                                        },
                                        a.key
                                      );
                                    }),
                                },
                                n
                              )
                            ),
                          }),
                        ],
                      }),
                    }),
                  ],
                }),
                e.jsxs('div', {
                  className: 'flex gap-3 justify-end',
                  children: [
                    e.jsx(L, {
                      variant: 'secondary',
                      onClick: () => g('mapping'),
                      children: 'Retour',
                    }),
                    e.jsxs(L, {
                      variant: 'primary',
                      onClick: N,
                      children: [e.jsx(ae, { className: 'w-4 h-4 mr-2' }), "Lancer l'importation"],
                    }),
                  ],
                }),
              ],
            }),
          i === 'import' &&
            e.jsxs('div', {
              className: 'py-12 text-center',
              children: [
                e.jsx('div', {
                  className:
                    'w-16 h-16 mx-auto mb-4 border-4 border-primary-600 border-t-transparent rounded-full animate-spin',
                }),
                e.jsx('h3', {
                  className: 'text-lg font-medium text-gray-900 dark:text-white mb-2',
                  children: 'Importation en cours...',
                }),
                e.jsx('p', {
                  className: 'text-sm text-gray-600 dark:text-gray-400',
                  children: 'Veuillez patienter pendant le traitement des données',
                }),
              ],
            }),
          i === 'result' &&
            f &&
            e.jsxs('div', {
              className: 'space-y-6',
              children: [
                e.jsxs('div', {
                  className: 'text-center py-8',
                  children: [
                    e.jsx(Q, { className: 'w-20 h-20 mx-auto mb-4 text-green-500' }),
                    e.jsx('h3', {
                      className: 'text-2xl font-bold text-gray-900 dark:text-white mb-2',
                      children: 'Importation terminée !',
                    }),
                  ],
                }),
                e.jsxs('div', {
                  className: 'grid grid-cols-2 gap-4',
                  children: [
                    e.jsx(U, {
                      children: e.jsxs(q, {
                        className: 'text-center',
                        children: [
                          e.jsx('div', {
                            className: 'text-3xl font-bold text-green-600',
                            children: f.speakersAdded + f.visitsAdded + f.hostsAdded,
                          }),
                          e.jsx('div', {
                            className: 'text-sm text-gray-600 dark:text-gray-400',
                            children: 'Ajouté(s)',
                          }),
                        ],
                      }),
                    }),
                    e.jsx(U, {
                      children: e.jsxs(q, {
                        className: 'text-center',
                        children: [
                          e.jsx('div', {
                            className: 'text-3xl font-bold text-blue-600',
                            children: f.speakersUpdated + f.visitsUpdated + f.hostsUpdated,
                          }),
                          e.jsx('div', {
                            className: 'text-sm text-gray-600 dark:text-gray-400',
                            children: 'Mis à jour',
                          }),
                        ],
                      }),
                    }),
                  ],
                }),
                f.errors.length > 0 &&
                  e.jsx('div', {
                    className:
                      'p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg',
                    children: e.jsxs('div', {
                      className: 'flex items-start gap-3',
                      children: [
                        e.jsx(xe, { className: 'w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5' }),
                        e.jsxs('div', {
                          children: [
                            e.jsxs('h4', {
                              className: 'font-medium text-orange-900 dark:text-orange-200 mb-2',
                              children: [f.errors.length, ' erreur(s) détectée(s)'],
                            }),
                            e.jsx('ul', {
                              className: 'text-sm text-orange-800 dark:text-orange-300 space-y-1',
                              children: f.errors
                                .slice(0, 5)
                                .map((s, n) => e.jsxs('li', { children: ['• ', s] }, n)),
                            }),
                          ],
                        }),
                      ],
                    }),
                  }),
                e.jsx('div', {
                  className: 'flex gap-3 justify-end',
                  children: e.jsx(L, { variant: 'primary', onClick: v, children: 'Terminer' }),
                }),
              ],
            }),
        ],
      }),
    });
  },
  ts = ({ isOpen: T, onClose: v, onRestore: I, onDelete: i, onExport: g }) => {
    const { archivedVisits: c } = ne(),
      [S, P] = h.useState(''),
      [k, O] = h.useState('all'),
      [p, R] = h.useState('all'),
      [y, M] = h.useState(new Set()),
      [d, f] = h.useState('date'),
      b = h.useMemo(() => {
        const l = new Set();
        return (
          c.forEach((o) => {
            const r = new Date(o.visitDate).getFullYear();
            l.add(r);
          }),
          Array.from(l).sort((o, r) => r - o)
        );
      }, [c]),
      x = h.useMemo(() => {
        const l = c.filter((o) => {
          if (S) {
            const r = S.toLowerCase();
            if (
              !o.nom.toLowerCase().includes(r) &&
              !o.congregation.toLowerCase().includes(r) &&
              !o.talkTheme?.toLowerCase().includes(r)
            )
              return !1;
          }
          return !(
            (k !== 'all' && new Date(o.visitDate).getFullYear() !== k) ||
            (p !== 'all' && o.status !== p)
          );
        });
        return (
          l.sort((o, r) => {
            switch (d) {
              case 'date':
                return new Date(r.visitDate).getTime() - new Date(o.visitDate).getTime();
              case 'speaker':
                return o.nom.localeCompare(r.nom);
              case 'congregation':
                return o.congregation.localeCompare(r.congregation);
              default:
                return 0;
            }
          }),
          l
        );
      }, [c, S, k, p, d]),
      E = (l) => {
        M((o) => {
          const r = new Set(o);
          return (r.has(l) ? r.delete(l) : r.add(l), r);
        });
      },
      N = () => {
        M(new Set(x.map((l) => l.visitId)));
      },
      A = () => {
        M(new Set());
      },
      z = () => {
        y.size > 0 && (I(Array.from(y)), M(new Set()));
      },
      s = () => {
        y.size > 0 &&
          confirm(`⚠️ Êtes-vous sûr de vouloir supprimer définitivement ${y.size} visite(s) ?`) &&
          (i(Array.from(y)), M(new Set()));
      },
      n = () => {
        y.size > 0 && g(Array.from(y));
      },
      a = (l) => {
        switch (l) {
          case 'completed':
            return e.jsx(Y, { variant: 'success', children: 'Terminé' });
          case 'cancelled':
            return e.jsx(Y, { variant: 'danger', children: 'Annulé' });
          default:
            return e.jsx(Y, { variant: 'default', children: l });
        }
      };
    return e.jsx(ie, {
      isOpen: T,
      onClose: v,
      title: 'Gestion des archives',
      size: 'xl',
      children: e.jsxs('div', {
        className: 'space-y-6',
        children: [
          e.jsxs('div', {
            className: 'grid grid-cols-4 gap-4',
            children: [
              e.jsxs('div', {
                className: 'p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg',
                children: [
                  e.jsx('div', {
                    className: 'text-2xl font-bold text-blue-600',
                    children: c.length,
                  }),
                  e.jsx('div', {
                    className: 'text-sm text-blue-800 dark:text-blue-300',
                    children: 'Total',
                  }),
                ],
              }),
              e.jsxs('div', {
                className: 'p-3 bg-green-50 dark:bg-green-900/20 rounded-lg',
                children: [
                  e.jsx('div', {
                    className: 'text-2xl font-bold text-green-600',
                    children: c.filter((l) => l.status === 'completed').length,
                  }),
                  e.jsx('div', {
                    className: 'text-sm text-green-800 dark:text-green-300',
                    children: 'Terminées',
                  }),
                ],
              }),
              e.jsxs('div', {
                className: 'p-3 bg-red-50 dark:bg-red-900/20 rounded-lg',
                children: [
                  e.jsx('div', {
                    className: 'text-2xl font-bold text-red-600',
                    children: c.filter((l) => l.status === 'cancelled').length,
                  }),
                  e.jsx('div', {
                    className: 'text-sm text-red-800 dark:text-red-300',
                    children: 'Annulées',
                  }),
                ],
              }),
              e.jsxs('div', {
                className: 'p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg',
                children: [
                  e.jsx('div', {
                    className: 'text-2xl font-bold text-purple-600',
                    children: y.size,
                  }),
                  e.jsx('div', {
                    className: 'text-sm text-purple-800 dark:text-purple-300',
                    children: 'Sélectionnées',
                  }),
                ],
              }),
            ],
          }),
          e.jsxs('div', {
            className: 'space-y-3',
            children: [
              e.jsxs('div', {
                className: 'relative',
                children: [
                  e.jsx(Pe, {
                    className: 'absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400',
                  }),
                  e.jsx('input', {
                    type: 'text',
                    value: S,
                    onChange: (l) => P(l.target.value),
                    placeholder: 'Rechercher par orateur, congrégation ou discours...',
                    className:
                      'w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent',
                  }),
                ],
              }),
              e.jsxs('div', {
                className: 'flex gap-3 flex-wrap',
                children: [
                  e.jsxs('select', {
                    value: k,
                    onChange: (l) => O(l.target.value === 'all' ? 'all' : Number(l.target.value)),
                    'aria-label': 'Filtrer par année',
                    className:
                      'px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent',
                    children: [
                      e.jsx('option', { value: 'all', children: 'Toutes les années' }),
                      b.map((l) => e.jsx('option', { value: l, children: l }, l)),
                    ],
                  }),
                  e.jsxs('select', {
                    value: p,
                    onChange: (l) => R(l.target.value),
                    'aria-label': 'Filtrer par statut',
                    className:
                      'px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent',
                    children: [
                      e.jsx('option', { value: 'all', children: 'Tous les statuts' }),
                      e.jsx('option', { value: 'completed', children: 'Terminées' }),
                      e.jsx('option', { value: 'cancelled', children: 'Annulées' }),
                    ],
                  }),
                  e.jsxs('select', {
                    value: d,
                    onChange: (l) => f(l.target.value),
                    'aria-label': 'Trier les archives',
                    className:
                      'px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent',
                    children: [
                      e.jsx('option', { value: 'date', children: 'Trier par date' }),
                      e.jsx('option', { value: 'speaker', children: 'Trier par orateur' }),
                      e.jsx('option', {
                        value: 'congregation',
                        children: 'Trier par congrégation',
                      }),
                    ],
                  }),
                  e.jsx('div', { className: 'flex-1' }),
                  e.jsx(L, {
                    variant: 'outline',
                    size: 'sm',
                    onClick: N,
                    children: 'Tout sélectionner',
                  }),
                  e.jsx(L, {
                    variant: 'outline',
                    size: 'sm',
                    onClick: A,
                    children: 'Tout désélectionner',
                  }),
                ],
              }),
            ],
          }),
          e.jsx('div', {
            className: 'space-y-2 max-h-96 overflow-y-auto',
            children:
              x.length === 0
                ? e.jsxs('div', {
                    className: 'text-center py-12',
                    children: [
                      e.jsx(Je, { className: 'w-16 h-16 mx-auto mb-4 text-gray-400' }),
                      e.jsx('h3', {
                        className: 'text-lg font-semibold text-gray-900 dark:text-white mb-2',
                        children: 'Aucune archive trouvée',
                      }),
                      e.jsx('p', {
                        className: 'text-gray-600 dark:text-gray-400',
                        children: 'Modifiez vos critères de recherche',
                      }),
                    ],
                  })
                : x.map((l) =>
                    e.jsx(
                      U,
                      {
                        hoverable: !0,
                        className: `cursor-pointer transition-all ${y.has(l.visitId) ? 'ring-2 ring-primary-500 bg-primary-50 dark:bg-primary-900/20' : ''}`,
                        onClick: () => E(l.visitId),
                        children: e.jsx(q, {
                          children: e.jsxs('div', {
                            className: 'flex items-center gap-4',
                            children: [
                              e.jsx('input', {
                                type: 'checkbox',
                                checked: y.has(l.visitId),
                                onChange: () => E(l.visitId),
                                onClick: (o) => o.stopPropagation(),
                                'aria-label': `Sélectionner ${l.nom}`,
                                className:
                                  'w-5 h-5 text-primary-600 border-gray-300 rounded focus:ring-primary-500',
                              }),
                              e.jsxs('div', {
                                className: 'flex-1',
                                children: [
                                  e.jsxs('div', {
                                    className: 'flex items-center gap-2 mb-1',
                                    children: [
                                      e.jsx('h4', {
                                        className: 'font-semibold text-gray-900 dark:text-white',
                                        children: l.nom,
                                      }),
                                      a(l.status),
                                    ],
                                  }),
                                  e.jsxs('div', {
                                    className: 'text-sm text-gray-600 dark:text-gray-400 space-y-1',
                                    children: [
                                      e.jsxs('p', {
                                        children: [
                                          e.jsx($e, { className: 'w-3 h-3 inline mr-1' }),
                                          new Date(l.visitDate).toLocaleDateString('fr-FR', {
                                            day: 'numeric',
                                            month: 'long',
                                            year: 'numeric',
                                          }),
                                        ],
                                      }),
                                      e.jsx('p', { children: l.congregation }),
                                      l.talkTheme &&
                                        e.jsxs('p', {
                                          className: 'text-xs',
                                          children: [l.talkNoOrType, ' - ', l.talkTheme],
                                        }),
                                    ],
                                  }),
                                ],
                              }),
                            ],
                          }),
                        }),
                      },
                      l.visitId
                    )
                  ),
          }),
          e.jsxs('div', {
            className:
              'flex gap-3 justify-between pt-4 border-t border-gray-200 dark:border-gray-700',
            children: [
              e.jsx(L, { variant: 'secondary', onClick: v, children: 'Fermer' }),
              y.size > 0 &&
                e.jsxs('div', {
                  className: 'flex gap-3',
                  children: [
                    e.jsxs(L, {
                      variant: 'outline',
                      onClick: n,
                      children: [
                        e.jsx(ae, { className: 'w-4 h-4 mr-2' }),
                        'Exporter (',
                        y.size,
                        ')',
                      ],
                    }),
                    e.jsxs(L, {
                      variant: 'danger',
                      onClick: s,
                      children: [
                        e.jsx(Ne, { className: 'w-4 h-4 mr-2' }),
                        'Supprimer (',
                        y.size,
                        ')',
                      ],
                    }),
                    e.jsxs(L, {
                      variant: 'primary',
                      onClick: z,
                      children: [
                        e.jsx(_e, { className: 'w-4 h-4 mr-2' }),
                        'Restaurer (',
                        y.size,
                        ')',
                      ],
                    }),
                  ],
                }),
            ],
          }),
        ],
      }),
    });
  };
function as(T) {
  const v = [],
    I = [];
  return (
    T.speakers &&
      T.speakers.forEach((i) => {
        i.telephone &&
          i.telephone.trim() &&
          v.push({ nom: i.nom, telephone: i.telephone, congregation: i.congregation });
      }),
    T.visits &&
      T.visits.forEach((i) => {
        i.telephone &&
          i.telephone.trim() &&
          v.push({ nom: i.nom, telephone: i.telephone, congregation: i.congregation });
      }),
    T.hosts &&
      T.hosts.forEach((i) => {
        i.telephone && i.telephone.trim() && I.push({ nom: i.nom, telephone: i.telephone });
      }),
    { speakersWithPhones: v, hostsWithPhones: I }
  );
}
function ls(T, v) {
  const I = new Map();
  return (
    v.forEach((i) => {
      const g = i.nom.toLowerCase().replace(/\s+/g, ' ').trim();
      I.set(g, i.telephone);
    }),
    T.map((i) => {
      const g = i.nom.toLowerCase().replace(/\s+/g, ' ').trim(),
        c = I.get(g);
      return c && !i.telephone ? { ...i, telephone: c, updatedAt: new Date().toISOString() } : i;
    })
  );
}
function ns(T, v) {
  const I = new Map();
  return (
    v.forEach((i) => {
      const g = i.nom.toLowerCase().replace(/\s+/g, ' ').trim();
      I.set(g, i.telephone);
    }),
    T.map((i) => {
      const g = i.nom.toLowerCase().replace(/\s+/g, ' ').trim(),
        c = I.get(g);
      return c && !i.telephone ? { ...i, telephone: c, updatedAt: new Date().toISOString() } : i;
    })
  );
}
function is(T, v, I, i) {
  const g = [],
    c = [];
  let S = 0,
    P = 0;
  return (
    T.forEach((k, O) => {
      const p = v[O];
      k.telephone !== p.telephone && p.telephone && (S++, g.push(`✓ ${p.nom}: +${p.telephone}`));
    }),
    I.forEach((k, O) => {
      const p = i[O];
      k.telephone !== p.telephone && p.telephone && (P++, c.push(`✓ ${p.nom}: +${p.telephone}`));
    }),
    { speakersUpdated: S, hostsUpdated: P, speakerDetails: g, hostDetails: c }
  );
}
function ds(T, v) {
  const { speakersWithPhones: I, hostsWithPhones: i } = as(T),
    g = ls(v.speakers, I),
    c = ns(v.hosts, i),
    S = is(v.speakers, g, v.hosts, c);
  return { updatedSpeakers: g, updatedHosts: c, report: S };
}
function cs({ isOpen: T, onClose: v }) {
  const { speakers: I, hosts: i, updateSpeaker: g, updateHost: c } = ne(),
    [S, P] = h.useState(''),
    [k, O] = h.useState(!1),
    [p, R] = h.useState(null),
    [y, M] = h.useState(!1),
    d = (x) => {
      const E = x.target.files?.[0];
      if (E) {
        const N = new FileReader();
        ((N.onload = (A) => {
          const z = A.target?.result;
          (P(z), M(!0));
        }),
          N.readAsText(E));
      }
    },
    f = async () => {
      if (S.trim()) {
        O(!0);
        try {
          const x = JSON.parse(S),
            { updatedSpeakers: E, updatedHosts: N, report: A } = ds(x, { speakers: I, hosts: i }),
            z = [];
          I.forEach((n) => {
            const a = E.find((l) => l.id === n.id);
            a &&
              (!n.telephone || n.telephone.trim() === '') &&
              a.telephone &&
              a.telephone.trim() !== '' &&
              z.push(a);
          });
          const s = i.filter((n) => {
            const a = N.find((l) => l.nom === n.nom);
            return (
              a &&
              (!n.telephone || n.telephone.trim() === '') &&
              a.telephone &&
              a.telephone.trim() !== ''
            );
          });
          (console.log('🔄 Mise à jour des orateurs:', z.length),
            console.log('🔄 Mise à jour des hôtes:', s.length));
          for (const n of z)
            (console.log(`📱 Mise à jour orateur: ${n.nom} -> ${n.telephone}`),
              g(n),
              await new Promise((a) => setTimeout(a, 50)));
          for (const n of s)
            (console.log(`🏠 Mise à jour hôte: ${n.nom} -> ${n.telephone}`),
              c(n.nom, { telephone: n.telephone }),
              await new Promise((a) => setTimeout(a, 50)));
          (setTimeout(() => {
            window.dispatchEvent(
              new CustomEvent('phoneNumbersUpdated', {
                detail: { speakersUpdated: z.length, hostsUpdated: s.length },
              })
            );
          }, 100),
            R({
              speakersUpdated: A.speakersUpdated,
              hostsUpdated: A.hostsUpdated,
              speakerDetails: A.speakerDetails,
              hostDetails: A.hostDetails,
              errors: [],
            }));
        } catch (x) {
          R({
            speakersUpdated: 0,
            hostsUpdated: 0,
            speakerDetails: [],
            hostDetails: [],
            errors: [x instanceof Error ? x.message : 'Erreur lors du parsing JSON'],
          });
        } finally {
          O(!1);
        }
      }
    },
    b = () => {
      (P(''), R(null), M(!1), v());
    };
  return T
    ? e.jsx('div', {
        className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50',
        children: e.jsxs('div', {
          className: 'bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden',
          children: [
            e.jsxs('div', {
              className: 'flex items-center justify-between p-6 border-b',
              children: [
                e.jsxs('div', {
                  className: 'flex items-center space-x-3',
                  children: [
                    e.jsx(oe, { className: 'h-6 w-6 text-blue-600' }),
                    e.jsx('h2', {
                      className: 'text-xl font-semibold text-gray-900',
                      children: 'Import des Numéros de Téléphone',
                    }),
                  ],
                }),
                e.jsx('button', {
                  onClick: b,
                  className: 'text-gray-400 hover:text-gray-600 transition-colors',
                  'aria-label': 'Fermer',
                  children: e.jsx(Re, { className: 'h-6 w-6' }),
                }),
              ],
            }),
            e.jsx('div', {
              className: 'p-6 overflow-y-auto max-h-[calc(90vh-140px)]',
              children: p
                ? e.jsxs('div', {
                    className: 'space-y-6',
                    children: [
                      e.jsxs('div', {
                        className: 'bg-green-50 border border-green-200 rounded-lg p-4',
                        children: [
                          e.jsxs('div', {
                            className: 'flex items-center space-x-2 mb-3',
                            children: [
                              e.jsx(Q, { className: 'h-5 w-5 text-green-600' }),
                              e.jsx('h3', {
                                className: 'font-medium text-green-900',
                                children: 'Import terminé avec succès!',
                              }),
                            ],
                          }),
                          e.jsxs('div', {
                            className: 'grid grid-cols-2 gap-4 text-sm',
                            children: [
                              e.jsxs('div', {
                                className: 'text-green-800',
                                children: [
                                  e.jsx('span', {
                                    className: 'font-medium',
                                    children: p.speakersUpdated,
                                  }),
                                  ' orateurs mis à jour',
                                ],
                              }),
                              e.jsxs('div', {
                                className: 'text-green-800',
                                children: [
                                  e.jsx('span', {
                                    className: 'font-medium',
                                    children: p.hostsUpdated,
                                  }),
                                  ' hôtes mis à jour',
                                ],
                              }),
                            ],
                          }),
                        ],
                      }),
                      p.speakerDetails.length > 0 &&
                        e.jsxs('div', {
                          children: [
                            e.jsx('h4', {
                              className: 'font-medium text-gray-900 mb-2',
                              children: '📱 Orateurs mis à jour',
                            }),
                            e.jsx('div', {
                              className:
                                'bg-gray-50 border border-gray-200 rounded-lg p-3 max-h-48 overflow-y-auto',
                              children: e.jsx('ul', {
                                className: 'space-y-1 text-sm',
                                children: p.speakerDetails.map((x, E) =>
                                  e.jsx('li', { className: 'text-gray-700', children: x }, E)
                                ),
                              }),
                            }),
                          ],
                        }),
                      p.hostDetails.length > 0 &&
                        e.jsxs('div', {
                          children: [
                            e.jsx('h4', {
                              className: 'font-medium text-gray-900 mb-2',
                              children: '🏠 Hôtes mis à jour',
                            }),
                            e.jsx('div', {
                              className:
                                'bg-gray-50 border border-gray-200 rounded-lg p-3 max-h-48 overflow-y-auto',
                              children: e.jsx('ul', {
                                className: 'space-y-1 text-sm',
                                children: p.hostDetails.map((x, E) =>
                                  e.jsx('li', { className: 'text-gray-700', children: x }, E)
                                ),
                              }),
                            }),
                          ],
                        }),
                      p.errors.length > 0 &&
                        e.jsxs('div', {
                          className: 'bg-red-50 border border-red-200 rounded-lg p-4',
                          children: [
                            e.jsxs('div', {
                              className: 'flex items-center space-x-2 mb-2',
                              children: [
                                e.jsx(Ue, { className: 'h-5 w-5 text-red-600' }),
                                e.jsx('h4', {
                                  className: 'font-medium text-red-900',
                                  children: 'Erreurs',
                                }),
                              ],
                            }),
                            e.jsx('ul', {
                              className: 'space-y-1 text-sm text-red-800',
                              children: p.errors.map((x, E) =>
                                e.jsxs('li', { children: ['• ', x] }, E)
                              ),
                            }),
                          ],
                        }),
                      e.jsx('div', {
                        className: 'flex justify-end',
                        children: e.jsx('button', {
                          onClick: b,
                          className:
                            'px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 transition-colors',
                          children: 'Fermer',
                        }),
                      }),
                    ],
                  })
                : e.jsxs('div', {
                    className: 'space-y-6',
                    children: [
                      e.jsxs('div', {
                        className: 'bg-blue-50 border border-blue-200 rounded-lg p-4',
                        children: [
                          e.jsx('h3', {
                            className: 'font-medium text-blue-900 mb-2',
                            children: '📋 Instructions',
                          }),
                          e.jsxs('ul', {
                            className: 'text-sm text-blue-800 space-y-1',
                            children: [
                              e.jsx('li', {
                                children:
                                  '• Sélectionnez un fichier JSON contenant les orateurs et hôtes avec leurs numéros',
                              }),
                              e.jsx('li', {
                                children:
                                  '• Le fichier doit contenir les champs "speakers", "visits" et/ou "hosts"',
                              }),
                              e.jsx('li', {
                                children:
                                  '• Seuls les numéros manquants seront ajoutés (pas de remplacement)',
                              }),
                              e.jsx('li', {
                                children: '• Un rapport détaillé des modifications sera affiché',
                              }),
                            ],
                          }),
                        ],
                      }),
                      e.jsxs('div', {
                        className: 'space-y-4',
                        children: [
                          e.jsxs('div', {
                            children: [
                              e.jsx('label', {
                                className: 'block text-sm font-medium text-gray-700 mb-2',
                                children: 'Sélectionner un fichier JSON',
                              }),
                              e.jsxs('div', {
                                className: 'flex items-center space-x-4',
                                children: [
                                  e.jsx('input', {
                                    type: 'file',
                                    accept: '.json',
                                    onChange: d,
                                    title:
                                      'Sélectionner un fichier JSON contenant les numéros de téléphone',
                                    className:
                                      'block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100',
                                  }),
                                  e.jsx(ee, {
                                    className: 'h-5 w-5 text-gray-400',
                                    'aria-hidden': 'true',
                                  }),
                                ],
                              }),
                            ],
                          }),
                          e.jsxs('div', {
                            children: [
                              e.jsx('label', {
                                className: 'block text-sm font-medium text-gray-700 mb-2',
                                children: 'Ou coller le contenu JSON',
                              }),
                              e.jsx('textarea', {
                                value: S,
                                onChange: (x) => {
                                  (P(x.target.value), M(x.target.value.trim().length > 0));
                                },
                                placeholder:
                                  'Collez ici le contenu JSON avec les numéros de téléphone...',
                                className:
                                  'w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm',
                              }),
                            ],
                          }),
                          y &&
                            S.trim() &&
                            e.jsxs('div', {
                              className: 'bg-gray-50 border border-gray-200 rounded-lg p-4',
                              children: [
                                e.jsx('h4', {
                                  className: 'font-medium text-gray-900 mb-2',
                                  children: '👁️ Aperçu des données',
                                }),
                                e.jsx('div', {
                                  className: 'text-sm text-gray-600',
                                  children: (() => {
                                    try {
                                      const x = JSON.parse(S),
                                        E =
                                          x.speakers?.filter((z) => z.telephone?.trim()).length ||
                                          0,
                                        N =
                                          x.visits?.filter((z) => z.telephone?.trim()).length || 0,
                                        A = x.hosts?.filter((z) => z.telephone?.trim()).length || 0;
                                      return e.jsxs('div', {
                                        className: 'space-y-2',
                                        children: [
                                          e.jsxs('div', {
                                            className: 'flex items-center space-x-2',
                                            children: [
                                              e.jsx(ke, { className: 'h-4 w-4' }),
                                              e.jsxs('span', {
                                                children: ['Orateurs avec numéros: ', E],
                                              }),
                                            ],
                                          }),
                                          e.jsxs('div', {
                                            className: 'flex items-center space-x-2',
                                            children: [
                                              e.jsx(Be, { className: 'h-4 w-4' }),
                                              e.jsxs('span', {
                                                children: ['Visites avec numéros: ', N],
                                              }),
                                            ],
                                          }),
                                          e.jsxs('div', {
                                            className: 'flex items-center space-x-2',
                                            children: [
                                              e.jsx(oe, { className: 'h-4 w-4' }),
                                              e.jsxs('span', {
                                                children: ['Hôtes avec numéros: ', A],
                                              }),
                                            ],
                                          }),
                                        ],
                                      });
                                    } catch {
                                      return e.jsx('span', {
                                        className: 'text-red-600',
                                        children: '❌ JSON invalide',
                                      });
                                    }
                                  })(),
                                }),
                              ],
                            }),
                          y &&
                            S.trim() &&
                            e.jsxs('div', {
                              className: 'flex justify-end space-x-3',
                              children: [
                                e.jsx('button', {
                                  onClick: () => {
                                    (P(''), M(!1));
                                  },
                                  className:
                                    'px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors',
                                  children: 'Annuler',
                                }),
                                e.jsx('button', {
                                  onClick: f,
                                  disabled: k,
                                  className:
                                    'px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors',
                                  children: k ? '⏳ Import en cours...' : '📱 Importer les numéros',
                                }),
                              ],
                            }),
                        ],
                      }),
                    ],
                  }),
            }),
          ],
        }),
      })
    : null;
}
const fe = 7,
  ve = 2,
  fs = () => {
    const {
        congregationProfile: T,
        updateCongregationProfile: v,
        syncWithGoogleSheet: I,
        exportData: i,
        importData: g,
        mergeDuplicates: c,
        deleteVisit: S,
        deleteSpeaker: P,
        deleteHost: k,
        speakers: O,
        hosts: p,
        visits: R,
        archivedVisits: y,
        speakerMessages: M,
      } = ne(),
      { settings: d, updateSettings: f } = qe(),
      { addToast: b } = Ge(),
      [x, E] = h.useState('profile'),
      [N, A] = h.useState(T),
      [z, s] = h.useState(!1),
      [n, a] = h.useState(!1),
      [l, o] = h.useState(!1),
      [r, j] = h.useState(!1),
      [m, F] = h.useState(!1),
      [B, $] = h.useState(!1),
      we = [
        { id: 'profile', label: 'Profil', icon: de },
        { id: 'appearance', label: 'Apparence', icon: je },
        { id: 'notifications', label: 'Notifications', icon: pe },
        { id: 'security', label: 'Sécurité', icon: le },
        { id: 'data', label: 'Données', icon: te },
        { id: 'ai', label: 'IA', icon: be },
        { id: 'duplicates', label: 'Doublons', icon: K },
      ],
      Se = () => {
        (v(N), b('Profil mis à jour', 'success'));
      },
      Ce = (t) => {
        (f({ ...d, theme: t }), b('Thème mis à jour', 'success'));
      },
      Ae = (t) => {
        (f({ ...d, language: t }), b('Langue mise à jour', 'success'));
      },
      De = () => {
        (s(!0),
          I()
            .catch(() => b('Erreur lors de la synchronisation', 'error'))
            .finally(() => {
              s(!1);
            }));
      },
      Me = 10,
      he = (t) =>
        new Promise((u) => {
          const D = i(),
            G = new Blob([D], { type: 'application/json' }),
            w = URL.createObjectURL(G),
            C = document.createElement('a');
          ((C.href = w),
            (C.download = `kbv-backup-${new Date().toISOString().slice(0, Me)}.json`),
            document.body.appendChild(C),
            C.click(),
            document.body.removeChild(C),
            URL.revokeObjectURL(w),
            b('Sauvegarde effectuée avec succès', 'success'),
            u());
        }),
      Te = (t) =>
        new Promise((u, D) => {
          const G = new FileReader();
          ((G.onload = (w) => {
            if (w.target?.result)
              try {
                (g(w.target.result), u());
              } catch (C) {
                D(C);
              }
          }),
            (G.onerror = D),
            G.readAsText(t));
        }),
      Ie = (t, u) => {
        try {
          return (
            b('Importation effectuée avec succès', 'success'),
            Promise.resolve({
              speakersAdded: 0,
              speakersUpdated: 0,
              visitsAdded: Array.isArray(t) ? t.length : 1,
              visitsUpdated: 0,
              hostsAdded: 0,
              hostsUpdated: 0,
              errors: [],
            })
          );
        } catch (D) {
          return Promise.resolve({
            speakersAdded: 0,
            speakersUpdated: 0,
            visitsAdded: 0,
            visitsUpdated: 0,
            hostsAdded: 0,
            hostsUpdated: 0,
            errors: [String(D)],
          });
        }
      },
      Ee = (t, u, D = 'keep-recent') => {
        let w = 0;
        (t.forEach((C) => {
          if (!C.items || C.items.length < 2) return;
          const W = [...C.items];
          D === 'keep-recent' &&
            W.sort((V, ge) => {
              const Oe = new Date(V.updatedAt || V.createdAt || 0).getTime();
              return new Date(ge.updatedAt || ge.createdAt || 0).getTime() - Oe;
            });
          const J = W[0],
            ze = W.slice(1),
            Fe = C.type === 'host' ? J.nom : J.id || J.visitId,
            se = ze.map((V) => (C.type === 'host' ? V.nom : C.type === 'visit' ? V.visitId : V.id));
          u === 'merge'
            ? (c(C.type, Fe, se), w++)
            : u === 'delete' &&
              (C.type === 'speaker'
                ? se.forEach((V) => P(V))
                : C.type === 'host'
                  ? se.forEach((V) => k(V))
                  : C.type === 'visit' && se.forEach((V) => S(V)),
              w++);
        }),
          w > 0 &&
            b(
              u === 'merge'
                ? `${w} groupe(s) fusionné(s) avec succès`
                : `${w} groupe(s) nettoyé(s) (doublons supprimés)`,
              'success'
            ));
      };
    return e.jsxs('div', {
      className: 'max-w-6xl mx-auto space-y-6',
      children: [
        e.jsxs('div', {
          children: [
            e.jsx('h2', {
              className: 'text-2xl font-bold text-gray-900 dark:text-white',
              children: 'Paramètres',
            }),
            e.jsx('p', {
              className: 'text-sm text-gray-500 dark:text-gray-400 mt-1',
              children: "Gérez les paramètres de l'application et de votre congrégation",
            }),
          ],
        }),
        e.jsxs('div', {
          className: 'flex flex-col lg:flex-row gap-6',
          children: [
            e.jsx('div', {
              className: 'lg:w-64',
              children: e.jsx(U, {
                children: e.jsx(q, {
                  className: 'p-2',
                  children: e.jsx('nav', {
                    className: 'space-y-1',
                    children: we.map((t) =>
                      e.jsxs(
                        'button',
                        {
                          onClick: () => E(t.id),
                          className: `
                      w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${x === t.id ? 'bg-primary-100 text-primary-700 dark:bg-primary-900/50 dark:text-primary-300' : 'text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800'}`,
                          children: [e.jsx(t.icon, { className: 'w-4 h-4' }), t.label],
                        },
                        t.id
                      )
                    ),
                  }),
                }),
              }),
            }),
            e.jsxs('div', {
              className: 'flex-1 min-h-[600px]',
              children: [
                x === 'profile' &&
                  e.jsxs(U, {
                    children: [
                      e.jsxs(_, {
                        children: [
                          e.jsxs('h3', {
                            className:
                              'text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2',
                            children: [
                              e.jsx(de, { className: 'w-5 h-5' }),
                              'Profil de la Congrégation',
                            ],
                          }),
                          e.jsx('p', {
                            className: 'text-sm text-gray-500 dark:text-gray-400 mt-1',
                            children: 'Informations générales sur votre congrégation',
                          }),
                        ],
                      }),
                      e.jsxs(q, {
                        className: 'space-y-6',
                        children: [
                          e.jsxs('div', {
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-6',
                            children: [
                              e.jsxs('div', {
                                children: [
                                  e.jsx('label', {
                                    className:
                                      'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                    children: 'Nom de la congrégation',
                                  }),
                                  e.jsx(X, {
                                    value: N.name,
                                    onChange: (t) => A({ ...N, name: t.target.value }),
                                    placeholder: 'Ex: KBV DV Lyon',
                                  }),
                                ],
                              }),
                              e.jsxs('div', {
                                children: [
                                  e.jsx('label', {
                                    className:
                                      'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                    children: 'Ville',
                                  }),
                                  e.jsx(X, {
                                    value: N.city || '',
                                    onChange: (t) => A({ ...N, city: t.target.value }),
                                    placeholder: 'Ex: Lyon',
                                  }),
                                ],
                              }),
                              e.jsxs('div', {
                                children: [
                                  e.jsx('label', {
                                    className:
                                      'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                    children: 'Responsable Accueil',
                                  }),
                                  e.jsx(X, {
                                    value: N.hospitalityOverseer,
                                    onChange: (t) =>
                                      A({ ...N, hospitalityOverseer: t.target.value }),
                                    placeholder: 'Nom du responsable',
                                  }),
                                ],
                              }),
                              e.jsxs('div', {
                                children: [
                                  e.jsx('label', {
                                    className:
                                      'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                    children: 'Téléphone Responsable',
                                  }),
                                  e.jsx(X, {
                                    value: N.hospitalityOverseerPhone,
                                    onChange: (t) =>
                                      A({ ...N, hospitalityOverseerPhone: t.target.value }),
                                    placeholder: '+33 6 XX XX XX XX',
                                  }),
                                ],
                              }),
                              e.jsxs('div', {
                                children: [
                                  e.jsx('label', {
                                    className:
                                      'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                    children: 'Jour de réunion',
                                  }),
                                  e.jsx(re, {
                                    value: N.meetingDay || 'Samedi',
                                    onChange: (t) => A({ ...N, meetingDay: t.target.value }),
                                    options: [
                                      { value: 'Dimanche', label: 'Dimanche' },
                                      { value: 'Lundi', label: 'Lundi' },
                                      { value: 'Mardi', label: 'Mardi' },
                                      { value: 'Mercredi', label: 'Mercredi' },
                                      { value: 'Jeudi', label: 'Jeudi' },
                                      { value: 'Vendredi', label: 'Vendredi' },
                                      { value: 'Samedi', label: 'Samedi' },
                                    ],
                                  }),
                                ],
                              }),
                              e.jsxs('div', {
                                children: [
                                  e.jsx('label', {
                                    className:
                                      'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                    children: 'Heure de réunion',
                                  }),
                                  e.jsx(X, {
                                    type: 'time',
                                    value: N.meetingTime || '14:30',
                                    onChange: (t) => A({ ...N, meetingTime: t.target.value }),
                                  }),
                                ],
                              }),
                            ],
                          }),
                          e.jsx('div', {
                            className: 'flex justify-end',
                            children: e.jsx(L, {
                              leftIcon: e.jsx(me, { className: 'w-4 h-4' }),
                              onClick: Se,
                              children: 'Enregistrer',
                            }),
                          }),
                        ],
                      }),
                    ],
                  }),
                x === 'appearance' &&
                  e.jsxs(U, {
                    children: [
                      e.jsxs(_, {
                        children: [
                          e.jsxs('h3', {
                            className:
                              'text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2',
                            children: [e.jsx(je, { className: 'w-5 h-5' }), 'Apparence'],
                          }),
                          e.jsx('p', {
                            className: 'text-sm text-gray-500 dark:text-gray-400 mt-1',
                            children: "Personnalisez l'apparence de l'application",
                          }),
                        ],
                      }),
                      e.jsxs(q, {
                        className: 'space-y-6',
                        children: [
                          e.jsxs('div', {
                            children: [
                              e.jsx('label', {
                                className:
                                  'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3',
                                children: 'Thème',
                              }),
                              e.jsx('div', {
                                className: 'grid grid-cols-3 gap-3',
                                children: [
                                  { value: 'light', label: 'Clair', icon: Qe },
                                  { value: 'dark', label: 'Sombre', icon: Xe },
                                  { value: 'auto', label: 'Auto', icon: We },
                                ].map((t) =>
                                  e.jsxs(
                                    'button',
                                    {
                                      onClick: () => Ce(t.value),
                                      className: `p-4 border rounded-lg transition-all ${d.theme === t.value ? 'border-primary-500 bg-primary-50 dark:bg-primary-900/20' : 'border-gray-200 dark:border-gray-700 hover:border-gray-300'}`,
                                      children: [
                                        e.jsx(t.icon, {
                                          className:
                                            'w-6 h-6 mx-auto mb-2 text-gray-600 dark:text-gray-400',
                                        }),
                                        e.jsx('div', {
                                          className: 'text-sm font-medium',
                                          children: t.label,
                                        }),
                                      ],
                                    },
                                    t.value
                                  )
                                ),
                              }),
                            ],
                          }),
                          e.jsxs('div', {
                            children: [
                              e.jsx('label', {
                                className:
                                  'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3',
                                children: 'Langue',
                              }),
                              e.jsx(re, {
                                value: d.language,
                                onChange: (t) => Ae(t.target.value),
                                options: [
                                  { value: 'fr', label: 'Français' },
                                  { value: 'cv', label: 'Capverdien' },
                                  { value: 'pt', label: 'Portugais' },
                                ],
                                className: 'max-w-xs',
                              }),
                            ],
                          }),
                        ],
                      }),
                    ],
                  }),
                x === 'notifications' &&
                  e.jsxs(U, {
                    children: [
                      e.jsxs(_, {
                        children: [
                          e.jsxs('h3', {
                            className:
                              'text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2',
                            children: [e.jsx(pe, { className: 'w-5 h-5' }), 'Notifications'],
                          }),
                          e.jsx('p', {
                            className: 'text-sm text-gray-500 dark:text-gray-400 mt-1',
                            children: 'Gérez vos préférences de notifications',
                          }),
                        ],
                      }),
                      e.jsx(q, {
                        className: 'space-y-6',
                        children: e.jsxs('div', {
                          className: 'space-y-4',
                          children: [
                            e.jsxs('div', {
                              className: 'flex items-center justify-between',
                              children: [
                                e.jsxs('label', {
                                  htmlFor: 'notifications-enabled',
                                  className: 'cursor-pointer',
                                  children: [
                                    e.jsx('div', {
                                      className: 'font-medium text-gray-900 dark:text-white',
                                      children: 'Notifications activées',
                                    }),
                                    e.jsx('div', {
                                      className: 'text-sm text-gray-500 dark:text-gray-400',
                                      children: 'Recevoir des rappels et alertes',
                                    }),
                                  ],
                                }),
                                e.jsx('input', {
                                  id: 'notifications-enabled',
                                  type: 'checkbox',
                                  checked: d.notifications.enabled,
                                  onChange: (t) =>
                                    f({
                                      ...d,
                                      notifications: {
                                        ...d.notifications,
                                        enabled: t.target.checked,
                                      },
                                    }),
                                  className: 'rounded',
                                }),
                              ],
                            }),
                            d.notifications.enabled &&
                              e.jsxs(e.Fragment, {
                                children: [
                                  e.jsxs('div', {
                                    className: 'border-t border-gray-200 dark:border-gray-700 pt-4',
                                    children: [
                                      e.jsx('h4', {
                                        className: 'font-medium text-gray-900 dark:text-white mb-3',
                                        children: 'Rappels automatiques',
                                      }),
                                      e.jsx('div', {
                                        className: 'space-y-3',
                                        children: [
                                          {
                                            value: fe,
                                            days: fe,
                                            description: '1 semaine avant la visite',
                                          },
                                          {
                                            value: ve,
                                            days: ve,
                                            description: '2 jours avant la visite',
                                          },
                                        ].map(({ value: t, days: u, description: D }) =>
                                          e.jsxs(
                                            'div',
                                            {
                                              className: 'flex items-center justify-between',
                                              children: [
                                                e.jsxs('label', {
                                                  htmlFor: `reminder-${t}`,
                                                  className: 'cursor-pointer',
                                                  children: [
                                                    e.jsxs('div', {
                                                      className:
                                                        'font-medium text-gray-900 dark:text-white',
                                                      children: ['J-', u],
                                                    }),
                                                    e.jsx('div', {
                                                      className:
                                                        'text-sm text-gray-500 dark:text-gray-400',
                                                      children: D,
                                                    }),
                                                  ],
                                                }),
                                                e.jsx('input', {
                                                  id: `reminder-${t}`,
                                                  type: 'checkbox',
                                                  checked: d.notifications.reminderDays.includes(u),
                                                  onChange: (G) => {
                                                    const w = G.target.checked
                                                      ? [...d.notifications.reminderDays, u]
                                                      : d.notifications.reminderDays.filter(
                                                          (C) => C !== u
                                                        );
                                                    f({
                                                      ...d,
                                                      notifications: {
                                                        ...d.notifications,
                                                        reminderDays: w,
                                                      },
                                                    });
                                                  },
                                                  className: 'rounded',
                                                }),
                                              ],
                                            },
                                            t
                                          )
                                        ),
                                      }),
                                    ],
                                  }),
                                  e.jsxs('div', {
                                    className: 'border-t border-gray-200 dark:border-gray-700 pt-4',
                                    children: [
                                      e.jsx('h4', {
                                        className: 'font-medium text-gray-900 dark:text-white mb-3',
                                        children: 'Options',
                                      }),
                                      e.jsxs('div', {
                                        className: 'space-y-3',
                                        children: [
                                          e.jsxs('div', {
                                            className: 'flex items-center justify-between',
                                            children: [
                                              e.jsxs('label', {
                                                htmlFor: 'sound-enabled',
                                                className: 'cursor-pointer',
                                                children: [
                                                  e.jsx('div', {
                                                    className:
                                                      'font-medium text-gray-900 dark:text-white',
                                                    children: 'Son',
                                                  }),
                                                  e.jsx('div', {
                                                    className:
                                                      'text-sm text-gray-500 dark:text-gray-400',
                                                    children: 'Jouer un son pour les notifications',
                                                  }),
                                                ],
                                              }),
                                              e.jsx('input', {
                                                id: 'sound-enabled',
                                                type: 'checkbox',
                                                checked: d.notifications.sound,
                                                onChange: (t) =>
                                                  f({
                                                    ...d,
                                                    notifications: {
                                                      ...d.notifications,
                                                      sound: t.target.checked,
                                                    },
                                                  }),
                                                className: 'rounded',
                                              }),
                                            ],
                                          }),
                                          e.jsxs('div', {
                                            className: 'flex items-center justify-between',
                                            children: [
                                              e.jsxs('label', {
                                                htmlFor: 'vibration-enabled',
                                                className: 'cursor-pointer',
                                                children: [
                                                  e.jsx('div', {
                                                    className:
                                                      'font-medium text-gray-900 dark:text-white',
                                                    children: 'Vibration',
                                                  }),
                                                  e.jsx('div', {
                                                    className:
                                                      'text-sm text-gray-500 dark:text-gray-400',
                                                    children: "Faire vibrer l'appareil",
                                                  }),
                                                ],
                                              }),
                                              e.jsx('input', {
                                                id: 'vibration-enabled',
                                                type: 'checkbox',
                                                checked: d.notifications.vibration,
                                                onChange: (t) =>
                                                  f({
                                                    ...d,
                                                    notifications: {
                                                      ...d.notifications,
                                                      vibration: t.target.checked,
                                                    },
                                                  }),
                                                className: 'rounded',
                                              }),
                                            ],
                                          }),
                                        ],
                                      }),
                                    ],
                                  }),
                                ],
                              }),
                          ],
                        }),
                      }),
                    ],
                  }),
                x === 'security' &&
                  e.jsxs(U, {
                    children: [
                      e.jsxs(_, {
                        children: [
                          e.jsxs('h3', {
                            className:
                              'text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2',
                            children: [e.jsx(le, { className: 'w-5 h-5' }), 'Sécurité'],
                          }),
                          e.jsx('p', {
                            className: 'text-sm text-gray-500 dark:text-gray-400 mt-1',
                            children: 'Gérez la sécurité et le chiffrement des données',
                          }),
                        ],
                      }),
                      e.jsx(q, {
                        className: 'space-y-6',
                        children: e.jsxs('div', {
                          className: 'space-y-4',
                          children: [
                            e.jsxs('div', {
                              className: 'flex items-center justify-between',
                              children: [
                                e.jsxs('label', {
                                  htmlFor: 'encryption-enabled',
                                  className: 'cursor-pointer',
                                  children: [
                                    e.jsx('div', {
                                      className: 'font-medium text-gray-900 dark:text-white',
                                      children: 'Chiffrement activé',
                                    }),
                                    e.jsx('div', {
                                      className: 'text-sm text-gray-500 dark:text-gray-400',
                                      children:
                                        'Protéger les données sensibles avec un chiffrement AES-GCM',
                                    }),
                                  ],
                                }),
                                e.jsx('input', {
                                  id: 'encryption-enabled',
                                  type: 'checkbox',
                                  checked: d.encryptionEnabled,
                                  onChange: (t) => f({ ...d, encryptionEnabled: t.target.checked }),
                                  className: 'rounded',
                                }),
                              ],
                            }),
                            e.jsxs('div', {
                              className: 'border-t border-gray-200 dark:border-gray-700 pt-4',
                              children: [
                                e.jsx('label', {
                                  className:
                                    'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                  children: 'Timeout de session (minutes)',
                                }),
                                e.jsx(re, {
                                  value: d.sessionTimeout?.toString() || '30',
                                  onChange: (t) =>
                                    f({ ...d, sessionTimeout: parseInt(t.target.value, 10) }),
                                  options: [
                                    { value: '15', label: '15 minutes' },
                                    { value: '30', label: '30 minutes' },
                                    { value: '60', label: '1 heure' },
                                    { value: '120', label: '2 heures' },
                                  ],
                                  className: 'max-w-xs',
                                }),
                              ],
                            }),
                            e.jsx('div', {
                              className: 'border-t border-gray-200 dark:border-gray-700 pt-4',
                              children: e.jsxs('div', {
                                className: 'flex items-center gap-2',
                                children: [
                                  e.jsx(Ze, { className: 'w-4 h-4 text-gray-500' }),
                                  e.jsx('span', {
                                    className: 'text-sm text-gray-600 dark:text-gray-400',
                                    children: 'Version 1.20.0',
                                  }),
                                ],
                              }),
                            }),
                          ],
                        }),
                      }),
                    ],
                  }),
                x === 'data' &&
                  e.jsxs(U, {
                    children: [
                      e.jsxs(_, {
                        children: [
                          e.jsxs('h3', {
                            className:
                              'text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2',
                            children: [e.jsx(te, { className: 'w-5 h-5' }), 'Gestion des Données'],
                          }),
                          e.jsx('p', {
                            className: 'text-sm text-gray-500 dark:text-gray-400 mt-1',
                            children: 'Synchronisation, sauvegardes et archives',
                          }),
                        ],
                      }),
                      e.jsx(q, {
                        className: 'space-y-6',
                        children: e.jsxs('div', {
                          className: 'space-y-6',
                          children: [
                            e.jsxs('div', {
                              className:
                                'bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4',
                              children: [
                                e.jsx('h4', {
                                  className: 'font-medium text-blue-900 dark:text-blue-300 mb-2',
                                  children: 'Synchronisation Google Sheets',
                                }),
                                e.jsx('p', {
                                  className: 'text-sm text-blue-700 dark:text-blue-400 mb-4',
                                  children:
                                    "Cette fonction récupère automatiquement les visites programmées depuis votre Google Sheet et met à jour l'application. Les orateurs et visites existants seront fusionnés intelligemment.",
                                }),
                                e.jsxs('div', {
                                  className: 'flex flex-col sm:flex-row gap-4 items-center',
                                  children: [
                                    e.jsx(L, {
                                      leftIcon: e.jsx(Ve, {
                                        className: `w-4 h-4 ${z ? 'animate-spin' : ''}`,
                                      }),
                                      onClick: De,
                                      disabled: z,
                                      children: z
                                        ? 'Synchronisation en cours...'
                                        : 'Synchroniser maintenant',
                                    }),
                                    localStorage.getItem('lastGoogleSheetSync') &&
                                      e.jsxs('p', {
                                        className: 'text-xs text-gray-600 dark:text-gray-400',
                                        children: [
                                          'Dernière synchro : ',
                                          new Date(
                                            localStorage.getItem('lastGoogleSheetSync')
                                          ).toLocaleString('fr-FR'),
                                        ],
                                      }),
                                  ],
                                }),
                              ],
                            }),
                            e.jsxs('div', {
                              className: 'grid grid-cols-1 md:grid-cols-2 gap-4',
                              children: [
                                e.jsxs('button', {
                                  onClick: () => a(!0),
                                  className:
                                    'flex items-center gap-4 p-4 text-left border rounded-lg transition-all hover:border-primary-500 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800',
                                  children: [
                                    e.jsx('div', {
                                      className:
                                        'p-3 bg-green-100 text-green-600 rounded-full dark:bg-green-900/30 dark:text-green-400',
                                      children: e.jsx(me, { className: 'w-6 h-6' }),
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('div', {
                                          className: 'font-medium text-gray-900 dark:text-white',
                                          children: 'Sauvegardes',
                                        }),
                                        e.jsx('div', {
                                          className: 'text-xs text-gray-500 dark:text-gray-400',
                                          children: 'Gérer les backups locaux et chiffrés',
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                                e.jsxs('button', {
                                  onClick: () => o(!0),
                                  className:
                                    'flex items-center gap-4 p-4 text-left border rounded-lg transition-all hover:border-primary-500 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800',
                                  children: [
                                    e.jsx('div', {
                                      className:
                                        'p-3 bg-purple-100 text-purple-600 rounded-full dark:bg-purple-900/30 dark:text-purple-400',
                                      children: e.jsx(te, { className: 'w-6 h-6' }),
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('div', {
                                          className: 'font-medium text-gray-900 dark:text-white',
                                          children: 'Importer des données',
                                        }),
                                        e.jsx('div', {
                                          className: 'text-xs text-gray-500 dark:text-gray-400',
                                          children: "Assistant d'importation CSV/JSON",
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                                e.jsxs('button', {
                                  onClick: () => j(!0),
                                  className:
                                    'flex items-center gap-4 p-4 text-left border rounded-lg transition-all hover:border-primary-500 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800',
                                  children: [
                                    e.jsx('div', {
                                      className:
                                        'p-3 bg-orange-100 text-orange-600 rounded-full dark:bg-orange-900/30 dark:text-orange-400',
                                      children: e.jsx(te, { className: 'w-6 h-6' }),
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('div', {
                                          className: 'font-medium text-gray-900 dark:text-white',
                                          children: 'Archives',
                                        }),
                                        e.jsx('div', {
                                          className: 'text-xs text-gray-500 dark:text-gray-400',
                                          children: "Consulter l'historique des visites",
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                                e.jsxs('button', {
                                  onClick: () => $(!0),
                                  className:
                                    'flex items-center gap-4 p-4 text-left border rounded-lg transition-all hover:border-primary-500 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800',
                                  children: [
                                    e.jsx('div', {
                                      className:
                                        'p-3 bg-indigo-100 text-indigo-600 rounded-full dark:bg-indigo-900/30 dark:text-indigo-400',
                                      children: e.jsx(oe, { className: 'w-6 h-6' }),
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('div', {
                                          className: 'font-medium text-gray-900 dark:text-white',
                                          children: 'Numéros de Téléphone',
                                        }),
                                        e.jsx('div', {
                                          className: 'text-xs text-gray-500 dark:text-gray-400',
                                          children: 'Importer les numéros depuis JSON',
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                              ],
                            }),
                            e.jsxs('div', {
                              className: 'border-t border-gray-200 dark:border-gray-700 pt-4',
                              children: [
                                e.jsxs('h4', {
                                  className:
                                    'font-medium text-gray-900 dark:text-white mb-3 flex items-center gap-2',
                                  children: [e.jsx(Ke, { className: 'w-4 h-4' }), 'Liens Utiles'],
                                }),
                                e.jsxs('div', {
                                  className: 'flex flex-col sm:flex-row gap-4',
                                  children: [
                                    e.jsx(L, {
                                      asChild: !0,
                                      variant: 'secondary',
                                      children: e.jsx('a', {
                                        href: 'https://docs.google.com/spreadsheets/d/1drIzPPi6AohCroSyUkF1UmMFxuEtMACBF4XATDjBOcg',
                                        target: '_blank',
                                        rel: 'noopener noreferrer',
                                        className: 'no-underline',
                                        children: 'Ouvrir Google Sheet',
                                      }),
                                    }),
                                    e.jsx(L, {
                                      asChild: !0,
                                      variant: 'outline',
                                      children: e.jsx('a', {
                                        href: 'https://www.jw.org/kea/',
                                        target: '_blank',
                                        rel: 'noopener noreferrer',
                                        className: 'no-underline',
                                        children: 'JW.ORG (Cap-Verdien)',
                                      }),
                                    }),
                                  ],
                                }),
                              ],
                            }),
                          ],
                        }),
                      }),
                    ],
                  }),
                x === 'ai' &&
                  e.jsxs(U, {
                    children: [
                      e.jsxs(_, {
                        children: [
                          e.jsxs('h3', {
                            className:
                              'text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2',
                            children: [e.jsx(be, { className: 'w-5 h-5' }), 'Configuration IA'],
                          }),
                          e.jsx('p', {
                            className: 'text-sm text-gray-500 dark:text-gray-400 mt-1',
                            children: "Paramètres de l'assistant IA pour la génération de messages",
                          }),
                        ],
                      }),
                      e.jsxs(q, {
                        className: 'space-y-6',
                        children: [
                          e.jsxs('div', {
                            className:
                              'flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg',
                            children: [
                              e.jsxs('label', {
                                htmlFor: 'ai-enabled',
                                className: 'cursor-pointer',
                                children: [
                                  e.jsx('div', {
                                    className: 'font-medium text-blue-900 dark:text-blue-300',
                                    children: 'Assistant IA activé',
                                  }),
                                  e.jsx('div', {
                                    className: 'text-sm text-blue-700 dark:text-blue-400',
                                    children:
                                      'Utiliser Gemini pour générer des messages personnalisés',
                                  }),
                                ],
                              }),
                              e.jsx('input', {
                                id: 'ai-enabled',
                                type: 'checkbox',
                                checked: d.aiSettings.enabled,
                                onChange: (t) =>
                                  f({
                                    ...d,
                                    aiSettings: { ...d.aiSettings, enabled: t.target.checked },
                                  }),
                                className: 'rounded',
                              }),
                            ],
                          }),
                          d.aiSettings.enabled &&
                            e.jsxs(e.Fragment, {
                              children: [
                                e.jsxs('div', {
                                  className: 'space-y-4',
                                  children: [
                                    e.jsx('h4', {
                                      className: 'font-medium text-gray-900 dark:text-white',
                                      children: 'Connexion API',
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('label', {
                                          className:
                                            'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                          children: 'Clé API Gemini',
                                        }),
                                        e.jsx(X, {
                                          type: 'password',
                                          value: d.aiSettings.apiKey || '',
                                          onChange: (t) =>
                                            f({
                                              ...d,
                                              aiSettings: {
                                                ...d.aiSettings,
                                                apiKey: t.target.value,
                                              },
                                            }),
                                          placeholder: 'AIza...',
                                        }),
                                        e.jsxs('p', {
                                          className:
                                            'text-xs text-gray-500 dark:text-gray-400 mt-1',
                                          children: [
                                            'Obtenez votre clé sur',
                                            ' ',
                                            e.jsx('a', {
                                              href: 'https://makersuite.google.com/app/apikey',
                                              target: '_blank',
                                              rel: 'noopener noreferrer',
                                              className:
                                                'text-primary-600 dark:text-primary-400 hover:underline',
                                              children: 'Google AI Studio',
                                            }),
                                          ],
                                        }),
                                      ],
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('label', {
                                          className:
                                            'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                          children: 'Modèle',
                                        }),
                                        e.jsx(re, {
                                          value: d.aiSettings.model,
                                          onChange: (t) =>
                                            f({
                                              ...d,
                                              aiSettings: {
                                                ...d.aiSettings,
                                                model: t.target.value,
                                              },
                                            }),
                                          options: [
                                            {
                                              value: 'gemini-pro',
                                              label: 'Gemini Pro (Recommandé)',
                                            },
                                            { value: 'gemini-1.5-pro', label: 'Gemini 1.5 Pro' },
                                            {
                                              value: 'gemini-1.5-flash',
                                              label: 'Gemini 1.5 Flash (Rapide)',
                                            },
                                          ],
                                          className: 'max-w-xs',
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                                e.jsxs('div', {
                                  className:
                                    'border-t border-gray-200 dark:border-gray-700 pt-4 space-y-4',
                                  children: [
                                    e.jsx('h4', {
                                      className: 'font-medium text-gray-900 dark:text-white',
                                      children: 'Paramètres de génération',
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsxs('label', {
                                          className:
                                            'block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2',
                                          children: [
                                            'Créativité (Température): ',
                                            d.aiSettings.temperature.toFixed(1),
                                          ],
                                        }),
                                        e.jsxs('div', {
                                          className: 'flex items-center gap-4',
                                          children: [
                                            e.jsx('span', {
                                              className: 'text-xs text-gray-500',
                                              children: 'Précis',
                                            }),
                                            e.jsx('input', {
                                              type: 'range',
                                              min: '0',
                                              max: '1',
                                              step: '0.1',
                                              value: d.aiSettings.temperature,
                                              onChange: (t) =>
                                                f({
                                                  ...d,
                                                  aiSettings: {
                                                    ...d.aiSettings,
                                                    temperature: parseFloat(t.target.value),
                                                  },
                                                }),
                                              'aria-label': 'Créativité - Température',
                                              className: 'flex-1',
                                            }),
                                            e.jsx('span', {
                                              className: 'text-xs text-gray-500',
                                              children: 'Créatif',
                                            }),
                                          ],
                                        }),
                                        e.jsx('p', {
                                          className:
                                            'text-xs text-gray-500 dark:text-gray-400 mt-1',
                                          children:
                                            'Valeur recommandée: 0.7 pour un équilibre entre précision et créativité',
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                                e.jsx('div', {
                                  className: 'border-t border-gray-200 dark:border-gray-700 pt-4',
                                  children: e.jsxs('div', {
                                    className:
                                      'bg-gray-50 dark:bg-gray-800 rounded-lg p-4 space-y-2',
                                    children: [
                                      e.jsx('h4', {
                                        className:
                                          'font-medium text-gray-900 dark:text-white text-sm',
                                        children: "💡 Conseils d'utilisation",
                                      }),
                                      e.jsxs('ul', {
                                        className:
                                          'text-xs text-gray-600 dark:text-gray-400 space-y-1 list-disc list-inside',
                                        children: [
                                          e.jsx('li', {
                                            children:
                                              'Gemini Pro est recommandé pour la plupart des usages',
                                          }),
                                          e.jsx('li', {
                                            children:
                                              'Gemini 1.5 Flash est plus rapide mais moins précis',
                                          }),
                                          e.jsx('li', {
                                            children:
                                              'Une température de 0.7 offre un bon équilibre',
                                          }),
                                          e.jsx('li', {
                                            children:
                                              'Votre clé API est stockée de manière sécurisée',
                                          }),
                                        ],
                                      }),
                                    ],
                                  }),
                                }),
                              ],
                            }),
                        ],
                      }),
                    ],
                  }),
                x === 'duplicates' &&
                  e.jsxs(U, {
                    children: [
                      e.jsxs(_, {
                        children: [
                          e.jsxs('h3', {
                            className:
                              'text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2',
                            children: [e.jsx(K, { className: 'w-5 h-5' }), 'Détection de Doublons'],
                          }),
                          e.jsx('p', {
                            className: 'text-sm text-gray-500 dark:text-gray-400 mt-1',
                            children:
                              'Analysez et fusionnez les doublons dans votre base de données (y compris les archives)',
                          }),
                        ],
                      }),
                      e.jsxs(q, {
                        className: 'space-y-6',
                        children: [
                          e.jsxs('div', {
                            className: 'grid grid-cols-2 md:grid-cols-5 gap-4',
                            children: [
                              e.jsx('div', {
                                className:
                                  'bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800',
                                children: e.jsxs('div', {
                                  className: 'flex items-center gap-3',
                                  children: [
                                    e.jsx(de, {
                                      className: 'w-6 h-6 text-blue-600 dark:text-blue-400',
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('div', {
                                          className:
                                            'text-2xl font-bold text-blue-900 dark:text-blue-100',
                                          children: (() => {
                                            const t = new Map();
                                            return (
                                              O.forEach((u) => {
                                                const D = u.nom
                                                  .toLowerCase()
                                                  .trim()
                                                  .replace(/\s+/g, ' ');
                                                t.set(D, (t.get(D) || 0) + 1);
                                              }),
                                              Array.from(t.values()).filter((u) => u > 1).length
                                            );
                                          })(),
                                        }),
                                        e.jsx('div', {
                                          className: 'text-xs text-blue-700 dark:text-blue-300',
                                          children: 'Orateurs',
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                              }),
                              e.jsx('div', {
                                className:
                                  'bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800',
                                children: e.jsxs('div', {
                                  className: 'flex items-center gap-3',
                                  children: [
                                    e.jsx(ke, {
                                      className: 'w-6 h-6 text-green-600 dark:text-green-400',
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('div', {
                                          className:
                                            'text-2xl font-bold text-green-900 dark:text-green-100',
                                          children: (() => {
                                            const t = new Map();
                                            return (
                                              p.forEach((u) => {
                                                const D = u.nom
                                                  .toLowerCase()
                                                  .trim()
                                                  .replace(/\s+/g, ' ');
                                                t.set(D, (t.get(D) || 0) + 1);
                                              }),
                                              Array.from(t.values()).filter((u) => u > 1).length
                                            );
                                          })(),
                                        }),
                                        e.jsx('div', {
                                          className: 'text-xs text-green-700 dark:text-green-300',
                                          children: 'Hôtes',
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                              }),
                              e.jsx('div', {
                                className:
                                  'bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800',
                                children: e.jsxs('div', {
                                  className: 'flex items-center gap-3',
                                  children: [
                                    e.jsx(K, {
                                      className: 'w-6 h-6 text-purple-600 dark:text-purple-400',
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('div', {
                                          className:
                                            'text-2xl font-bold text-purple-900 dark:text-purple-100',
                                          children: (() => {
                                            const t = new Map();
                                            return (
                                              R.forEach((u) => {
                                                const D = `${u.id}-${u.visitDate}-${u.visitTime}`;
                                                t.set(D, (t.get(D) || 0) + 1);
                                              }),
                                              Array.from(t.values()).filter((u) => u > 1).length
                                            );
                                          })(),
                                        }),
                                        e.jsx('div', {
                                          className: 'text-xs text-purple-700 dark:text-purple-300',
                                          children: 'Visites',
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                              }),
                              e.jsx('div', {
                                className:
                                  'bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800',
                                children: e.jsxs('div', {
                                  className: 'flex items-center gap-3',
                                  children: [
                                    e.jsx(K, {
                                      className: 'w-6 h-6 text-orange-600 dark:text-orange-400',
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('div', {
                                          className:
                                            'text-2xl font-bold text-orange-900 dark:text-orange-100',
                                          children: (() => {
                                            if (!y) return 0;
                                            const t = new Map();
                                            y.forEach((w) => {
                                              const C = `${w.id}-${w.visitDate}-${w.visitTime}`;
                                              t.set(C, (t.get(C) || 0) + 1);
                                            });
                                            const u = new Map();
                                            R.forEach((w) => {
                                              const C = `${w.id}-${w.visitDate}-${w.visitTime || ''}`,
                                                W = y.filter(
                                                  (J) =>
                                                    J.id === w.id &&
                                                    J.visitDate === w.visitDate &&
                                                    J.visitTime === w.visitTime
                                                );
                                              W.length > 0 &&
                                                u.set(C, (u.get(C) || 0) + W.length + 1);
                                            });
                                            const D = Array.from(t.values()).filter(
                                                (w) => w > 1
                                              ).length,
                                              G = Array.from(u.values()).filter(
                                                (w) => w > 1
                                              ).length;
                                            return D + G;
                                          })(),
                                        }),
                                        e.jsx('div', {
                                          className: 'text-xs text-orange-700 dark:text-orange-300',
                                          children: 'Archives',
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                              }),
                              e.jsx('div', {
                                className:
                                  'bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800',
                                children: e.jsxs('div', {
                                  className: 'flex items-center gap-3',
                                  children: [
                                    e.jsx(K, {
                                      className: 'w-6 h-6 text-red-600 dark:text-red-400',
                                    }),
                                    e.jsxs('div', {
                                      children: [
                                        e.jsx('div', {
                                          className:
                                            'text-2xl font-bold text-red-900 dark:text-red-100',
                                          children: (() => {
                                            const t = new Map();
                                            M &&
                                              M.forEach((D) => {
                                                const G = D.message?.trim().toLowerCase() || '',
                                                  w = D.receivedAt
                                                    ? new Date(D.receivedAt).toISOString()
                                                    : 'no-date',
                                                  C = `${D.speakerId}-${G}-${w}`;
                                                t.set(C, (t.get(C) || 0) + 1);
                                              });
                                            const u = 1;
                                            return Array.from(t.values()).filter((D) => D > u)
                                              .length;
                                          })(),
                                        }),
                                        e.jsx('div', {
                                          className: 'text-xs text-red-700 dark:text-red-300',
                                          children: 'Messages',
                                        }),
                                      ],
                                    }),
                                  ],
                                }),
                              }),
                            ],
                          }),
                          e.jsxs('div', {
                            className: 'text-center pt-4',
                            children: [
                              e.jsxs(L, {
                                onClick: () => F(!0),
                                size: 'lg',
                                children: [
                                  e.jsx(K, { className: 'w-4 h-4 mr-2' }),
                                  "Lancer l'analyse complète",
                                ],
                              }),
                              e.jsx('p', {
                                className: 'text-sm text-gray-500 dark:text-gray-400 mt-3',
                                children: 'Cliquez pour voir les détails et fusionner les doublons',
                              }),
                            ],
                          }),
                        ],
                      }),
                    ],
                  }),
              ],
            }),
          ],
        }),
        e.jsx(ss, { isOpen: n, onClose: () => a(!1), onBackup: he, onRestore: Te }),
        e.jsx(rs, { isOpen: l, onClose: () => o(!1), onImport: Ie }),
        e.jsx(ts, {
          isOpen: r,
          onClose: () => j(!1),
          onRestore: (t) => {
            (t.forEach((u) => {}), b(`${t.length} visite(s) restaurée(s)`, 'success'));
          },
          onDelete: (t) => {
            (t.forEach((u) => S(u)), b(`${t.length} visite(s) supprimée(s)`, 'info'));
          },
          onExport: async (t) => {
            await he();
          },
        }),
        e.jsx(es, { isOpen: m, onClose: () => F(!1), onMerge: Ee }),
        e.jsx(cs, { isOpen: B, onClose: () => $(!1) }),
      ],
    });
  };
export { fs as Settings, fs as default };
//# sourceMappingURL=Settings-yH4dBQNe.js.map
