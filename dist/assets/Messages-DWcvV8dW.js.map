{"version":3,"file":"Messages-DWcvV8dW.js","sources":["../../src/components/messages/MessageThread.tsx","../../src/components/messages/HostRequestModal.tsx","../../src/pages/Messages.tsx"],"sourcesContent":["import React from 'react';\nimport { Speaker, Visit } from '@/types';\nimport { format } from 'date-fns';\nimport { fr } from 'date-fns/locale';\nimport { Button } from '@/components/ui/Button';\nimport { Card, CardBody } from '@/components/ui/Card';\nimport { CommunicationProgress } from '@/components/messages/CommunicationProgress';\nimport { Phone, Mail, MessageSquare, Calendar, MapPin, User, Clock } from 'lucide-react';\nimport { getTalkTitle } from '@/data/talkTitles';\n\ninterface MessageThreadProps {\n  speaker: Speaker;\n  visits: Visit[];\n  onAction: (action: string, visit?: Visit) => void;\n}\n\nexport const MessageThread: React.FC<MessageThreadProps> = ({ speaker, visits, onAction }) => {\n  // Deduplicate visits based on ID\n  const uniqueVisits = visits.filter(\n    (visit, index, self) => index === self.findIndex((t) => t.id === visit.id)\n  );\n\n  // Trier les visites par date d√©croissante\n  const sortedVisits = [...uniqueVisits].sort(\n    (a, b) => new Date(b.visitDate).getTime() - new Date(a.visitDate).getTime()\n  );\n\n  return (\n    <div className='flex flex-col h-full bg-gray-50 dark:bg-gray-900'>\n      {/* Header */}\n      <div className='bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 flex items-center justify-between shadow-sm'>\n        <div className='flex items-center gap-4'>\n          <div className='w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center text-primary-700 dark:text-primary-300 font-bold text-lg'>\n            {speaker.nom.charAt(0)}\n          </div>\n          <div>\n            <h2 className='font-bold text-gray-900 dark:text-white'>{speaker.nom}</h2>\n            <p className='text-sm text-gray-500 dark:text-gray-400'>{speaker.congregation}</p>\n          </div>\n        </div>\n        <div className='flex gap-2'>\n          {speaker.telephone && (\n            <Button\n              variant='ghost'\n              size='sm'\n              onClick={() => window.open(`tel:${speaker.telephone}`)}\n            >\n              <Phone className='w-4 h-4' />\n            </Button>\n          )}\n          {speaker.email && (\n            <Button\n              variant='ghost'\n              size='sm'\n              onClick={() => window.open(`mailto:${speaker.email}`)}\n            >\n              <Mail className='w-4 h-4' />\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className='flex-1 overflow-y-auto p-4 space-y-6'>\n        {sortedVisits.length > 0 ? (\n          sortedVisits.map((visit) => (\n            <div key={visit.id} className='space-y-2'>\n              <div className='flex items-center gap-2 text-xs text-gray-400 font-medium uppercase tracking-wider justify-center my-4'>\n                <span className='bg-gray-200 dark:bg-gray-700 h-px w-12'></span>\n                {format(new Date(visit.visitDate), 'd MMMM yyyy', { locale: fr })}\n                <span className='bg-gray-200 dark:bg-gray-700 h-px w-12'></span>\n              </div>\n\n              <Card>\n                <CardBody className='p-4'>\n                  <div className='flex justify-between items-start mb-4'>\n                    <div>\n                      <h3 className='font-semibold text-gray-900 dark:text-white'>\n                        Discours n¬∞{visit.talkNoOrType}\n                      </h3>\n                      <p className='text-sm text-gray-500 dark:text-gray-400'>\n                        {visit.talkTheme || getTalkTitle(visit.talkNoOrType)}\n                      </p>\n                    </div>\n                    <span\n                      className={`\n                      px-2 py-1 rounded-full text-xs font-medium\n                      ${\n                        visit.status === 'confirmed'\n                          ? 'bg-green-100 text-green-800'\n                          : visit.status === 'pending'\n                            ? 'bg-orange-100 text-orange-800'\n                            : 'bg-gray-100 text-gray-800'\n                      }\n                    `}\n                    >\n                      {visit.status === 'confirmed'\n                        ? 'Confirm√©'\n                        : visit.status === 'pending'\n                          ? 'En attente'\n                          : visit.status}\n                    </span>\n                  </div>\n\n                  <div className='grid grid-cols-2 gap-4 mb-4 text-sm text-gray-600 dark:text-gray-300'>\n                    <div className='flex items-center gap-2'>\n                      <Clock className='w-4 h-4 text-gray-400' />\n                      {visit.visitTime}\n                    </div>\n                    <div className='flex items-center gap-2'>\n                      <MapPin className='w-4 h-4 text-gray-400' />\n                      {visit.locationType === 'physical' ? 'Salle du Royaume' : 'Zoom'}\n                    </div>\n                    {visit.host && (\n                      <div className='flex items-center gap-2 col-span-2'>\n                        <User className='w-4 h-4 text-gray-400' />\n                        H√©berg√© par {visit.host}\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Barre de progression communication */}\n                  <div className='mb-4'>\n                    <CommunicationProgress visit={visit} showLabels={true} size='md' />\n                  </div>\n\n                  <div className='flex flex-wrap gap-2 pt-4 border-t border-gray-100 dark:border-gray-700'>\n                    <Button\n                      size='sm'\n                      variant='primary'\n                      leftIcon={<MessageSquare className='w-4 h-4' />}\n                      onClick={() => onAction('whatsapp', visit)}\n                    >\n                      G√©n√©rer un message\n                    </Button>\n                    {visit.status === 'pending' && (\n                      <Button\n                        size='sm'\n                        variant='primary'\n                        onClick={() => onAction('confirm', visit)}\n                      >\n                        Confirmer\n                      </Button>\n                    )}\n                  </div>\n                </CardBody>\n              </Card>\n            </div>\n          ))\n        ) : (\n          <div className='text-center py-12 text-gray-500 dark:text-gray-400'>\n            <Calendar className='w-12 h-12 mx-auto mb-3 opacity-20' />\n            <p>Aucune visite programm√©e avec cet orateur</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n","import React, { useState } from 'react';\nimport { Modal } from '@/components/ui/Modal';\nimport { Button } from '@/components/ui/Button';\nimport { Badge } from '@/components/ui/Badge';\nimport { Visit } from '@/types';\nimport { useData } from '@/contexts/DataContext';\nimport { useSettings } from '@/contexts/SettingsContext';\nimport { useToast } from '@/contexts/ToastContext';\nimport { generateHostRequestMessage } from '@/utils/messageGenerator';\nimport { Send, Copy, Check } from 'lucide-react';\nimport { formatFullDate } from '@/utils/formatters';\nimport { getTalkTitle } from '@/data/talkTitles';\n\ninterface HostRequestModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  visitsNeedingHost: Visit[];\n}\n\nexport const HostRequestModal: React.FC<HostRequestModalProps> = ({\n  isOpen,\n  onClose,\n  visitsNeedingHost,\n}) => {\n  const { congregationProfile } = useData();\n  const { settings } = useSettings();\n  const { addToast } = useToast();\n\n  const [selectedVisits, setSelectedVisits] = useState<Set<string>>(\n    new Set(visitsNeedingHost.map((v) => v.visitId))\n  );\n  const [message, setMessage] = useState('');\n\n  // G√©n√©rer le message quand les visites s√©lectionn√©es changent\n  React.useEffect(() => {\n    if (selectedVisits.size > 0) {\n      generateMessage();\n    }\n  }, [selectedVisits]);\n\n  const generateMessage = () => {\n    const visits = visitsNeedingHost.filter((v) => selectedVisits.has(v.visitId));\n    const generated = generateHostRequestMessage(visits, congregationProfile, settings.language);\n    setMessage(generated);\n  };\n\n  const toggleVisit = (visitId: string) => {\n    const newSelected = new Set(selectedVisits);\n    if (newSelected.has(visitId)) {\n      newSelected.delete(visitId);\n    } else {\n      newSelected.add(visitId);\n    }\n    setSelectedVisits(newSelected);\n  };\n\n  const toggleAll = () => {\n    if (selectedVisits.size === visitsNeedingHost.length) {\n      setSelectedVisits(new Set());\n    } else {\n      setSelectedVisits(new Set(visitsNeedingHost.map((v) => v.visitId)));\n    }\n  };\n\n  const handleCopy = async () => {\n    try {\n      await navigator.clipboard.writeText(message);\n      addToast('Message copi√© dans le presse-papier', 'success');\n    } catch (error) {\n      addToast('Erreur lors de la copie', 'error');\n    }\n  };\n\n  const handleSendWhatsApp = () => {\n    const encodedMessage = encodeURIComponent(message);\n    // Envoyer au groupe KBV Lyon (vous pouvez configurer le num√©ro de groupe)\n    window.open(`https://wa.me/?text=${encodedMessage}`, '_blank');\n    onClose();\n  };\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      title=\"Demande d'accueil group√©e\"\n      size='lg'\n      footer={\n        <>\n          <Button variant='ghost' onClick={onClose}>\n            Annuler\n          </Button>\n          <Button\n            variant='secondary'\n            onClick={handleCopy}\n            leftIcon={<Copy className='w-4 h-4' />}\n            disabled={selectedVisits.size === 0}\n          >\n            Copier\n          </Button>\n          <Button\n            onClick={handleSendWhatsApp}\n            leftIcon={<Send className='w-4 h-4' />}\n            disabled={selectedVisits.size === 0}\n          >\n            Envoyer (WhatsApp)\n          </Button>\n        </>\n      }\n    >\n      <div className='space-y-6'>\n        {/* Header avec compteur */}\n        <div className='flex items-center justify-between p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg'>\n          <div>\n            <h3 className='font-semibold text-orange-900 dark:text-orange-300'>\n              {visitsNeedingHost.length} visite{visitsNeedingHost.length > 1 ? 's' : ''} sans\n              contact d'accueil\n            </h3>\n            <p className='text-sm text-orange-700 dark:text-orange-400 mt-1'>\n              S√©lectionnez les visites pour lesquelles demander un contact\n            </p>\n          </div>\n          <Badge variant='warning' size='md'>\n            {selectedVisits.size} s√©lectionn√©e{selectedVisits.size > 1 ? 's' : ''}\n          </Badge>\n        </div>\n\n        {/* Liste des visites avec checkboxes */}\n        <div className='space-y-2'>\n          <div className='flex items-center justify-between mb-3'>\n            <h4 className='font-medium text-gray-900 dark:text-white'>Visites</h4>\n            <button\n              onClick={toggleAll}\n              className='text-sm text-primary-600 dark:text-primary-400 hover:underline'\n            >\n              {selectedVisits.size === visitsNeedingHost.length\n                ? 'Tout d√©s√©lectionner'\n                : 'Tout s√©lectionner'}\n            </button>\n          </div>\n\n          <div className='max-h-64 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-lg p-3'>\n            {visitsNeedingHost.map((visit) => (\n              <label\n                key={visit.visitId}\n                className='flex items-start gap-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer transition-colors'\n              >\n                <input\n                  type='checkbox'\n                  checked={selectedVisits.has(visit.visitId)}\n                  onChange={() => toggleVisit(visit.visitId)}\n                  className='mt-1 w-4 h-4 text-primary-600 rounded focus:ring-primary-500'\n                />\n                <div className='flex-1'>\n                  <div className='flex items-center justify-between'>\n                    <p className='font-medium text-gray-900 dark:text-white'>{visit.nom}</p>\n                    <Badge variant='default' size='sm'>\n                      {formatFullDate(visit.visitDate, settings.language)}\n                    </Badge>\n                  </div>\n                  <p className='text-sm text-gray-600 dark:text-gray-400'>\n                    {visit.congregation} ‚Ä¢ {visit.visitTime}\n                  </p>\n                  {(visit.talkTheme || getTalkTitle(visit.talkNoOrType)) && (\n                    <p className='text-xs text-gray-500 dark:text-gray-500 mt-1'>\n                      N¬∞{visit.talkNoOrType} - {visit.talkTheme || getTalkTitle(visit.talkNoOrType)}\n                    </p>\n                  )}\n                </div>\n              </label>\n            ))}\n          </div>\n        </div>\n\n        {/* Aper√ßu du message */}\n        <div>\n          <h4 className='font-medium text-gray-900 dark:text-white mb-2'>Aper√ßu du message</h4>\n          <div className='relative'>\n            <textarea\n              className='w-full h-64 p-4 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none font-mono text-sm'\n              value={message}\n              onChange={(e) => setMessage(e.target.value)}\n              placeholder={\n                selectedVisits.size === 0\n                  ? 'S√©lectionnez au moins une visite pour g√©n√©rer le message...'\n                  : 'G√©n√©ration du message...'\n              }\n              disabled={selectedVisits.size === 0}\n            />\n            {selectedVisits.size > 0 && (\n              <div className='absolute top-2 right-2'>\n                <Badge variant='success' size='sm'>\n                  <Check className='w-3 h-3 mr-1' />\n                  Message pr√™t\n                </Badge>\n              </div>\n            )}\n          </div>\n          <p className='text-xs text-gray-500 dark:text-gray-400 mt-2'>\n            üí° Vous pouvez modifier le message avant de l'envoyer\n          </p>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n","import React, { useState, useMemo } from 'react';\nimport { useData } from '@/contexts/DataContext';\nimport { usePlatformContext } from '@/contexts/PlatformContext';\nimport { MessageThread } from '@/components/messages/MessageThread';\nimport { MessageGeneratorModal } from '@/components/messages/MessageGeneratorModal';\nimport { HostRequestModal } from '@/components/messages/HostRequestModal';\nimport { Button } from '@/components/ui/Button';\nimport { Input } from '@/components/ui/Input';\nimport { Badge } from '@/components/ui/Badge';\nimport { cn } from '@/utils/cn';\nimport { MessageSquare, Search, Plus, CheckCircle, Clock, AlertCircle, Users } from 'lucide-react';\nimport { Speaker, Visit } from '@/types';\n\nexport const Messages: React.FC = () => {\n  const { visits, speakers, updateVisit, refreshData } = useData();\n  const { isPhoneS25Ultra } = usePlatformContext();\n\n  // Mettre √† jour les titres manquants au chargement\n  React.useEffect(() => {\n    if (refreshData) {\n      refreshData();\n    }\n  }, []);\n  const [selectedSpeaker, setSelectedSpeaker] = useState<Speaker | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isGeneratorModalOpen, setIsGeneratorModalOpen] = useState(false);\n  const [isHostRequestModalOpen, setIsHostRequestModalOpen] = useState(false);\n  const [generatorVisit, setGeneratorVisit] = useState<Visit | null>(null);\n  const [filter, setFilter] = useState<'all' | 'unread' | 'pending'>('all');\n\n  // Generate conversations from visits (sans doublons)\n  const conversations = useMemo(() => {\n    const convos: { speaker: Speaker; visits: Visit[] }[] = [];\n    const seenSpeakers = new Set<string>();\n\n    // Group visits by speaker (√©viter les doublons)\n    speakers.forEach((speaker) => {\n      // Utiliser l'ID comme cl√© unique\n      if (!seenSpeakers.has(speaker.id)) {\n        seenSpeakers.add(speaker.id);\n        const speakerVisits = visits.filter((visit) => visit.id === speaker.id);\n        if (speakerVisits.length > 0) {\n          convos.push({ speaker, visits: speakerVisits });\n        }\n      }\n    });\n\n    return convos;\n  }, [visits, speakers]);\n\n  // Filtered conversations\n  const filteredConversations = useMemo(\n    () =>\n      conversations.filter((convo) => {\n        const matchesSearch =\n          convo.speaker.nom.toLowerCase().includes(searchTerm.toLowerCase()) ||\n          convo.speaker.congregation.toLowerCase().includes(searchTerm.toLowerCase());\n\n        const matchesFilter =\n          filter === 'all' ||\n          (filter === 'pending' && convo.visits.some((v) => v.status === 'pending'));\n\n        return matchesSearch && matchesFilter;\n      }),\n    [conversations, searchTerm, filter]\n  );\n\n  const stats = useMemo(() => {\n    const total = conversations.length;\n    const pending = visits.filter((v) => v.status === 'pending').length;\n    const needingHost = visits.filter(\n      (v) => !v.host || v.host === '√Ä d√©finir' || v.host === ''\n    ).length;\n\n    return { total, pending, needingHost };\n  }, [conversations, visits]);\n\n  const getStatusIcon = (visit: Visit) => {\n    switch (visit.status) {\n      case 'pending':\n        return <Clock className='w-4 h-4 text-orange-500' />;\n      case 'confirmed':\n        return <CheckCircle className='w-4 h-4 text-green-500' />;\n      default:\n        return <AlertCircle className='w-4 h-4 text-gray-500' />;\n    }\n  };\n\n  const handleMessageAction = (action: string, visit?: Visit) => {\n    if (action === 'whatsapp' || action === 'email') {\n      if (visit && selectedSpeaker) {\n        setGeneratorVisit(visit);\n        setIsGeneratorModalOpen(true);\n      }\n    } else if (action === 'confirm' && visit) {\n      // Confirmer la visite\n      const updatedVisit: Visit = {\n        ...visit,\n        status: 'confirmed',\n        updatedAt: new Date().toISOString(),\n      };\n      updateVisit(updatedVisit);\n    } else if (action === 'host_request' && visit) {\n      setGeneratorVisit(visit);\n      setIsHostRequestModalOpen(true);\n    }\n  };\n\n  return (\n    <div\n      className={cn(\n        'min-h-[calc(100vh-12rem)] flex flex-col',\n        isPhoneS25Ultra && 's25-ultra-optimized'\n      )}\n    >\n      {/* Header */}\n      <div className={cn('flex justify-end gap-3 mb-6', isPhoneS25Ultra && 'flex-col gap-2')}>\n        {/* Bouton demande d'accueil - conditionnel */}\n        {stats.needingHost > 0 && (\n          <Button\n            variant='secondary'\n            className='bg-orange-100 text-orange-700 hover:bg-orange-200 dark:bg-orange-900/30 dark:text-orange-300 dark:hover:bg-orange-900/50'\n            leftIcon={<Users className='w-4 h-4' />}\n            onClick={() => setIsHostRequestModalOpen(true)}\n          >\n            Demande d'accueil ({stats.needingHost})\n          </Button>\n        )}\n        <Button\n          variant='secondary'\n          leftIcon={<Plus className='w-4 h-4' />}\n          onClick={() => setIsGeneratorModalOpen(true)}\n        >\n          Nouveau message\n        </Button>\n      </div>\n\n      {/* Statistics Cards */}\n      <div className={cn('grid gap-4 mb-6', isPhoneS25Ultra ? 'grid-cols-1' : 'grid-cols-3')}>\n        <div\n          className={cn(\n            'bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800',\n            isPhoneS25Ultra && 's25-card'\n          )}\n        >\n          <div className='flex items-center gap-3'>\n            <MessageSquare className='w-6 h-6 text-blue-600 dark:text-blue-400' />\n            <div>\n              <div className='text-lg font-semibold text-blue-900 dark:text-blue-100'>\n                {stats.total}\n              </div>\n              <div className='text-xs text-blue-700 dark:text-blue-300'>Orateurs</div>\n            </div>\n          </div>\n        </div>\n\n        <div\n          className={cn(\n            'bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800',\n            isPhoneS25Ultra && 's25-card'\n          )}\n        >\n          <div className='flex items-center gap-3'>\n            <Clock className='w-6 h-6 text-orange-600 dark:text-orange-400' />\n            <div>\n              <div className='text-lg font-semibold text-orange-900 dark:text-orange-100'>\n                {stats.pending}\n              </div>\n              <div className='text-xs text-orange-700 dark:text-orange-300'>En attente</div>\n            </div>\n          </div>\n        </div>\n\n        <div\n          className={cn(\n            'bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800',\n            isPhoneS25Ultra && 's25-card'\n          )}\n        >\n          <div className='flex items-center gap-3'>\n            <CheckCircle className='w-6 h-6 text-green-600 dark:text-green-400' />\n            <div>\n              <div className='text-lg font-semibold text-green-900 dark:text-green-100'>\n                {visits.filter((v) => v.status === 'confirmed').length}\n              </div>\n              <div className='text-xs text-green-700 dark:text-green-300'>Confirm√©es</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div\n        className={cn(\n          'flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 mb-6',\n          isPhoneS25Ultra && 'p-3'\n        )}\n      >\n        <div className='flex flex-col sm:flex-row gap-4 w-full sm:w-auto'>\n          <Input\n            placeholder='Rechercher un orateur...'\n            leftIcon={<Search className='w-4 h-4' />}\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className='min-w-64'\n          />\n\n          <div className='flex gap-2'>\n            <button\n              onClick={() => setFilter('all')}\n              className={`px-3 py-2 text-sm rounded-lg transition-colors ${\n                filter === 'all'\n                  ? 'bg-primary-100 text-primary-700 dark:bg-primary-900/50 dark:text-primary-300'\n                  : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n              }`}\n            >\n              Tous\n            </button>\n            <button\n              onClick={() => setFilter('pending')}\n              className={`px-3 py-2 text-sm rounded-lg transition-colors ${\n                filter === 'pending'\n                  ? 'bg-primary-100 text-primary-700 dark:bg-primary-900/50 dark:text-primary-300'\n                  : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n              }`}\n            >\n              En attente ({stats.pending})\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content - Split View */}\n      <div className={cn('flex-1 flex gap-6 min-h-0', isPhoneS25Ultra && 'flex-col gap-4')}>\n        {/* Conversations List */}\n        <div\n          className={cn(\n            'w-full lg:w-96 flex flex-col bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden',\n            isPhoneS25Ultra && 'w-full min-h-0 flex-1'\n          )}\n        >\n          <div className='p-4 border-b border-gray-200 dark:border-gray-700'>\n            <h3 className='font-semibold text-gray-900 dark:text-white'>Orateurs</h3>\n          </div>\n\n          <div className='flex-1 overflow-y-auto'>\n            {filteredConversations.length > 0 ? (\n              <div className='divide-y divide-gray-200 dark:divide-gray-700'>\n                {filteredConversations.map(({ speaker, visits: speakerVisits }) => (\n                  <div\n                    key={speaker.id}\n                    onClick={() => setSelectedSpeaker(speaker)}\n                    className={`p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors ${\n                      selectedSpeaker?.id === speaker.id\n                        ? 'bg-primary-50 dark:bg-primary-900/20 border-r-2 border-primary-500'\n                        : ''\n                    }`}\n                  >\n                    <div className='flex items-start justify-between'>\n                      <div className='flex items-start gap-3 flex-1 min-w-0'>\n                        <div className='w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center text-primary-700 dark:text-primary-300 font-bold flex-shrink-0'>\n                          {speaker.nom.charAt(0).toUpperCase()}\n                        </div>\n\n                        <div className='flex-1 min-w-0'>\n                          <div className='flex items-center gap-2 mb-1'>\n                            <h4 className='font-medium text-gray-900 dark:text-white truncate'>\n                              {speaker.nom}\n                            </h4>\n                            {speakerVisits.some((v) => v.status === 'pending') && (\n                              <Badge variant='danger' className='text-xs px-1.5 py-0.5'>\n                                !\n                              </Badge>\n                            )}\n                          </div>\n\n                          <p className='text-sm text-gray-500 dark:text-gray-400 mb-1 truncate'>\n                            {speaker.congregation}\n                          </p>\n\n                          <div className='flex items-center gap-2 text-xs text-gray-400 dark:text-gray-500'>\n                            <span>\n                              {speakerVisits.length} visite{speakerVisits.length > 1 ? 's' : ''}\n                            </span>\n                            <span>‚Ä¢</span>\n                            <span>\n                              {speakerVisits.filter((v) => v.status === 'pending').length} en\n                              attente\n                            </span>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className='flex flex-col items-end gap-1 flex-shrink-0'>\n                        {speakerVisits.some((v) => getStatusIcon(v))}\n                        <span className='text-xs text-gray-400 dark:text-gray-500'>\n                          {speaker.telephone || speaker.email ? 'Contact√©' : 'Sans contact'}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className='flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400'>\n                <MessageSquare className='w-12 h-12 mb-4 opacity-20' />\n                <p className='text-center'>\n                  {searchTerm ? 'Aucun orateur trouv√©' : 'Aucun orateur'}\n                </p>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Message Thread */}\n        <div\n          className={cn(\n            'flex-1 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden',\n            isPhoneS25Ultra && 'w-full'\n          )}\n        >\n          {selectedSpeaker ? (\n            <MessageThread\n              speaker={selectedSpeaker}\n              visits={visits.filter((v) => v.nom === selectedSpeaker.nom)}\n              onAction={handleMessageAction}\n            />\n          ) : (\n            <div className='flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400'>\n              <MessageSquare className='w-16 h-16 mb-4 opacity-20' />\n              <h3 className='text-lg font-medium mb-2'>S√©lectionnez un orateur</h3>\n              <p className='text-center max-w-md'>\n                Choisissez un orateur dans la liste pour voir les d√©tails et envoyer des messages.\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Message Generator Modal */}\n      {isGeneratorModalOpen && selectedSpeaker && generatorVisit && (\n        <MessageGeneratorModal\n          isOpen={isGeneratorModalOpen}\n          onClose={() => {\n            setIsGeneratorModalOpen(false);\n            setGeneratorVisit(null);\n          }}\n          speaker={selectedSpeaker}\n          visit={generatorVisit}\n        />\n      )}\n\n      {/* Fallback modal when no specific visit is selected */}\n      {isGeneratorModalOpen && !generatorVisit && (\n        <MessageGeneratorModal\n          isOpen={isGeneratorModalOpen}\n          onClose={() => {\n            setIsGeneratorModalOpen(false);\n            setGeneratorVisit(null);\n          }}\n          speaker={selectedSpeaker || speakers[0]}\n          visit={\n            selectedSpeaker\n              ? visits.find(\n                  (v) =>\n                    v.id === selectedSpeaker.id &&\n                    (v.status === 'pending' || v.status === 'confirmed')\n                ) ||\n                visits.find((v) => v.id === selectedSpeaker.id) ||\n                visits[0]\n              : visits[0]\n          }\n        />\n      )}\n\n      {/* Host Request Modal */}\n      <HostRequestModal\n        isOpen={isHostRequestModalOpen}\n        onClose={() => setIsHostRequestModalOpen(false)}\n        visitsNeedingHost={visits.filter((v) => !v.host || v.host === '√Ä d√©finir' || v.host === '')}\n      />\n    </div>\n  );\n};\n"],"names":["MessageThread","speaker","visits","onAction","sortedVisits","visit","index","self","t","b","jsxs","jsx","Button","Phone","Mail","format","fr","Card","CardBody","getTalkTitle","Clock","MapPin","User","CommunicationProgress","MessageSquare","Calendar","HostRequestModal","isOpen","onClose","visitsNeedingHost","congregationProfile","useData","settings","useSettings","addToast","useToast","selectedVisits","setSelectedVisits","useState","v","message","setMessage","React","generateMessage","generated","generateHostRequestMessage","toggleVisit","visitId","newSelected","toggleAll","handleCopy","handleSendWhatsApp","encodedMessage","Modal","Fragment","Copy","Send","Badge","formatFullDate","e","Check","Messages","speakers","updateVisit","refreshData","isPhoneS25Ultra","usePlatformContext","selectedSpeaker","setSelectedSpeaker","searchTerm","setSearchTerm","isGeneratorModalOpen","setIsGeneratorModalOpen","isHostRequestModalOpen","setIsHostRequestModalOpen","generatorVisit","setGeneratorVisit","filter","setFilter","conversations","useMemo","convos","seenSpeakers","speakerVisits","filteredConversations","convo","matchesSearch","matchesFilter","stats","total","pending","needingHost","getStatusIcon","CheckCircle","AlertCircle","handleMessageAction","action","updatedVisit","cn","Users","Plus","Input","Search","MessageGeneratorModal"],"mappings":"2kBAgBO,MAAMA,GAA8C,CAAC,CAAE,QAAAC,EAAS,OAAAC,EAAQ,SAAAC,KAAe,CAO5F,MAAMC,EAAe,CAAC,GALDF,EAAO,OAC1B,CAACG,EAAOC,EAAOC,IAASD,IAAUC,EAAK,UAAWC,GAAMA,EAAE,KAAOH,EAAM,EAAE,CAAA,CAItC,EAAE,KACrC,CAAC,EAAGI,IAAM,IAAI,KAAKA,EAAE,SAAS,EAAE,QAAA,EAAY,IAAI,KAAK,EAAE,SAAS,EAAE,QAAA,CAAQ,EAG5E,OACEC,EAAAA,KAAC,MAAA,CAAI,UAAU,mDAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0HACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,sJACZ,WAAQ,IAAI,OAAO,CAAC,EACvB,SACC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,KAAA,CAAG,UAAU,0CAA2C,SAAAV,EAAQ,IAAI,EACrEU,EAAAA,IAAC,IAAA,CAAE,UAAU,2CAA4C,WAAQ,YAAA,CAAa,CAAA,CAAA,CAChF,CAAA,EACF,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,aACZ,SAAA,CAAAT,EAAQ,WACPU,EAAAA,IAACC,EAAA,CACC,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,OAAO,KAAK,OAAOX,EAAQ,SAAS,EAAE,EAErD,SAAAU,EAAAA,IAACE,EAAA,CAAM,UAAU,SAAA,CAAU,CAAA,CAAA,EAG9BZ,EAAQ,OACPU,EAAAA,IAACC,EAAA,CACC,QAAQ,QACR,KAAK,KACL,QAAS,IAAM,OAAO,KAAK,UAAUX,EAAQ,KAAK,EAAE,EAEpD,SAAAU,EAAAA,IAACG,GAAA,CAAK,UAAU,SAAA,CAAU,CAAA,CAAA,CAC5B,CAAA,CAEJ,CAAA,EACF,EAGAH,EAAAA,IAAC,MAAA,CAAI,UAAU,uCACZ,WAAa,OAAS,EACrBP,EAAa,IAAKC,GAChBK,EAAAA,KAAC,MAAA,CAAmB,UAAU,YAC5B,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,yGACb,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,wCAAA,CAAyC,EACxDI,GAAO,IAAI,KAAKV,EAAM,SAAS,EAAG,cAAe,CAAE,OAAQW,EAAI,EAChEL,EAAAA,IAAC,OAAA,CAAK,UAAU,wCAAA,CAAyC,CAAA,EAC3D,EAEAA,MAACM,EAAA,CACC,SAAAP,EAAAA,KAACQ,EAAA,CAAS,UAAU,MAClB,SAAA,CAAAR,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,8CAA8C,SAAA,CAAA,cAC9CL,EAAM,YAAA,EACpB,EACAM,EAAAA,IAAC,KAAE,UAAU,2CACV,WAAM,WAAaQ,EAAad,EAAM,YAAY,CAAA,CACrD,CAAA,EACF,EACAM,EAAAA,IAAC,OAAA,CACC,UAAW;AAAA;AAAA,wBAGTN,EAAM,SAAW,YACb,8BACAA,EAAM,SAAW,UACf,gCACA,2BACR;AAAA,sBAGC,SAAAA,EAAM,SAAW,YACd,WACAA,EAAM,SAAW,UACf,aACAA,EAAM,MAAA,CAAA,CACd,EACF,EAEAK,EAAAA,KAAC,MAAA,CAAI,UAAU,uEACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACS,EAAA,CAAM,UAAU,uBAAA,CAAwB,EACxCf,EAAM,SAAA,EACT,EACAK,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACU,GAAA,CAAO,UAAU,uBAAA,CAAwB,EACzChB,EAAM,eAAiB,WAAa,mBAAqB,MAAA,EAC5D,EACCA,EAAM,MACLK,OAAC,MAAA,CAAI,UAAU,qCACb,SAAA,CAAAC,EAAAA,IAACW,GAAA,CAAK,UAAU,uBAAA,CAAwB,EAAE,eAC7BjB,EAAM,IAAA,CAAA,CACrB,CAAA,EAEJ,EAGAM,EAAAA,IAAC,MAAA,CAAI,UAAU,OACb,SAAAA,EAAAA,IAACY,EAAA,CAAsB,MAAAlB,EAAc,WAAY,GAAM,KAAK,IAAA,CAAK,CAAA,CACnE,EAEAK,EAAAA,KAAC,MAAA,CAAI,UAAU,0EACb,SAAA,CAAAC,EAAAA,IAACC,EAAA,CACC,KAAK,KACL,QAAQ,UACR,SAAUD,EAAAA,IAACa,EAAA,CAAc,UAAU,SAAA,CAAU,EAC7C,QAAS,IAAMrB,EAAS,WAAYE,CAAK,EAC1C,SAAA,oBAAA,CAAA,EAGAA,EAAM,SAAW,WAChBM,EAAAA,IAACC,EAAA,CACC,KAAK,KACL,QAAQ,UACR,QAAS,IAAMT,EAAS,UAAWE,CAAK,EACzC,SAAA,WAAA,CAAA,CAED,CAAA,CAEJ,CAAA,CAAA,CACF,CAAA,CACF,CAAA,GAhFQA,EAAM,EAiFhB,CACD,EAEDK,EAAAA,KAAC,MAAA,CAAI,UAAU,qDACb,SAAA,CAAAC,EAAAA,IAACc,EAAA,CAAS,UAAU,mCAAA,CAAoC,EACxDd,EAAAA,IAAC,KAAE,SAAA,2CAAA,CAAyC,CAAA,CAAA,CAC9C,CAAA,CAEJ,CAAA,EACF,CAEJ,EC3Iae,GAAoD,CAAC,CAChE,OAAAC,EACA,QAAAC,EACA,kBAAAC,CACF,IAAM,CACJ,KAAM,CAAE,oBAAAC,CAAA,EAAwBC,EAAA,EAC1B,CAAE,SAAAC,CAAA,EAAaC,EAAA,EACf,CAAE,SAAAC,CAAA,EAAaC,EAAA,EAEf,CAACC,EAAgBC,CAAiB,EAAIC,EAAAA,SAC1C,IAAI,IAAIT,EAAkB,IAAKU,GAAMA,EAAE,OAAO,CAAC,CAAA,EAE3C,CAACC,EAASC,CAAU,EAAIH,EAAAA,SAAS,EAAE,EAGzCI,EAAM,UAAU,IAAM,CAChBN,EAAe,KAAO,GACxBO,EAAA,CAEJ,EAAG,CAACP,CAAc,CAAC,EAEnB,MAAMO,EAAkB,IAAM,CAC5B,MAAMzC,EAAS2B,EAAkB,OAAQU,GAAMH,EAAe,IAAIG,EAAE,OAAO,CAAC,EACtEK,EAAYC,GAA2B3C,EAAQ4B,EAAqBE,EAAS,QAAQ,EAC3FS,EAAWG,CAAS,CACtB,EAEME,EAAeC,GAAoB,CACvC,MAAMC,EAAc,IAAI,IAAIZ,CAAc,EACtCY,EAAY,IAAID,CAAO,EACzBC,EAAY,OAAOD,CAAO,EAE1BC,EAAY,IAAID,CAAO,EAEzBV,EAAkBW,CAAW,CAC/B,EAEMC,EAAY,IAAM,CAClBb,EAAe,OAASP,EAAkB,OAC5CQ,EAAkB,IAAI,GAAK,EAE3BA,EAAkB,IAAI,IAAIR,EAAkB,IAAKU,GAAMA,EAAE,OAAO,CAAC,CAAC,CAEtE,EAEMW,EAAa,SAAY,CAC7B,GAAI,CACF,MAAM,UAAU,UAAU,UAAUV,CAAO,EAC3CN,EAAS,sCAAuC,SAAS,CAC3D,MAAgB,CACdA,EAAS,0BAA2B,OAAO,CAC7C,CACF,EAEMiB,EAAqB,IAAM,CAC/B,MAAMC,EAAiB,mBAAmBZ,CAAO,EAEjD,OAAO,KAAK,uBAAuBY,CAAc,GAAI,QAAQ,EAC7DxB,EAAA,CACF,EAEA,OACEjB,EAAAA,IAAC0C,EAAA,CACC,OAAA1B,EACA,QAAAC,EACA,MAAM,4BACN,KAAK,KACL,OACElB,EAAAA,KAAA4C,WAAA,CACE,SAAA,CAAA3C,MAACC,EAAA,CAAO,QAAQ,QAAQ,QAASgB,EAAS,SAAA,UAE1C,EACAjB,EAAAA,IAACC,EAAA,CACC,QAAQ,YACR,QAASsC,EACT,SAAUvC,EAAAA,IAAC4C,GAAA,CAAK,UAAU,SAAA,CAAU,EACpC,SAAUnB,EAAe,OAAS,EACnC,SAAA,QAAA,CAAA,EAGDzB,EAAAA,IAACC,EAAA,CACC,QAASuC,EACT,SAAUxC,EAAAA,IAAC6C,GAAA,CAAK,UAAU,SAAA,CAAU,EACpC,SAAUpB,EAAe,OAAS,EACnC,SAAA,oBAAA,CAAA,CAED,EACF,EAGF,SAAA1B,EAAAA,KAAC,MAAA,CAAI,UAAU,YAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,sIACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,qDACX,SAAA,CAAAmB,EAAkB,OAAO,UAAQA,EAAkB,OAAS,EAAI,IAAM,GAAG,yBAAA,EAE5E,EACAlB,EAAAA,IAAC,IAAA,CAAE,UAAU,oDAAoD,SAAA,8DAAA,CAEjE,CAAA,EACF,EACAD,EAAAA,KAAC+C,EAAA,CAAM,QAAQ,UAAU,KAAK,KAC3B,SAAA,CAAArB,EAAe,KAAK,gBAAcA,EAAe,KAAO,EAAI,IAAM,EAAA,CAAA,CACrE,CAAA,EACF,EAGA1B,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,4CAA4C,SAAA,UAAO,EACjEA,EAAAA,IAAC,SAAA,CACC,QAASsC,EACT,UAAU,iEAET,SAAAb,EAAe,OAASP,EAAkB,OACvC,sBACA,mBAAA,CAAA,CACN,EACF,QAEC,MAAA,CAAI,UAAU,gGACZ,SAAAA,EAAkB,IAAKxB,GACtBK,EAAAA,KAAC,QAAA,CAEC,UAAU,iHAEV,SAAA,CAAAC,EAAAA,IAAC,QAAA,CACC,KAAK,WACL,QAASyB,EAAe,IAAI/B,EAAM,OAAO,EACzC,SAAU,IAAMyC,EAAYzC,EAAM,OAAO,EACzC,UAAU,8DAAA,CAAA,EAEZK,EAAAA,KAAC,MAAA,CAAI,UAAU,SACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAAC,IAAA,CAAE,UAAU,4CAA6C,SAAAN,EAAM,IAAI,EACpEM,EAAAA,IAAC8C,EAAA,CAAM,QAAQ,UAAU,KAAK,KAC3B,SAAAC,EAAerD,EAAM,UAAW2B,EAAS,QAAQ,CAAA,CACpD,CAAA,EACF,EACAtB,EAAAA,KAAC,IAAA,CAAE,UAAU,2CACV,SAAA,CAAAL,EAAM,aAAa,MAAIA,EAAM,SAAA,EAChC,GACEA,EAAM,WAAac,EAAad,EAAM,YAAY,IAClDK,EAAAA,KAAC,IAAA,CAAE,UAAU,gDAAgD,SAAA,CAAA,KACxDL,EAAM,aAAa,MAAIA,EAAM,WAAac,EAAad,EAAM,YAAY,CAAA,CAAA,CAC9E,CAAA,CAAA,CAEJ,CAAA,CAAA,EAxBKA,EAAM,OAAA,CA0Bd,CAAA,CACH,CAAA,EACF,SAGC,MAAA,CACC,SAAA,CAAAM,EAAAA,IAAC,KAAA,CAAG,UAAU,iDAAiD,SAAA,oBAAiB,EAChFD,EAAAA,KAAC,MAAA,CAAI,UAAU,WACb,SAAA,CAAAC,EAAAA,IAAC,WAAA,CACC,UAAU,4NACV,MAAO6B,EACP,SAAWmB,GAAMlB,EAAWkB,EAAE,OAAO,KAAK,EAC1C,YACEvB,EAAe,OAAS,EACpB,8DACA,2BAEN,SAAUA,EAAe,OAAS,CAAA,CAAA,EAEnCA,EAAe,KAAO,GACrBzB,EAAAA,IAAC,MAAA,CAAI,UAAU,yBACb,SAAAD,EAAAA,KAAC+C,EAAA,CAAM,QAAQ,UAAU,KAAK,KAC5B,SAAA,CAAA9C,EAAAA,IAACiD,GAAA,CAAM,UAAU,cAAA,CAAe,EAAE,cAAA,CAAA,CAEpC,CAAA,CACF,CAAA,EAEJ,EACAjD,EAAAA,IAAC,IAAA,CAAE,UAAU,gDAAgD,SAAA,uDAAA,CAE7D,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CAGN,EC/LakD,GAAqB,IAAM,CACtC,KAAM,CAAE,OAAA3D,EAAQ,SAAA4D,EAAU,YAAAC,EAAa,YAAAC,CAAA,EAAgBjC,EAAA,EACjD,CAAE,gBAAAkC,CAAA,EAAoBC,EAAA,EAG5BxB,EAAM,UAAU,IAAM,CAChBsB,GACFA,EAAA,CAEJ,EAAG,CAAA,CAAE,EACL,KAAM,CAACG,EAAiBC,CAAkB,EAAI9B,EAAAA,SAAyB,IAAI,EACrE,CAAC+B,EAAYC,CAAa,EAAIhC,EAAAA,SAAS,EAAE,EACzC,CAACiC,EAAsBC,CAAuB,EAAIlC,EAAAA,SAAS,EAAK,EAChE,CAACmC,EAAwBC,CAAyB,EAAIpC,EAAAA,SAAS,EAAK,EACpE,CAACqC,EAAgBC,CAAiB,EAAItC,EAAAA,SAAuB,IAAI,EACjE,CAACuC,EAAQC,CAAS,EAAIxC,EAAAA,SAAuC,KAAK,EAGlEyC,EAAgBC,EAAAA,QAAQ,IAAM,CAClC,MAAMC,EAAkD,CAAA,EAClDC,MAAmB,IAGzB,OAAApB,EAAS,QAAS7D,GAAY,CAE5B,GAAI,CAACiF,EAAa,IAAIjF,EAAQ,EAAE,EAAG,CACjCiF,EAAa,IAAIjF,EAAQ,EAAE,EAC3B,MAAMkF,EAAgBjF,EAAO,OAAQG,GAAUA,EAAM,KAAOJ,EAAQ,EAAE,EAClEkF,EAAc,OAAS,GACzBF,EAAO,KAAK,CAAE,QAAAhF,EAAS,OAAQkF,EAAe,CAElD,CACF,CAAC,EAEMF,CACT,EAAG,CAAC/E,EAAQ4D,CAAQ,CAAC,EAGfsB,EAAwBJ,EAAAA,QAC5B,IACED,EAAc,OAAQM,GAAU,CAC9B,MAAMC,EACJD,EAAM,QAAQ,IAAI,YAAA,EAAc,SAAShB,EAAW,YAAA,CAAa,GACjEgB,EAAM,QAAQ,aAAa,YAAA,EAAc,SAAShB,EAAW,aAAa,EAEtEkB,EACJV,IAAW,OACVA,IAAW,WAAaQ,EAAM,OAAO,KAAM9C,GAAMA,EAAE,SAAW,SAAS,EAE1E,OAAO+C,GAAiBC,CAC1B,CAAC,EACH,CAACR,EAAeV,EAAYQ,CAAM,CAAA,EAG9BW,EAAQR,EAAAA,QAAQ,IAAM,CAC1B,MAAMS,EAAQV,EAAc,OACtBW,EAAUxF,EAAO,OAAQqC,GAAMA,EAAE,SAAW,SAAS,EAAE,OACvDoD,EAAczF,EAAO,OACxBqC,GAAM,CAACA,EAAE,MAAQA,EAAE,OAAS,aAAeA,EAAE,OAAS,EAAA,EACvD,OAEF,MAAO,CAAE,MAAAkD,EAAO,QAAAC,EAAS,YAAAC,CAAA,CAC3B,EAAG,CAACZ,EAAe7E,CAAM,CAAC,EAEpB0F,EAAiBvF,GAAiB,CACtC,OAAQA,EAAM,OAAA,CACZ,IAAK,UACH,OAAOM,EAAAA,IAACS,EAAA,CAAM,UAAU,yBAAA,CAA0B,EACpD,IAAK,YACH,OAAOT,EAAAA,IAACkF,EAAA,CAAY,UAAU,wBAAA,CAAyB,EACzD,QACE,OAAOlF,EAAAA,IAACmF,EAAA,CAAY,UAAU,uBAAA,CAAwB,CAAA,CAE5D,EAEMC,EAAsB,CAACC,EAAgB3F,IAAkB,CAC7D,GAAI2F,IAAW,YAAcA,IAAW,QAClC3F,GAAS8D,IACXS,EAAkBvE,CAAK,EACvBmE,EAAwB,EAAI,WAErBwB,IAAW,WAAa3F,EAAO,CAExC,MAAM4F,EAAsB,CAC1B,GAAG5F,EACH,OAAQ,YACR,UAAW,IAAI,KAAA,EAAO,YAAA,CAAY,EAEpC0D,EAAYkC,CAAY,CAC1B,MAAWD,IAAW,gBAAkB3F,IACtCuE,EAAkBvE,CAAK,EACvBqE,EAA0B,EAAI,EAElC,EAEA,OACEhE,EAAAA,KAAC,MAAA,CACC,UAAWwF,EACT,0CACAjC,GAAmB,qBAAA,EAIrB,SAAA,CAAAvD,OAAC,OAAI,UAAWwF,EAAG,8BAA+BjC,GAAmB,gBAAgB,EAElF,SAAA,CAAAuB,EAAM,YAAc,GACnB9E,EAAAA,KAACE,EAAA,CACC,QAAQ,YACR,UAAU,2HACV,SAAUD,EAAAA,IAACwF,EAAA,CAAM,UAAU,SAAA,CAAU,EACrC,QAAS,IAAMzB,EAA0B,EAAI,EAC9C,SAAA,CAAA,sBACqBc,EAAM,YAAY,GAAA,CAAA,CAAA,EAG1C7E,EAAAA,IAACC,EAAA,CACC,QAAQ,YACR,SAAUD,EAAAA,IAACyF,EAAA,CAAK,UAAU,SAAA,CAAU,EACpC,QAAS,IAAM5B,EAAwB,EAAI,EAC5C,SAAA,iBAAA,CAAA,CAED,EACF,EAGA9D,OAAC,OAAI,UAAWwF,EAAG,kBAAmBjC,EAAkB,cAAgB,aAAa,EACnF,SAAA,CAAAtD,EAAAA,IAAC,MAAA,CACC,UAAWuF,EACT,4FACAjC,GAAmB,UAAA,EAGrB,SAAAvD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACa,EAAA,CAAc,UAAU,0CAAA,CAA2C,SACnE,MAAA,CACC,SAAA,CAAAb,EAAAA,IAAC,MAAA,CAAI,UAAU,yDACZ,SAAA6E,EAAM,MACT,EACA7E,EAAAA,IAAC,MAAA,CAAI,UAAU,2CAA2C,SAAA,UAAA,CAAQ,CAAA,CAAA,CACpE,CAAA,CAAA,CACF,CAAA,CAAA,EAGFA,EAAAA,IAAC,MAAA,CACC,UAAWuF,EACT,oGACAjC,GAAmB,UAAA,EAGrB,SAAAvD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACS,EAAA,CAAM,UAAU,8CAAA,CAA+C,SAC/D,MAAA,CACC,SAAA,CAAAT,EAAAA,IAAC,MAAA,CAAI,UAAU,6DACZ,SAAA6E,EAAM,QACT,EACA7E,EAAAA,IAAC,MAAA,CAAI,UAAU,+CAA+C,SAAA,YAAA,CAAU,CAAA,CAAA,CAC1E,CAAA,CAAA,CACF,CAAA,CAAA,EAGFA,EAAAA,IAAC,MAAA,CACC,UAAWuF,EACT,gGACAjC,GAAmB,UAAA,EAGrB,SAAAvD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACkF,EAAA,CAAY,UAAU,4CAAA,CAA6C,SACnE,MAAA,CACC,SAAA,CAAAlF,EAAAA,IAAC,MAAA,CAAI,UAAU,2DACZ,SAAAT,EAAO,OAAQqC,GAAMA,EAAE,SAAW,WAAW,EAAE,MAAA,CAClD,EACA5B,EAAAA,IAAC,MAAA,CAAI,UAAU,6CAA6C,SAAA,YAAA,CAAU,CAAA,CAAA,CACxE,CAAA,CAAA,CACF,CAAA,CAAA,CACF,EACF,EAGAA,EAAAA,IAAC,MAAA,CACC,UAAWuF,EACT,kLACAjC,GAAmB,KAAA,EAGrB,SAAAvD,EAAAA,KAAC,MAAA,CAAI,UAAU,mDACb,SAAA,CAAAC,EAAAA,IAAC0F,GAAA,CACC,YAAY,2BACZ,SAAU1F,EAAAA,IAAC2F,EAAA,CAAO,UAAU,SAAA,CAAU,EACtC,MAAOjC,EACP,SAAWV,GAAMW,EAAcX,EAAE,OAAO,KAAK,EAC7C,UAAU,UAAA,CAAA,EAGZjD,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMmE,EAAU,KAAK,EAC9B,UAAW,kDACTD,IAAW,MACP,+EACA,2EACN,GACD,SAAA,MAAA,CAAA,EAGDnE,EAAAA,KAAC,SAAA,CACC,QAAS,IAAMoE,EAAU,SAAS,EAClC,UAAW,kDACTD,IAAW,UACP,+EACA,2EACN,GACD,SAAA,CAAA,eACcW,EAAM,QAAQ,GAAA,CAAA,CAAA,CAC7B,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,SAID,MAAA,CAAI,UAAWU,EAAG,4BAA6BjC,GAAmB,gBAAgB,EAEjF,SAAA,CAAAvD,EAAAA,KAAC,MAAA,CACC,UAAWwF,EACT,gIACAjC,GAAmB,uBAAA,EAGrB,SAAA,CAAAtD,EAAAA,IAAC,MAAA,CAAI,UAAU,oDACb,SAAAA,EAAAA,IAAC,MAAG,UAAU,8CAA8C,oBAAQ,CAAA,CACtE,QAEC,MAAA,CAAI,UAAU,yBACZ,SAAAyE,EAAsB,OAAS,EAC9BzE,MAAC,MAAA,CAAI,UAAU,gDACZ,WAAsB,IAAI,CAAC,CAAE,QAAAV,EAAS,OAAQkF,KAC7CxE,EAAAA,IAAC,MAAA,CAEC,QAAS,IAAMyD,EAAmBnE,CAAO,EACzC,UAAW,mFACTkE,GAAiB,KAAOlE,EAAQ,GAC5B,qEACA,EACN,GAEA,SAAAS,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,4JACZ,SAAAV,EAAQ,IAAI,OAAO,CAAC,EAAE,YAAA,CAAY,CACrC,EAEAS,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,+BACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,qDACX,SAAAV,EAAQ,IACX,EACCkF,EAAc,KAAM5C,GAAMA,EAAE,SAAW,SAAS,GAC/C5B,EAAAA,IAAC8C,EAAA,CAAM,QAAQ,SAAS,UAAU,wBAAwB,SAAA,GAAA,CAE1D,CAAA,EAEJ,EAEA9C,EAAAA,IAAC,IAAA,CAAE,UAAU,yDACV,WAAQ,aACX,EAEAD,EAAAA,KAAC,MAAA,CAAI,UAAU,mEACb,SAAA,CAAAA,OAAC,OAAA,CACE,SAAA,CAAAyE,EAAc,OAAO,UAAQA,EAAc,OAAS,EAAI,IAAM,EAAA,EACjE,EACAxE,EAAAA,IAAC,QAAK,SAAA,GAAA,CAAC,SACN,OAAA,CACE,SAAA,CAAAwE,EAAc,OAAQ5C,GAAMA,EAAE,SAAW,SAAS,EAAE,OAAO,aAAA,CAAA,CAE9D,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,EAEA7B,EAAAA,KAAC,MAAA,CAAI,UAAU,8CACZ,SAAA,CAAAyE,EAAc,KAAM5C,GAAMqD,EAAcrD,CAAC,CAAC,EAC3C5B,EAAAA,IAAC,QAAK,UAAU,2CACb,WAAQ,WAAaV,EAAQ,MAAQ,WAAa,cAAA,CACrD,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EAjDKA,EAAQ,EAAA,CAmDhB,CAAA,CACH,EAEAS,OAAC,MAAA,CAAI,UAAU,mFACb,SAAA,CAAAC,EAAAA,IAACa,EAAA,CAAc,UAAU,2BAAA,CAA4B,QACpD,IAAA,CAAE,UAAU,cACV,SAAA6C,EAAa,uBAAyB,eAAA,CACzC,CAAA,CAAA,CACF,CAAA,CAEJ,CAAA,CAAA,CAAA,EAIF1D,EAAAA,IAAC,MAAA,CACC,UAAWuF,EACT,0GACAjC,GAAmB,QAAA,EAGpB,SAAAE,EACCxD,EAAAA,IAACX,GAAA,CACC,QAASmE,EACT,OAAQjE,EAAO,OAAQqC,GAAMA,EAAE,MAAQ4B,EAAgB,GAAG,EAC1D,SAAU4B,CAAA,CAAA,EAGZrF,EAAAA,KAAC,MAAA,CAAI,UAAU,oFACb,SAAA,CAAAC,EAAAA,IAACa,EAAA,CAAc,UAAU,2BAAA,CAA4B,EACrDb,EAAAA,IAAC,KAAA,CAAG,UAAU,2BAA2B,SAAA,0BAAuB,EAChEA,EAAAA,IAAC,IAAA,CAAE,UAAU,uBAAuB,SAAA,oFAAA,CAEpC,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,EACF,EAGC4D,GAAwBJ,GAAmBQ,GAC1ChE,EAAAA,IAAC4F,EAAA,CACC,OAAQhC,EACR,QAAS,IAAM,CACbC,EAAwB,EAAK,EAC7BI,EAAkB,IAAI,CACxB,EACA,QAAST,EACT,MAAOQ,CAAA,CAAA,EAKVJ,GAAwB,CAACI,GACxBhE,EAAAA,IAAC4F,EAAA,CACC,OAAQhC,EACR,QAAS,IAAM,CACbC,EAAwB,EAAK,EAC7BI,EAAkB,IAAI,CACxB,EACA,QAAST,GAAmBL,EAAS,CAAC,EACtC,MACEK,IACIjE,EAAO,KACJqC,GACCA,EAAE,KAAO4B,EAAgB,KACxB5B,EAAE,SAAW,WAAaA,EAAE,SAAW,YAAA,GAE5CrC,EAAO,KAAMqC,GAAMA,EAAE,KAAO4B,EAAgB,EAAE,IAC9CjE,EAAO,CAAC,CACA,CAAA,EAMlBS,EAAAA,IAACe,GAAA,CACC,OAAQ+C,EACR,QAAS,IAAMC,EAA0B,EAAK,EAC9C,kBAAmBxE,EAAO,OAAQqC,GAAM,CAACA,EAAE,MAAQA,EAAE,OAAS,aAAeA,EAAE,OAAS,EAAE,CAAA,CAAA,CAC5F,CAAA,CAAA,CAGN"}