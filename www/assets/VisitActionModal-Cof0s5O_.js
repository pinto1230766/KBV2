import{c as U,j as e,B as p,P as xe,H as ke,X as Ee,q as Pe,u as De,k as he,U as qe,i as Oe,f as be,g as fe,A as Ve,C as $e,n as _e,a as Be,r as Ce,M as We,m as ce}from"./index-BZdsEwY1.js";import{r as v}from"./charts-CCOFnOOy.js";import{I as $,M as le,P as Ge}from"./Input-Q56iw-Sl.js";import{P as Ie,S as Ue}from"./star-C-Wji6MC.js";import{T as Ne}from"./trash-2-Dvv6Z4GN.js";import{C as je,U as Xe}from"./Select-1Wfo6vyj.js";import{L as Ye}from"./link-CZVQdni7.js";import{C as Ke,M as Je}from"./MessageGeneratorModal-C8TFbNyw.js";import{r as Ze}from"./react-vendor-B9D_A6Vq.js";import{f as pe,p as ye}from"./utils-BQuD9tR2.js";const Qe=U("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const we=U("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);const Re=U("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);const et=U("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);const tt=U("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const Se=U("Hotel",[["path",{d:"M18 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z",key:"p9z69c"}],["path",{d:"m9 16 .348-.24c1.465-1.013 3.84-1.013 5.304 0L15 16",key:"1bvcvh"}],["path",{d:"M8 7h.01",key:"1vti4s"}],["path",{d:"M16 7h.01",key:"1kdx03"}],["path",{d:"M12 7h.01",key:"1ivr5q"}],["path",{d:"M12 11h.01",key:"z322tv"}],["path",{d:"M16 11h.01",key:"xkw8gn"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M10 22v-6.5m4 0V22",key:"16gs4s"}]]);const He=U("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);const Me=U("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);const Le=U("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);const rt=U("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);const st=U("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);const ze=U("TramFront",[["rect",{width:"16",height:"16",x:"4",y:"3",rx:"2",key:"1wxw4b"}],["path",{d:"M4 11h16",key:"mpoxn0"}],["path",{d:"M12 3v8",key:"1h2ygw"}],["path",{d:"m8 19-2 3",key:"13i0xs"}],["path",{d:"m18 22-2-3",key:"1p0ohu"}],["path",{d:"M8 15h0",key:"q9eq1f"}],["path",{d:"M16 15h0",key:"pzrbjg"}]]);const ve=U("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);const ge=U("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]);const de=U("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),at=({initialData:t,onSubmit:b,onCancel:r})=>{const[y,x]=v.useState({category:t?.category||"transport",amount:t?.amount||0,description:t?.description||"",date:t?.date||new Date().toISOString().split("T")[0]}),n=s=>{s.preventDefault(),b(y)};return e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Cat√©gorie"}),e.jsxs("select",{value:y.category,onChange:s=>x({...y,category:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"transport",children:"Transport"}),e.jsx("option",{value:"accommodation",children:"H√©bergement"}),e.jsx("option",{value:"meal",children:"Repas"}),e.jsx("option",{value:"other",children:"Autre"})]})]}),e.jsx($,{label:"Montant (‚Ç¨)",type:"number",step:"0.01",value:y.amount,onChange:s=>x({...y,amount:parseFloat(s.target.value)||0})}),e.jsx($,{label:"Description",value:y.description,onChange:s=>x({...y,description:s.target.value})}),e.jsx($,{label:"Date",type:"date",value:y.date,onChange:s=>x({...y,date:s.target.value})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(p,{type:"button",variant:"ghost",onClick:r,children:"Annuler"}),e.jsx(p,{type:"submit",children:t?"Modifier":"Ajouter"})]})]})},nt=({expenses:t,onAdd:b,onEdit:r,onDelete:y,readOnly:x})=>{const n=t.reduce((s,k)=>s+k.amount,0);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:"D√©penses"}),!x&&e.jsx(p,{size:"sm",onClick:b,leftIcon:e.jsx(xe,{className:"w-4 h-4"}),children:"Ajouter"})]}),t.length===0?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"Aucune d√©pense enregistr√©e"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:t.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s.description||s.category}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(s.date).toLocaleDateString("fr-FR")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-bold text-gray-900 dark:text-white",children:[s.amount.toFixed(2)," ‚Ç¨"]}),!x&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>r(s),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",children:e.jsx(Ie,{className:"w-4 h-4 text-blue-600"})}),e.jsx("button",{onClick:()=>y(s.id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",children:e.jsx(Ne,{className:"w-4 h-4 text-red-600"})})]})]})]},s.id))}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Total"}),e.jsxs("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[n.toFixed(2)," ‚Ç¨"]})]})})]})]})},lt=({itinerary:t,onUpdate:b,readOnly:r=!1})=>{const y=(n,s)=>{b({...t,[n]:s})},x=n=>{const s=encodeURIComponent(t.meetingPoint||"");if(!s)return;const k=n==="waze"?`https://waze.com/ul?q=${s}&navigate=yes`:`https://www.google.com/maps/search/?api=1&query=${s}`;window.open(k,"_blank")};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex gap-4",children:[{mode:"car",icon:we,label:"Voiture"},{mode:"train",icon:ze,label:"Train"},{mode:"plane",icon:Le,label:"Avion"}].map(({mode:n,icon:s,label:k})=>e.jsxs("button",{type:"button",onClick:()=>y("transportMode",n),className:`flex-1 flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all ${t.transportMode===n?"border-primary bg-primary/5 text-primary":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 text-gray-500"}`,disabled:r,children:[e.jsx(s,{className:"w-6 h-6 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:k})]},n))}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx($,{label:"Distance (km)",type:"number",value:t.distance?.toString()||"",onChange:n=>y("distance",n.target.value?parseFloat(n.target.value):void 0),disabled:r,leftIcon:e.jsx(Me,{className:"w-4 h-4"})}),e.jsx($,{label:"Dur√©e estim√©e",placeholder:"ex: 1h 30m",value:t.duration?.toString()||"",onChange:n=>y("duration",n.target.value),disabled:r,leftIcon:e.jsx(je,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($,{label:"Point de rendez-vous / Adresse",value:t.meetingPoint||"",onChange:n=>y("meetingPoint",n.target.value),disabled:r,leftIcon:e.jsx(le,{className:"w-4 h-4"})}),t.meetingPoint&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"outline",className:"flex-1",onClick:()=>x("google"),leftIcon:e.jsx(He,{className:"w-4 h-4"}),children:"Google Maps"}),e.jsx(p,{variant:"outline",className:"flex-1",onClick:()=>x("waze"),leftIcon:e.jsx(Me,{className:"w-4 h-4"}),children:"Waze"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes de voyage"}),e.jsx("textarea",{value:t.notes||"",onChange:n=>y("notes",n.target.value),disabled:r,className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800 text-gray-900 dark:text-white text-sm focus:ring-primary focus:border-primary p-3 min-h-[100px]",placeholder:"Informations suppl√©mentaires..."})]})]})},Ae=t=>t?t.slice(0,16):"",ot=({accommodation:t,onUpdate:b,readOnly:r=!1,hosts:y=[]})=>{const x=(s,k)=>{b({...t,[s]:k})},n=()=>{const s=encodeURIComponent(t.address||t.name||"");s&&window.open(`https://www.google.com/maps/search/?api=1&query=${s}`,"_blank")};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex gap-4",children:[{type:"host",icon:ke,label:"Chez l'habitant"},{type:"hotel",icon:Qe,label:"H√¥tel"}].map(({type:s,icon:k,label:H})=>e.jsxs("button",{onClick:()=>!r&&x("type",s),className:`flex-1 flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all ${t.type===s?"border-primary bg-primary/5 text-primary":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 text-gray-500"}`,disabled:r,children:[e.jsx(k,{className:"w-6 h-6 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:H})]},s))}),e.jsxs("div",{className:"space-y-4",children:[t.type==="hotel"?e.jsx($,{label:"Nom de l'h√¥tel",value:t.name||"",onChange:s=>x("name",s.target.value),disabled:r,placeholder:"Ex: H√¥tel de la Gare"}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nom de l'h√¥te"}),e.jsxs("select",{value:t.name||"",onChange:s=>{const k=y.find(H=>H.nom===s.target.value);b({...t,name:s.target.value,address:k?.address||t.address||""})},disabled:r,title:"S√©lectionner un h√¥te",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"S√©lectionner un h√¥te..."}),y.map(s=>e.jsx("option",{value:s.nom,children:s.nom},s.nom))]})]}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsx($,{label:"Adresse",value:t.address||"",onChange:s=>x("address",s.target.value),disabled:r,leftIcon:e.jsx(le,{className:"w-4 h-4"})})}),t.address&&e.jsx(p,{variant:"outline",className:"mb-[2px]",onClick:n,leftIcon:e.jsx(le,{className:"w-4 h-4"}),children:"Voir"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx($,{label:"Arriv√©e (Check-in)",type:"datetime-local",value:Ae(t.checkIn),onChange:s=>x("checkIn",s.target.value),disabled:r}),e.jsx($,{label:"D√©part (Check-out)",type:"datetime-local",value:Ae(t.checkOut),onChange:s=>x("checkOut",s.target.value),disabled:r})]}),t.type==="hotel"&&e.jsx($,{label:"R√©f√©rence r√©servation",value:t.bookingReference||"",onChange:s=>x("bookingReference",s.target.value),disabled:r,leftIcon:e.jsx(Ye,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes / Instructions"}),e.jsx("textarea",{value:t.notes||"",onChange:s=>x("notes",s.target.value),disabled:r,className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800 text-gray-900 dark:text-white text-sm focus:ring-primary focus:border-primary p-3 min-h-[100px]",placeholder:"Codes d'acc√®s, petit-d√©jeuner, etc."})]})]})]})},it=({items:t=[],onUpdate:b})=>{const[r,y]=v.useState(""),[x,n]=v.useState(!1),s=i=>{const f=t.map(N=>N.id===i?{...N,isCompleted:!N.isCompleted}:N);b(f)},k=i=>{const f=t.filter(N=>N.id!==i);b(f)},H=i=>{if(i?.preventDefault(),!r.trim())return;const f={id:Pe(),label:r.trim(),isCompleted:!1};b([...t,f]),y(""),n(!1)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Liste des t√¢ches (",t.filter(i=>i.isCompleted).length,"/",t.length,")"]}),e.jsxs(p,{size:"sm",variant:"ghost",onClick:()=>n(!x),className:"text-primary hover:text-primary/80 p-0 h-auto",children:[e.jsx(xe,{className:"w-4 h-4 mr-1"}),"Ajouter"]})]}),x&&e.jsxs("form",{onSubmit:H,className:"flex gap-2 items-center mb-4 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx($,{autoFocus:!0,value:r,onChange:i=>y(i.target.value),placeholder:"Nouvelle t√¢che...",className:"flex-1 h-9 text-sm"}),e.jsx(p,{type:"submit",size:"sm",disabled:!r.trim(),children:"Ajouter"}),e.jsx(p,{type:"button",variant:"ghost",size:"sm",onClick:()=>n(!1),leftIcon:e.jsx(Ee,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-2",children:t.length===0&&!x?e.jsxs("div",{className:"text-center py-6 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Aucune t√¢che pour le moment"}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>n(!0),children:"Commencer une liste"})]}):t.map(i=>e.jsxs("div",{className:`flex items-center group p-2 rounded-lg transition-colors hover:bg-gray-50 dark:hover:bg-gray-800/50 ${i.isCompleted?"opacity-75":""}`,children:[e.jsx("button",{onClick:()=>s(i.id),className:`flex-shrink-0 w-5 h-5 rounded border flex items-center justify-center mr-3 transition-colors ${i.isCompleted?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600 hover:border-green-500"}`,children:i.isCompleted&&e.jsx(Ke,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:`flex-1 text-sm transition-all ${i.isCompleted?"text-gray-400 line-through":"text-gray-700 dark:text-gray-200"}`,children:i.label}),e.jsx("button",{onClick:()=>k(i.id),className:"opacity-0 group-hover:opacity-100 p-1 text-gray-400 hover:text-red-500 transition-opacity",title:"Supprimer",children:e.jsx(Ne,{className:"w-4 h-4"})})]},i.id))})]})},ct=({logistics:t={},onUpdate:b,readOnly:r=!1,hosts:y=[]})=>{const[x,n]=v.useState("itinerary"),s=f=>{b({...t,itinerary:f})},k=f=>{b({...t,accommodation:f})},H=f=>{b({...t,checklist:f})},i=[{id:"itinerary",label:"Trajet",icon:He},{id:"accommodation",label:"H√©bergement",icon:ke},{id:"checklist",label:"T√¢ches",icon:Re}];return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-700 mb-6",children:i.map(({id:f,label:N,icon:I})=>e.jsxs("button",{onClick:()=>n(f),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${x===f?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[e.jsx(I,{className:"w-4 h-4"}),N]},f))}),e.jsxs("div",{className:"flex-1 overflow-y-auto min-h-[400px]",children:[x==="itinerary"&&e.jsx(lt,{itinerary:t.itinerary||{transportMode:"car"},onUpdate:s,readOnly:r}),x==="accommodation"&&e.jsx(ot,{accommodation:t.accommodation||{type:"host",name:""},onUpdate:k,readOnly:r,hosts:y}),x==="checklist"&&e.jsx(it,{items:t.checklist||[],onUpdate:H})]})]})},dt=[{value:"car",label:"Voiture personnelle",icon:we,color:"blue"},{value:"carpool",label:"Covoiturage",icon:qe,color:"green"},{value:"train",label:"Train",icon:ze,color:"purple"},{value:"plane",label:"Avion",icon:Le,color:"orange"},{value:"other",label:"Autre",icon:le,color:"gray"}],mt=({isOpen:t,onClose:b,visit:r,onSave:y})=>{const{visits:x}=De(),[n,s]=v.useState("car"),[k,H]=v.useState(""),[i,f]=v.useState(""),[N,I]=v.useState(""),[q,ee]=v.useState(""),[X,Y]=v.useState(),[K,c]=v.useState(""),[l,j]=v.useState(),[w,O]=v.useState([]),[P,V]=v.useState(""),[L,A]=v.useState(""),[S,a]=v.useState(""),d=v.useMemo(()=>x.filter(o=>o.visitDate===r.visitDate&&o.visitId!==r.visitId&&o.status!=="cancelled").map(o=>({visitId:o.visitId,speakerId:o.id,speakerName:o.nom,congregation:o.congregation,time:o.visitTime})),[x,r]),T=o=>{O(Q=>Q.includes(o)?Q.filter(ae=>ae!==o):[...Q,o])},R=()=>{if(!l)return 0;const o=1+w.length;return(l/o).toFixed(2)},te=()=>{const o={visitId:r.visitId,transportMode:n,departureTime:k||void 0,arrivalTime:i||void 0,departureLocation:N||void 0,arrivalLocation:q||void 0,distance:X||void 0,duration:K||void 0,estimatedCost:l||void 0,carpoolPartners:n==="carpool"?w:void 0,notes:P||void 0,mapLink:L||void 0,bookingReference:S||void 0};y(o),b()};return e.jsx(he,{isOpen:t,onClose:b,title:"Coordination du voyage",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-primary-50 to-blue-50 dark:from-primary-900/20 dark:to-blue-900/20 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:r.nom}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[new Date(r.visitDate).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})," √† ",r.visitTime]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Mode de transport"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:dt.map(o=>e.jsxs("button",{onClick:()=>s(o.value),className:`p-4 rounded-lg border-2 transition-all ${n===o.value?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx(o.icon,{className:`w-6 h-6 mx-auto mb-2 ${n===o.value?"text-primary-600":"text-gray-400"}`}),e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:o.label})]},o.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(je,{className:"w-4 h-4 inline mr-1"}),"Heure de d√©part"]}),e.jsx("input",{type:"time",value:k,onChange:o=>H(o.target.value),"aria-label":"Heure de d√©part",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(je,{className:"w-4 h-4 inline mr-1"}),"Heure d'arriv√©e"]}),e.jsx("input",{type:"time",value:i,onChange:o=>f(o.target.value),"aria-label":"Heure d'arriv√©e",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline mr-1"}),"Lieu de d√©part"]}),e.jsx("input",{type:"text",value:N,onChange:o=>I(o.target.value),placeholder:"Adresse de d√©part",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline mr-1"}),"Lieu d'arriv√©e"]}),e.jsx("input",{type:"text",value:q,onChange:o=>ee(o.target.value),placeholder:"Adresse d'arriv√©e",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Distance (km)"}),e.jsx("input",{type:"number",value:X||"",onChange:o=>Y(o.target.value?Number(o.target.value):void 0),placeholder:"150",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Dur√©e estim√©e"}),e.jsx("input",{type:"text",value:K,onChange:o=>c(o.target.value),placeholder:"2h 30min",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(tt,{className:"w-4 h-4 inline mr-1"}),"Co√ªt estim√© (‚Ç¨)"]}),e.jsx("input",{type:"number",value:l||"",onChange:o=>j(o.target.value?Number(o.target.value):void 0),placeholder:"50",step:"0.01",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),n==="carpool"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsx(st,{className:"w-4 h-4 inline mr-1"}),"Partenaires de covoiturage"]}),w.length>0&&l&&e.jsxs(Oe,{variant:"success",children:[R(),"‚Ç¨ / personne"]})]}),d.length===0?e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center text-sm text-gray-600 dark:text-gray-400",children:"Aucun orateur disponible pour le covoiturage ce jour-l√†"}):e.jsx("div",{className:"space-y-2",children:d.map(o=>e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsx("input",{type:"checkbox",checked:w.includes(o.visitId),onChange:()=>T(o.visitId),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:o.speakerName}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.congregation," ‚Ä¢ ",o.time]})]})]},o.visitId))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Lien Google Maps (optionnel)"}),e.jsx("input",{type:"url",value:L,onChange:o=>A(o.target.value),placeholder:"https://maps.google.com/...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(n==="train"||n==="plane")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"R√©f√©rence de r√©servation"}),e.jsx("input",{type:"text",value:S,onChange:o=>a(o.target.value),placeholder:"ABC123456",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes suppl√©mentaires"}),e.jsx("textarea",{value:P,onChange:o=>V(o.target.value),rows:3,placeholder:"Informations compl√©mentaires sur le voyage...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(X||K||l)&&e.jsx(be,{className:"bg-blue-50 dark:bg-blue-900/20",children:e.jsxs(fe,{children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-200 mb-2",children:"R√©sum√© du voyage"}),e.jsxs("div",{className:"space-y-1 text-sm text-blue-800 dark:text-blue-300",children:[X&&e.jsxs("p",{children:["‚Ä¢ Distance : ",X," km"]}),K&&e.jsxs("p",{children:["‚Ä¢ Dur√©e : ",K]}),l&&e.jsxs("p",{children:["‚Ä¢ Co√ªt : ",l,"‚Ç¨",n==="carpool"&&w.length>0&&e.jsxs("span",{children:[" (",R(),"‚Ç¨ / personne)"]})]}),n==="carpool"&&w.length>0&&e.jsxs("p",{children:["‚Ä¢ ",w.length+1," personne(s) dans le covoiturage"]})]})]})}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(p,{variant:"secondary",onClick:b,children:"Annuler"}),e.jsxs(p,{variant:"primary",onClick:te,children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Enregistrer le plan de voyage"]})]})]})})},me=[{value:"breakfast",label:"Petit-d√©jeuner",icon:"üåÖ",defaultTime:"08:00"},{value:"lunch",label:"D√©jeuner",icon:"üçΩÔ∏è",defaultTime:"12:30"},{value:"dinner",label:"D√Æner",icon:"üåô",defaultTime:"19:00"},{value:"snack",label:"Collation",icon:"‚òï",defaultTime:"15:00"}],gt=["V√©g√©tarien","V√©g√©talien","Sans gluten","Sans lactose","Halal","Casher","Sans porc","Sans fruits de mer"],ut=["Arachides","Fruits √† coque","Lait","≈íufs","Poisson","Crustac√©s","Soja","Bl√©"],xt=({isOpen:t,onClose:b,visit:r,onSave:y,hosts:x=[]})=>{const[n,s]=v.useState([]),[k,H]=v.useState([]),[i,f]=v.useState([]),[N]=v.useState([]),[I,q]=v.useState(""),[ee,X]=v.useState(""),[Y,K]=v.useState(""),c=a=>{const d=me.find(R=>R.value===a),T={id:`meal-${Date.now()}`,type:a,time:d?.defaultTime||"12:00",location:"",attendees:1};s([...n,T])},l=(a,d)=>{s(n.map(T=>T.id===a?{...T,...d}:T))},j=a=>{s(n.filter(d=>d.id!==a))},w=a=>{H(d=>d.includes(a)?d.filter(T=>T!==a):[...d,a])},O=a=>{f(d=>d.includes(a)?d.filter(T=>T!==a):[...d,a])},P=()=>{ee.trim()&&(H([...k,ee.trim()]),X(""))},V=()=>{Y.trim()&&(f([...i,Y.trim()]),K(""))},L=()=>{const a={visitId:r.visitId,meals:n,dietaryRestrictions:k,allergies:i,preferences:N,notes:I||void 0};y(a),b()},A=()=>n.reduce((a,d)=>a+(d.cost||0),0),S=a=>me.find(d=>d.value===a)?.icon||"üçΩÔ∏è";return e.jsx(he,{isOpen:t,onClose:b,title:"Planification des repas",size:"xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-orange-50 to-yellow-50 dark:from-orange-900/20 dark:to-yellow-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ge,{className:"w-5 h-5 text-orange-600"}),e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:r.nom})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:new Date(r.visitDate).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Restrictions alimentaires"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:gt.map(a=>e.jsx("button",{onClick:()=>w(a),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${k.includes(a)?"bg-orange-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:a},a))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:ee,onChange:a=>X(a.target.value),onKeyPress:a=>a.key==="Enter"&&P(),placeholder:"Autre restriction...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),e.jsx(p,{variant:"outline",size:"sm",onClick:P,children:e.jsx(xe,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4 text-red-600"}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Allergies (important !)"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ut.map(a=>e.jsx("button",{onClick:()=>O(a),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${i.includes(a)?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:a},a))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:Y,onChange:a=>K(a.target.value),onKeyPress:a=>a.key==="Enter"&&V(),placeholder:"Autre allergie...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),e.jsx(p,{variant:"outline",size:"sm",onClick:V,children:e.jsx(xe,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Repas planifi√©s"}),e.jsx("div",{className:"flex gap-2",children:me.map(a=>e.jsx(p,{variant:"outline",size:"sm",onClick:()=>c(a.value),title:`Ajouter ${a.label}`,children:e.jsx("span",{className:"text-lg",children:a.icon})},a.value))})]}),n.length===0?e.jsxs("div",{className:"p-8 text-center bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx(ge,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Aucun repas planifi√©. Cliquez sur les ic√¥nes ci-dessus pour ajouter un repas."})]}):e.jsx("div",{className:"space-y-3",children:n.map(a=>e.jsx(be,{children:e.jsx(fe,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:S(a.type)}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:me.find(d=>d.value===a.type)?.label})]}),e.jsx("button",{onClick:()=>j(a.id),"aria-label":"Supprimer ce repas",className:"p-1 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:e.jsx(Ee,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Heure"}),e.jsx("input",{type:"time",value:a.time,onChange:d=>l(a.id,{time:d.target.value}),"aria-label":"Heure du repas",className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Nombre de personnes"}),e.jsx("input",{type:"number",value:a.attendees,onChange:d=>l(a.id,{attendees:Number(d.target.value)}),min:"1","aria-label":"Nombre de personnes",className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Lieu"}),e.jsx("input",{type:"text",value:a.location,onChange:d=>l(a.id,{location:d.target.value}),placeholder:"Restaurant, domicile, etc.",className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"H√¥te / Responsable"}),e.jsxs("select",{value:a.host||"",onChange:d=>l(a.id,{host:d.target.value}),className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"S√©lectionner un h√¥te..."}),x.map(d=>e.jsx("option",{value:d.nom,children:d.nom},d.nom))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Menu (optionnel)"}),e.jsx("input",{type:"text",value:a.menu||"",onChange:d=>l(a.id,{menu:d.target.value}),placeholder:"Description du menu",className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Co√ªt estim√© (‚Ç¨)"}),e.jsx("input",{type:"number",value:a.cost||"",onChange:d=>l(a.id,{cost:d.target.value?Number(d.target.value):void 0}),placeholder:"0.00",step:"0.01",className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]})})},a.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes suppl√©mentaires"}),e.jsx("textarea",{value:I,onChange:a=>q(a.target.value),rows:3,placeholder:"Pr√©f√©rences culinaires, informations compl√©mentaires...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(n.length>0||k.length>0||i.length>0)&&e.jsx(be,{className:"bg-blue-50 dark:bg-blue-900/20",children:e.jsxs(fe,{children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-200 mb-2",children:"R√©sum√©"}),e.jsxs("div",{className:"space-y-1 text-sm text-blue-800 dark:text-blue-300",children:[e.jsxs("p",{children:["‚Ä¢ ",n.length," repas planifi√©(s)"]}),k.length>0&&e.jsxs("p",{children:["‚Ä¢ ",k.length," restriction(s) alimentaire(s)"]}),i.length>0&&e.jsxs("p",{className:"text-red-600 dark:text-red-400 font-medium",children:["‚ö†Ô∏è ",i.length," allergie(s) √† prendre en compte"]}),A()>0&&e.jsxs("p",{children:["‚Ä¢ Co√ªt total estim√© : ",A().toFixed(2),"‚Ç¨"]})]})]})}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(p,{variant:"secondary",onClick:b,children:"Annuler"}),e.jsxs(p,{variant:"primary",onClick:L,children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Enregistrer le plan de repas"]})]})]})})},ht=({isOpen:t,onClose:b,visit:r,onSelectHost:y})=>e.jsx(he,{isOpen:t,onClose:b,size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"G√©rer l'h√©bergement"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Visite de ",r.nom," le ",new Date(r.visitDate).toLocaleDateString("fr-FR")]}),e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Fonctionnalit√© en cours de d√©veloppement"})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{onClick:b,children:"Fermer"})})]})});var ue={exports:{}},pt=ue.exports,Te;function yt(){return Te||(Te=1,(function(t,b){(function(r,y){t.exports=y(Ze())})(typeof self<"u"?self:pt,function(r){return(function(){var y={155:function(c){c.exports=r}},x={};function n(c){var l=x[c];if(l!==void 0)return l.exports;var j=x[c]={exports:{}};return y[c](j,j.exports,n),j.exports}n.d=function(c,l){for(var j in l)n.o(l,j)&&!n.o(c,j)&&Object.defineProperty(c,j,{enumerable:!0,get:l[j]})},n.o=function(c,l){return Object.prototype.hasOwnProperty.call(c,l)},n.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var s={};n.r(s),n.d(s,{useReactToPrint:function(){return K}});var k=n(155);const H="printWindow";function i({level:c="error",messages:l,suppressErrors:j=!1}){j||(c==="error"?console.error(l):c==="warning"?console.warn(l):console.debug(l))}function f(c,l){if(l||!c){const j=document.getElementById(H);j&&document.body.removeChild(j)}}function N(c){return c instanceof Error?c:new Error("Unknown Error")}function I(c,l){const{documentTitle:j,onAfterPrint:w,onPrintError:O,preserveAfterPrint:P,print:V,suppressErrors:L}=l;setTimeout(()=>{var A,S;if(c.contentWindow){let a=function(){w?.(),f(P)};if(c.contentWindow.focus(),V)V(c).then(a).catch(d=>{O?O("print",N(d)):i({messages:["An error was thrown by the specified `print` function"],suppressErrors:L})});else{if(c.contentWindow.print){const d=(S=(A=c.contentDocument)===null||A===void 0?void 0:A.title)!==null&&S!==void 0?S:"",T=c.ownerDocument.title;j&&(c.ownerDocument.title=j,c.contentDocument&&(c.contentDocument.title=j)),c.contentWindow.print(),j&&(c.ownerDocument.title=T,c.contentDocument&&(c.contentDocument.title=d))}else i({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:L});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(d=>{var T,R;return((R=(T=navigator.userAgent)!==null&&T!==void 0?T:navigator.vendor)!==null&&R!==void 0?R:"opera"in window&&window.opera).match(d)})?setTimeout(a,500):a()}}else i({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:L})},500)}function q(c){const l=[],j=document.createTreeWalker(c,NodeFilter.SHOW_ELEMENT,null);let w=j.nextNode();for(;w;)l.push(w),w=j.nextNode();return l}function ee(c,l,j){const w=q(c),O=q(l);if(w.length===O.length)for(let P=0;P<w.length;P++){const V=w[P],L=O[P],A=V.shadowRoot;if(A!==null){const S=L.attachShadow({mode:A.mode});S.innerHTML=A.innerHTML,ee(A,S,j)}}else i({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",c,l],suppressErrors:j})}const X=`
    @page {
        /* Remove browser default header (title) and footer (url) */
        margin: 0;
    }
    @media print {
        body {
            /* Tell browsers to print background colors */
            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */
            print-color-adjust: exact; /* Firefox/Safari */
            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
        }
    }
`;function Y(c,l,j,w){var O,P,V,L,A;const{contentNode:S,clonedContentNode:a,clonedImgNodes:d,clonedVideoNodes:T,numResourcesToLoad:R,originalCanvasNodes:te}=j,{bodyClass:o,fonts:Q,ignoreGlobalStyles:ae,pageStyle:m,nonce:u,suppressErrors:z,copyShadowRoots:E}=w;c.onload=null;const g=(O=c.contentDocument)!==null&&O!==void 0?O:(P=c.contentWindow)===null||P===void 0?void 0:P.document;if(g){const D=g.body.appendChild(a);E&&ee(S,D,!!z),Q&&(!((V=c.contentDocument)===null||V===void 0)&&V.fonts&&(!((L=c.contentWindow)===null||L===void 0)&&L.FontFace)?Q.forEach(C=>{const h=new FontFace(C.family,C.source,{weight:C.weight,style:C.style});c.contentDocument.fonts.add(h),h.loaded.then(()=>{l(h)}).catch(W=>{l(h,["Failed loading the font:",h,"Load error:",N(W)])})}):(Q.forEach(C=>{l(C)}),i({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:z})));const _=m??X,B=g.createElement("style");u&&(B.setAttribute("nonce",u),g.head.setAttribute("nonce",u)),B.appendChild(g.createTextNode(_)),g.head.appendChild(B),o&&g.body.classList.add(...o.split(" "));const oe=g.querySelectorAll("canvas");for(let C=0;C<te.length;++C){const h=te[C],W=oe[C];if(W===void 0){i({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",h],suppressErrors:z});continue}const M=W.getContext("2d");M&&M.drawImage(h,0,0)}for(let C=0;C<d.length;C++){const h=d[C],W=h.getAttribute("src");if(W){const M=new Image;M.onload=()=>{l(h)},M.onerror=(F,G,re,Z,se)=>{l(h,["Error loading <img>",h,"Error",se])},M.src=W}else l(h,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',h])}for(let C=0;C<T.length;C++){const h=T[C];h.preload="auto";const W=h.getAttribute("poster");if(W){const M=new Image;M.onload=()=>{l(h)},M.onerror=(F,G,re,Z,se)=>{l(h,["Error loading video poster",W,"for video",h,"Error:",se])},M.src=W}else h.readyState>=2?l(h):h.src?(h.onloadeddata=()=>{l(h)},h.onerror=(M,F,G,re,Z)=>{l(h,["Error loading video",h,"Error",Z])},h.onstalled=()=>{l(h,["Loading video stalled, skipping",h])}):l(h,["Error loading video, `src` is empty",h])}const ie="select",J=S.querySelectorAll(ie),ne=g.querySelectorAll(ie);for(let C=0;C<J.length;C++)ne[C].value=J[C].value;if(!ae){const C=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let h=0,W=C.length;h<W;++h){const M=C[h];if(M.tagName.toLowerCase()==="style"){const F=g.createElement(M.tagName),G=M.sheet;if(G){let re="";try{const Z=G.cssRules.length;for(let se=0;se<Z;++se)typeof G.cssRules[se].cssText=="string"&&(re+=`${G.cssRules[se].cssText}\r
`)}catch(Z){i({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",M,`Original error: ${N(Z).message}`],level:"warning"})}F.setAttribute("id",`react-to-print-${h}`),u&&F.setAttribute("nonce",u),F.appendChild(g.createTextNode(re)),g.head.appendChild(F)}}else if(M.getAttribute("href"))if(M.hasAttribute("disabled"))i({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",M],level:"warning"}),l(M);else{const F=g.createElement(M.tagName);for(let G=0,re=M.attributes.length;G<re;++G){const Z=M.attributes[G];Z&&F.setAttribute(Z.nodeName,(A=Z.nodeValue)!==null&&A!==void 0?A:"")}F.onload=()=>{l(F)},F.onerror=(G,re,Z,se,Fe)=>{l(F,["Failed to load",F,"Error:",Fe])},u&&F.setAttribute("nonce",u),g.head.appendChild(F)}else i({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",M],level:"warning"}),l(M)}}}R===0&&I(c,w)}function K({bodyClass:c,contentRef:l,copyShadowRoots:j,documentTitle:w,fonts:O,ignoreGlobalStyles:P,nonce:V,onAfterPrint:L,onBeforePrint:A,onPrintError:S,pageStyle:a,preserveAfterPrint:d,print:T,printIframeProps:R,suppressErrors:te}){return(0,k.useCallback)(Q=>{function ae(){const m={bodyClass:c,contentRef:l,copyShadowRoots:j,documentTitle:w,fonts:O,ignoreGlobalStyles:P,nonce:V,onAfterPrint:L,onPrintError:S,pageStyle:a,preserveAfterPrint:d,print:T,suppressErrors:te},u=(function(g){const D=document.createElement("iframe");return D.width=`${document.documentElement.clientWidth}px`,D.height=`${document.documentElement.clientHeight}px`,D.style.position="absolute",D.style.top=`-${document.documentElement.clientHeight+100}px`,D.style.left=`-${document.documentElement.clientWidth+100}px`,D.id=H,D.srcdoc="<!DOCTYPE html>",g&&(g.allow&&(D.allow=g.allow),g.referrerPolicy!==void 0&&(D.referrerPolicy=g.referrerPolicy),g.sandbox!==void 0&&(D.sandbox=g.sandbox)),D})(R),z=(function(g,D){const{contentRef:_,fonts:B,ignoreGlobalStyles:oe,suppressErrors:ie}=D,J=(function({contentRef:F,optionalContent:G,suppressErrors:re}){return G&&typeof G=="function"?(F&&i({level:"warning",messages:['"react-to-print" received a `contentRef` option and an optional-content param passed to its callback. The `contentRef` option will be ignored.']}),G()):F?F.current:void i({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:re})})({contentRef:_,optionalContent:g,suppressErrors:ie});if(!J)return;const ne=J.cloneNode(!0),C=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),h=ne.querySelectorAll("img"),W=ne.querySelectorAll("video"),M=B?B.length:0;return{contentNode:J,clonedContentNode:ne,clonedImgNodes:h,clonedVideoNodes:W,numResourcesToLoad:(oe?0:C.length)+h.length+W.length+M,originalCanvasNodes:J.querySelectorAll("canvas")}})(Q,m);if(!z)return void i({messages:["There is nothing to print"],suppressErrors:te});const E=(function(g,D,_){const{suppressErrors:B}=g,oe=[],ie=[];return function(J,ne){oe.includes(J)?i({level:"debug",messages:["Tried to mark a resource that has already been handled",J],suppressErrors:B}):(ne?(i({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...ne],suppressErrors:B}),ie.push(J)):oe.push(J),oe.length+ie.length===D&&I(_,g))}})(m,z.numResourcesToLoad,u);(function(g,D,_,B){g.onload=()=>{Y(g,D,_,B)},document.body.appendChild(g)})(u,E,z,m)}f(d,!0),A?A().then(()=>{ae()}).catch(m=>{S?.("onBeforePrint",N(m))}):ae()},[c,l,j,w,O,P,V,L,A,S,a,d,T,te])}return s})()})})(ue)),ue.exports}var bt=yt();const ft=({visit:t,speaker:b,host:r})=>{const y=v.useRef(null),x=bt.useReactToPrint({content:()=>y.current,documentTitle:`Feuille_de_route_${t.nom}_${t.visitDate}`}),n=s=>{try{return pe(ye(s),"EEEE d MMMM yyyy",{locale:_e})}catch{return s}};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end no-print",children:e.jsx(p,{onClick:x,leftIcon:e.jsx(rt,{className:"w-4 h-4"}),children:"Imprimer la feuille de route"})}),e.jsxs("div",{ref:y,className:"bg-white p-8 max-w-[210mm] mx-auto min-h-[297mm] shadow-sm print:shadow-none print:w-full print:max-w-none",children:[e.jsxs("div",{className:"border-b-2 border-gray-800 pb-6 mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold uppercase tracking-wider mb-2 text-gray-900",children:"Feuille de Route"}),e.jsx("p",{className:"text-xl text-gray-600",children:t.congregation}),e.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 bg-gray-100 px-4 py-2 rounded-lg",children:[e.jsx($e,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold text-lg",children:n(t.visitDate)}),e.jsx("span",{className:"text-gray-400 mx-2",children:"|"}),e.jsx("span",{className:"font-semibold",children:t.visitTime})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 print:grid-cols-2 print:gap-8",children:[e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold uppercase border-b border-gray-300 pb-2 flex items-center gap-2 text-primary-700 print:text-black",children:[e.jsx(Xe,{className:"w-5 h-5"})," Orateur & Discours"]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-transparent print:border print:border-gray-200",children:[e.jsx("div",{className:"font-semibold text-lg mb-1",children:t.nom}),e.jsx("div",{className:"text-gray-600 mb-2",children:b?.email||"Email non renseign√©"}),e.jsx("div",{className:"text-gray-600 mb-4",children:b?.telephone||"Tel non renseign√©"}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-500 uppercase font-semibold",children:"Discours"}),e.jsxs("div",{className:"font-medium",children:["N¬∞",t.talkNoOrType||"Non d√©fini"]}),t.talkTheme&&e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:t.talkTheme})]})]})]}),t.meals&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold uppercase border-b border-gray-300 pb-2 flex items-center gap-2 text-primary-700 print:text-black",children:[e.jsx(Se,{className:"w-5 h-5"})," Repas"]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-transparent print:border print:border-gray-200",children:e.jsx("div",{className:"text-gray-700",children:t.meals})})]}),(r||t.logistics?.accommodation?.name)&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold uppercase border-b border-gray-300 pb-2 flex items-center gap-2 text-primary-700 print:text-black",children:[e.jsx(Se,{className:"w-5 h-5"})," H√©bergement"]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-transparent print:border print:border-gray-200",children:[r&&t.logistics?.accommodation?.type!=="hotel"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-semibold text-lg mb-1",children:r.nom}),e.jsxs("div",{className:"flex items-start gap-2 text-gray-600 mb-2",children:[e.jsx(le,{className:"w-4 h-4 mt-1 flex-shrink-0"}),e.jsx("span",{children:r.address})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(Ge,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:r.telephone})]}),e.jsx("div",{className:"text-sm text-gray-500 mt-2",children:r.notes&&e.jsxs("p",{className:"italic",children:['"',r.notes,'"']})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-semibold text-lg mb-1",children:t.logistics?.accommodation?.name}),e.jsxs("div",{className:"flex items-start gap-2 text-gray-600 mb-2",children:[e.jsx(le,{className:"w-4 h-4 mt-1 flex-shrink-0"}),e.jsx("span",{children:t.logistics?.accommodation?.address||"Adresse non renseign√©e"})]}),t.logistics?.accommodation?.bookingReference&&e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("strong",{children:"R√©f√©rence:"})," ",t.logistics.accommodation.bookingReference]}),e.jsx("div",{className:"text-sm text-gray-500 mt-2",children:t.logistics?.accommodation?.notes&&e.jsxs("p",{className:"italic",children:['"',t.logistics.accommodation.notes,'"']})})]}),t.logistics?.accommodation&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 text-sm grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block",children:"Check-in"}),e.jsx("span",{className:"font-medium",children:t.logistics.accommodation.checkIn?pe(ye(t.logistics.accommodation.checkIn),"dd/MM HH:mm"):"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block",children:"Check-out"}),e.jsx("span",{className:"font-medium",children:t.logistics.accommodation.checkOut?pe(ye(t.logistics.accommodation.checkOut),"dd/MM HH:mm"):"-"})]})]})]})]}),t.logistics?.itinerary&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold uppercase border-b border-gray-300 pb-2 flex items-center gap-2 text-primary-700 print:text-black",children:[e.jsx(ve,{className:"w-5 h-5"})," Trajet"]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-transparent print:border print:border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Mode"}),e.jsx("div",{className:"font-medium capitalize",children:t.logistics.itinerary.transportMode})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Dur√©e estim√©e"}),e.jsx("div",{className:"font-medium",children:t.logistics.itinerary.duration||"-"})]})]}),t.logistics.itinerary.meetingPoint&&e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Point de RDV"}),e.jsx("div",{className:"font-medium",children:t.logistics.itinerary.meetingPoint})]})]})]}),t.logistics?.checklist&&t.logistics.checklist.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold uppercase border-b border-gray-300 pb-2 flex items-center gap-2 text-primary-700 print:text-black",children:[e.jsx(Re,{className:"w-5 h-5"})," √Ä ne pas oublier"]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-transparent print:border print:border-gray-200",children:e.jsxs("ul",{className:"space-y-2",children:[t.logistics.checklist.filter(s=>!s.isCompleted).map(s=>e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-black rounded-sm print:block"}),e.jsx("span",{children:s.label})]},s.id)),t.logistics.checklist.every(s=>s.isCompleted)&&e.jsx("li",{className:"text-green-600 italic",children:"Toutes les t√¢ches logistiques sont compl√©t√©es."})]})})]})]}),e.jsx("div",{className:"mt-16 text-center text-sm text-gray-400 border-t pt-8 print:mt-auto print:absolute print:bottom-8 print:left-0 print:right-0",children:e.jsxs("p",{children:["G√©n√©r√© par KBV2 Manager - ",new Date().toLocaleDateString()]})})]})]})},Et=({isOpen:t,onClose:b,visit:r,action:y})=>{const{updateVisit:x,deleteVisit:n,completeVisit:s,speakers:k,hosts:H}=De(),{addToast:i}=Be(),[f,N]=v.useState(!1),[I,q]=v.useState({}),[ee,X]=v.useState(!1),[Y,K]=v.useState(void 0),[c,l]=v.useState("accommodation"),[j,w]=v.useState(!1),[O,P]=v.useState(!1),[V,L]=v.useState(!1),[A,S]=v.useState({isOpen:!1,type:"confirmation"});if(v.useEffect(()=>{r&&q(r)},[r]),!r)return null;const a=async()=>{if(I){N(!0);try{await x({...r,...I}),i("Visite mise √† jour","success"),b()}catch{i("Erreur lors de la mise √† jour","error")}finally{N(!1)}}},{confirm:d}=Ce(),T=async()=>{if(await d({title:"Supprimer la visite",message:"√ätes-vous s√ªr de vouloir supprimer cette visite ?",confirmText:"Supprimer",confirmVariant:"danger",cancelText:"Annuler"})){N(!0);try{await n(r.visitId),i("Visite supprim√©e","success"),b()}catch{i("Erreur lors de la suppression","error")}finally{N(!1)}}},R=async m=>{N(!0);try{m==="completed"?(await s(r),i("Visite termin√©e et archiv√©e","success")):(await x({...r,status:m}),i("Statut mis √† jour","success")),b()}catch{i("Erreur lors de la mise √† jour","error")}finally{N(!1)}},te=async m=>{N(!0);try{const u=r.expenses||[];let z;Y?z=u.map(g=>g.id===Y.id?{...m,id:Y.id}:g):z=[...u,{...m,id:Pe()}];const E={...r,expenses:z};await x(E),q(E),i(Y?"D√©pense modifi√©e":"D√©pense ajout√©e","success"),X(!1),K(void 0)}catch{i("Erreur lors de la sauvegarde de la d√©pense","error")}finally{N(!1)}},o=async m=>{const{confirm:u}=Ce();if(await u({title:"Supprimer la d√©pense",message:"Voulez-vous vraiment supprimer cette d√©pense ?",confirmText:"Supprimer",confirmVariant:"danger",cancelText:"Annuler"})){N(!0);try{const E=(r.expenses||[]).filter(D=>D.id!==m),g={...r,expenses:E};await x(g),q(g),i("D√©pense supprim√©e","success")}catch{i("Erreur lors de la suppression","error")}finally{N(!1)}}},Q=()=>{switch(y){case"edit":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ie,{className:"w-5 h-5"}),"Modifier la visite"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx($,{label:"Date",type:"date",value:I.visitDate||"",onChange:m=>q(u=>({...u,visitDate:m.target.value}))}),e.jsx($,{label:"Heure",type:"time",value:I.visitTime||"",onChange:m=>q(u=>({...u,visitTime:m.target.value}))}),e.jsx($,{label:"N¬∞ Discours",value:I.talkNoOrType||"",onChange:m=>q(u=>({...u,talkNoOrType:m.target.value})),placeholder:"Ex: 185"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contact d'accueil"}),e.jsxs("select",{value:I.host||"",onChange:m=>{const{value:u}=m.target,z=H.find(E=>E.nom===u);q(E=>{const g=E.logistics||{},_={...g.accommodation||{}};let B=E.accommodation;return u==="H√¥tel"?(_.type="hotel",_.type,B=""):z?(_.type="host",_.name=z.nom,_.address=z.address,B=z.address||""):u==="Pas besoin"&&(_.type="other",_.name="",_.address="",B=""),{...E,host:u,accommodation:B,logistics:{...g,accommodation:_}}})},title:"S√©lectionner un h√¥te",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"S√©lectionner un h√¥te..."}),e.jsx("option",{value:"Pas besoin",children:"Pas besoin"}),e.jsx("option",{value:"H√¥tel",children:"H√¥tel"}),H.map(m=>e.jsx("option",{value:m.nom,children:m.nom},m.nom))]})]}),e.jsx($,{label:"Nombre d'accompagnateurs",type:"number",min:0,max:10,value:I.accompanyingPersons||0,onChange:m=>q(u=>({...u,accompanyingPersons:parseInt(m.target.value,10)||0})),placeholder:"0"})]}),e.jsx($,{label:"Titre du discours",value:I.talkTheme||"",onChange:m=>q(u=>({...u,talkTheme:m.target.value})),placeholder:"Ex: Nega iluzon di mundu..."}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Statut de la visite"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(p,{variant:r.status==="pending"?"primary":"secondary",size:"sm",onClick:()=>R("pending"),disabled:f,leftIcon:e.jsx(de,{className:"w-3 h-3"}),children:"En attente"}),e.jsx(p,{variant:r.status==="confirmed"?"primary":"secondary",size:"sm",onClick:()=>R("confirmed"),disabled:f,leftIcon:e.jsx(ce,{className:"w-3 h-3"}),children:"Confirm√©"}),e.jsx(p,{variant:r.status==="completed"?"primary":"secondary",size:"sm",onClick:()=>R("completed"),disabled:f,leftIcon:e.jsx(ce,{className:"w-3 h-3"}),children:"Termin√©"}),e.jsx(p,{variant:r.status==="cancelled"?"danger":"secondary",size:"sm",onClick:()=>R("cancelled"),disabled:f,leftIcon:e.jsx(de,{className:"w-3 h-3"}),children:"Annul√©"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["Statut actuel: ",e.jsx("span",{className:"font-medium capitalize",children:r.status})]})]}),e.jsx($,{label:"Notes",value:I.notes||"",onChange:m=>q(u=>({...u,notes:m.target.value}))}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg text-sm text-gray-600 dark:text-gray-400",children:`üí° Pour g√©rer le logement et les repas, utilisez l'onglet "Logistique" du menu`})]});case"delete":return e.jsxs("div",{className:"text-center py-6",children:[e.jsx(Ne,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Supprimer la visite"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["√ätes-vous s√ªr de vouloir supprimer la visite de ",e.jsx("strong",{children:r.nom}),"du ",new Date(r.visitDate).toLocaleDateString("fr-FR")," ?"]}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:"Cette action est irr√©versible."})]});case"status":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5"}),"Changer le statut"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Statut actuel: ",e.jsx("span",{className:"font-medium",children:r.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{variant:"secondary",onClick:()=>R("pending"),className:"w-full justify-start",leftIcon:e.jsx(de,{className:"w-4 h-4"}),children:"Marquer en attente"}),e.jsx(p,{variant:"secondary",onClick:()=>R("confirmed"),className:"w-full justify-start",leftIcon:e.jsx(ce,{className:"w-4 h-4"}),children:"Confirmer"}),e.jsx(p,{variant:"secondary",onClick:()=>R("completed"),className:"w-full justify-start",leftIcon:e.jsx(ce,{className:"w-4 h-4"}),children:"Marquer comme termin√©"}),e.jsx(p,{variant:"danger",onClick:()=>R("cancelled"),className:"w-full justify-start",leftIcon:e.jsx(de,{className:"w-4 h-4"}),children:"Annuler"})]})]})]});case"message":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(We,{className:"w-5 h-5"}),"G√©n√©rer un message"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Choisissez un type de message pour ouvrir l'assistant de r√©daction :"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx(p,{variant:"secondary",onClick:()=>S({isOpen:!0,type:"confirmation"}),className:"w-full justify-start",children:"Message de confirmation"}),e.jsx(p,{variant:"secondary",onClick:()=>S({isOpen:!0,type:"preparation"}),className:"w-full justify-start",children:"Message de pr√©paration"}),e.jsx(p,{variant:"secondary",onClick:()=>S({isOpen:!0,type:"reminder-7"}),className:"w-full justify-start",children:"Rappel J-7"}),e.jsx(p,{variant:"secondary",onClick:()=>S({isOpen:!0,type:"reminder-2"}),className:"w-full justify-start",children:"Rappel J-2"}),e.jsx(p,{variant:"secondary",onClick:()=>S({isOpen:!0,type:"thanks"}),className:"w-full justify-start",children:"Message de remerciement"}),e.jsx(p,{variant:"secondary",onClick:()=>S({isOpen:!0,type:"host_request"}),className:"w-full justify-start",children:"Demande d'accueil"})]})]});case"feedback":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-yellow-500"}),"Bilan de la visite"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Utilisez la modale de feedback pour √©valuer cette visite."})]});case"expenses":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(et,{className:"w-5 h-5 text-green-600"}),"Gestion des co√ªts"]}),ee||Y?e.jsx(at,{initialData:Y,onSubmit:te,onCancel:()=>{X(!1),K(void 0)}}):e.jsx(nt,{expenses:I.expenses||[],onAdd:()=>X(!0),onEdit:K,onDelete:o,readOnly:f})]});case"logistics":{const m={...r,...I},u=m.logistics?.accommodation||{},z=(u.type||"host")==="host";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5 text-blue-600"}),"Logistique"]}),e.jsx(ct,{logistics:{...m.logistics,accommodation:{...u,type:u.type||"host",name:z?m.host||u.name||"":u.name||"",address:z?m.accommodation||u.address||"":u.address||""}},onUpdate:E=>{q(g=>({...g,logistics:E,host:E.accommodation?.type==="host"&&E.accommodation?.name||g.host,accommodation:E.accommodation?.type==="host"&&E.accommodation?.address||g.accommodation}))},readOnly:f,hosts:H}),e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Documents"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:e.jsx(ft,{visit:m,speaker:k.find(E=>E.id===m.id),host:H.find(E=>E.nom===m.host)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{variant:"outline",onClick:()=>w(!0),leftIcon:e.jsx(ve,{className:"w-4 h-4"}),children:"Organiser le transport"}),e.jsx(p,{variant:"outline",onClick:()=>P(!0),leftIcon:e.jsx(ge,{className:"w-4 h-4"}),children:"Planifier les repas"}),e.jsx(p,{variant:"outline",onClick:()=>L(!0),leftIcon:e.jsx(ke,{className:"w-4 h-4"}),children:"G√©rer l'h√©bergement"})]})]})}default:return null}},ae=()=>{switch(y){case"edit":case"logistics":return e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"ghost",onClick:b,disabled:f,children:"Annuler"}),e.jsx(p,{onClick:a,isLoading:f,children:"Enregistrer"})]});case"delete":return e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"ghost",onClick:b,disabled:f,children:"Annuler"}),e.jsx(p,{variant:"danger",onClick:T,isLoading:f,children:"Supprimer"})]});case"feedback":case"expenses":return null;case"message":return e.jsx(p,{variant:"ghost",onClick:b,disabled:f,children:"Fermer"});default:return e.jsx(p,{variant:"ghost",onClick:b,disabled:f,children:"Fermer"})}};return e.jsxs(e.Fragment,{children:[e.jsx(he,{isOpen:t,onClose:b,size:y==="logistics"?"xl":"md",footer:ae(),children:Q()}),j&&e.jsx(mt,{isOpen:j,onClose:()=>w(!1),visit:r,onSave:()=>{}}),O&&e.jsx(xt,{isOpen:O,onClose:()=>P(!1),visit:r,onSave:()=>{}}),V&&e.jsx(ht,{isOpen:V,onClose:()=>L(!1),visit:r,onSelectHost:()=>{}}),A.isOpen&&e.jsx(Je,{isOpen:A.isOpen,onClose:()=>S(m=>({...m,isOpen:!1})),speaker:k.find(m=>m.id===r.id)||{id:r.id,nom:r.nom,congregation:r.congregation||"",gender:"male",talkHistory:[]},visit:r,initialType:A.type})]})};export{et as C,tt as D,ve as T,Et as V,de as X,bt as l};
//# sourceMappingURL=VisitActionModal-Cof0s5O_.js.map
